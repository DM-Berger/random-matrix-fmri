!function(){for(var r=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),a=Math.max(0,16-(n-r)),i=window.setTimeout(function(){e(n+a)},a);return r=n+a,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var SCM=SCM||{};function Class_Promise(){var e,t;e=this,t=function(){"use strict";function l(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(n,1)}}function n(){for(var e=0;e<S;e+=2)(0,_[e])(_[e+1]),_[e]=void 0,_[e+1]=void 0;S=0}function c(e,t){var n=this,a=new this.constructor(u);void 0===a[I]&&v(a);var i,r=n._state;return r?(i=arguments[r-1],M(function(){return g(r,a,i,n._result)})):o(n,a,e,t),a}function d(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(u);return p(t,e),t}function u(){}function r(e,a,i){M(function(t){var n=!1,e=function(e,t,n,a){try{e.call(t,n,a)}catch(e){return e}}(i,a,function(e){n||(n=!0,(a!==e?p:f)(t,e))},function(e){n||(n=!0,m(t,e))},t._label);!n&&e&&(n=!0,m(t,e))},e)}function h(e,t,n){var a,i;t.constructor===e.constructor&&n===c&&t.constructor.resolve===d?(a=e,(i=t)._state===F?f(a,i._result):i._state===R?m(a,i._result):o(i,void 0,function(e){return p(a,e)},function(e){return m(a,e)})):void 0!==n&&l(n)?r(e,t,n):f(e,t)}function p(t,e){if(t===e)m(t,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(a=e),null===a||"object"!=i&&"function"!=i)f(t,e);else{var n=void 0;try{n=e.then}catch(e){return void m(t,e)}h(t,e,n)}var a,i}function a(e){e._onerror&&e._onerror(e._result),s(e)}function f(e,t){e._state===$&&(e._result=t,e._state=F,0!==e._subscribers.length&&M(s,e))}function m(e,t){e._state===$&&(e._state=R,e._result=t,M(a,e))}function o(e,t,n,a){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+F]=n,i[r+R]=a,0===r&&e._state&&M(s,e)}function s(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var a,i=void 0,r=e._result,o=0;o<t.length;o+=3)a=t[o],i=t[o+n],a?g(n,a,i,r):i(r);e._subscribers.length=0}}function g(e,t,n,a){var i=l(n),r=void 0,o=void 0,s=!0;if(i){try{r=n(a)}catch(e){s=!1,o=e}if(t===r)return void m(t,new TypeError("A promises callback cannot return that same promise."))}else r=a;t._state!==$||(i&&s?p(t,r):!1===s?m(t,o):e===F?f(t,r):e===R&&m(t,r))}function v(e){e[I]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}var e,i,y,C,b=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},S=0,w=void 0,k=void 0,M=function(e,t){_[S]=e,_[S+1]=t,2===(S+=2)&&(k?k(n):j())},x="undefined"!=typeof window?window:void 0,D=x||{},A=D.MutationObserver||D.WebKitMutationObserver,T="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),D="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,_=new Array(1e3),j=void 0,j=T?function(){return process.nextTick(n)}:A?(i=0,y=new A(n),C=document.createTextNode(""),y.observe(C,{characterData:!0}),function(){C.data=i=++i%2}):D?((e=new MessageChannel).port1.onmessage=n,function(){return e.port2.postMessage(0)}):(void 0===x&&"function"==typeof require?function(){try{var e=Function("return this")().require("vertx");return void 0!==(w=e.runOnLoop||e.runOnContext)?function(){w(n)}:t()}catch(e){return t()}}:t)(),I=Math.random().toString(36).substring(2),$=void 0,F=1,R=2,P=0,L=(N.prototype._enumerate=function(e){for(var t=0;this._state===$&&t<e.length;t++)this._eachEntry(e[t],t)},N.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,a=n.resolve;if(a===d){var i,r=void 0,o=void 0,s=!1;try{r=t.then}catch(e){s=!0,o=e}r===c&&t._state!==$?this._settledAt(t._state,e,t._result):"function"!=typeof r?(this._remaining--,this._result[e]=t):n===U?(i=new n(u),s?m(i,o):h(i,t,r),this._willSettleAt(i,e)):this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(a(t),e)},N.prototype._settledAt=function(e,t,n){var a=this.promise;a._state===$&&(this._remaining--,e===R?m(a,n):this._result[t]=n),0===this._remaining&&f(a,this._result)},N.prototype._willSettleAt=function(e,t){var n=this;o(e,void 0,function(e){return n._settledAt(F,t,e)},function(e){return n._settledAt(R,t,e)})},N),U=(E.prototype.catch=function(e){return this.then(null,e)},E.prototype.finally=function(t){var n=this.constructor;return l(t)?this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):this.then(t,t)},E);function E(e){this[I]=P++,this._result=this._state=void 0,this._subscribers=[],u!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof E?function(t,e){try{e(function(e){p(t,e)},function(e){m(t,e)})}catch(e){m(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function N(e,t){this._instanceConstructor=e,this.promise=new e(u),this.promise[I]||v(this.promise),b(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?f(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&f(this.promise,this._result))):m(this.promise,new Error("Array Methods must be provided an Array"))}return U.prototype.then=c,U.all=function(e){return new L(this,e).promise},U.race=function(i){var r=this;return new r(b(i)?function(e,t){for(var n=i.length,a=0;a<n;a++)r.resolve(i[a]).then(e,t)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},U.resolve=d,U.reject=function(e){var t=new this(u);return m(t,e),t},U._setScheduler=function(e){k=e},U._setAsap=function(e){M=e},U._asap=M,U.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=U},(U.Promise=U).polyfill(),U},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t()}function Array_includes(){var i,r,e,t,n;function o(e,t,n){var a=2<arguments.length?n:[];if(!1===s(e))throw new TypeError(Object.prototype.toString.call(e)+"is not a function.");return e.apply(t,a)}function s(e){return"function"==typeof e}function l(e){e=Number(e);return isNaN(e)?0:1/e==1/0||1/e==-1/0||e===1/0||e===-1/0?e:(e<0?-1:1)*Math.floor(Math.abs(e))}function c(e){if(null===e||e===r)throw TypeError();return Object(e)}function d(e,t){var n,n=(n=t,c(e)[n]);if(null===n||n===r)return r;if(!1===s(n))throw new TypeError("Method not callable: "+t);return n}function u(e){switch(typeof e){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===e?"null":"Symbol"in i&&(e instanceof i.Symbol||e.constructor===i.Symbol)?"symbol":"object"}}function h(e,t){var n=1<arguments.length?t:r;if("object"!==u(e))return e;arguments.length<2?a="default":n===String?a="string":n===Number&&(a="number");n="function"==typeof i.Symbol&&"symbol"==typeof i.Symbol.toPrimitive?d(e,i.Symbol.toPrimitive):r;if(n===r)return"default"===a&&(a="number"),function(e,t){for(var n="string"===t?["toString","valueOf"]:["valueOf","toString"],a=0;a<n.length;++a){var i=e[n[a]];if(s(i)){i=o(i,e);if("object"!==u(i))return i}}throw new TypeError("Cannot convert to primitive.")}(e,a);var a=o(n,e,[a]);if("object"!==u(a))return a;throw new TypeError("Cannot convert exotic object to primitive.")}Array.prototype.includes||(i="object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{},e=Array.prototype,n={value:n=function(e,t){"use strict";var n,a=c(this),i=(n=l(n=a.length))<=0?0:Math.min(n,Math.pow(2,53)-1);if(0===i)return!1;var r,o,t=l(t);for(0<=t?r=t:(r=i+t)<0&&(r=0);r<i;){var s=a[function e(t){switch(u(t)){case"symbol":throw new TypeError("Cannot convert a Symbol value to a string");case"object":return e(h(t,String));default:return String(t)}}(r)];if(o=s,u(s=e)===u(o)&&("number"===u(s)&&(isNaN(s)&&isNaN(o)||1/s==1/0&&1/o==-1/0||1/s==-1/0&&1/o==1/0)||s===o))return!0;r+=1}return!1},writable:!0,enumerable:!(t="includes"),configurable:!0},Object.defineProperty(e,t,n))}function String_includes(){String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===t&&(t=0),-1!==this.indexOf(e,t)})}function String_startsWith(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){t=0<t?0|t:0;return this.substring(t,t+e.length)===e}})}function String_endsWith(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e})}!function(e){var n;e.bbq={},e.bbq.getState=n=function(e){var t=window.location.hash,n=t.indexOf(e);if(!(n<0)){n=n+e.length+1;e=t.indexOf("&",n);return e<0?decodeURI(t.substring(n)):decodeURI(t.substring(n,e))}},e.bbq.removeState=function(e){var t=n(e);t&&location.replace(window.location.hash.replace(e+"="+encodeURI(t),""))},e.deparam={},e.deparam.querystring=function(){for(var e=window.location.search.substring(1).split("&"),t={},n=0;n<e.length;n++){var a=e[n].split("=");2===a.length&&(t[a[0]]=decodeURI(a[1]))}return t}}(jQuery),Class_Promise(),Array_includes(),String_includes(),String_startsWith(),String_endsWith(),function(l){var i="unobtrusiveAjaxClick",r="unobtrusiveAjaxClickTarget";function c(e,t){for(var n=window,a=(e||"").split(".");n&&a.length;)n=n[a.shift()];return"function"==typeof n?n:(t.push(e),Function.constructor.apply(null,t))}function d(e){return"GET"===e||"POST"===e}function a(o,e){var a,i,r,s,t=o.getAttribute("data-ajax-confirm");t&&!window.confirm(t)||(a=l(o.getAttribute("data-ajax-loading")),r=parseInt(o.getAttribute("data-ajax-loading-duration"),10)||0,l.extend(e,{type:o.getAttribute("data-ajax-method")||void 0,url:o.getAttribute("data-ajax-url")||void 0,cache:"true"===(o.getAttribute("data-ajax-cache")||"").toLowerCase(),beforeSend:function(e){var t,n;return t=e,d(n=i)||t.setRequestHeader("X-HTTP-Method-Override",n),!1!==(n=c(o.getAttribute("data-ajax-begin"),["xhr"]).apply(o,arguments))&&a.show(r),n},complete:function(){a.hide(r),c(o.getAttribute("data-ajax-complete"),["xhr","status"]).apply(o,arguments)},success:function(e,t,n){var a,i,r;a=o,i=e,-1===(n.getResponseHeader("Content-Type")||"text/html").indexOf("application/x-javascript")&&(r=(a.getAttribute("data-ajax-mode")||"").toUpperCase(),l(a.getAttribute("data-ajax-update")).each(function(e,t){switch(r){case"BEFORE":l(t).prepend(i);break;case"AFTER":l(t).append(i);break;case"REPLACE-WITH":l(t).replaceWith(i);break;default:l(t).html(i)}})),c(o.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(o,arguments)},error:function(){c(o.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(o,arguments)}}),e.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),d(i=e.type.toUpperCase())||(e.type="POST",e.data.push({name:"X-HTTP-Method-Override",value:i})),(t=l(o)).is("form")&&"multipart/form-data"==t.attr("enctype")&&(s=new FormData,l.each(e.data,function(e,t){s.append(t.name,t.value)}),l("input[type=file]",t).each(function(){var n=this;l.each(n.files,function(e,t){s.append(n.name,t)})}),l.extend(e,{processData:!1,contentType:!1,data:s})),l.ajax(e))}l(document).on("click","a[data-ajax=true]",function(e){e.preventDefault(),a(this,{url:this.href,type:"GET",data:[]})}),l(document).on("click","form[data-ajax=true] input[type=image]",function(e){var t=e.target.name,n=l(e.target),a=l(n.parents("form")[0]),n=n.offset();a.data(i,[{name:t+".x",value:Math.round(e.pageX-n.left)},{name:t+".y",value:Math.round(e.pageY-n.top)}]),setTimeout(function(){a.removeData(i)},0)}),l(document).on("click","form[data-ajax=true] :submit",function(e){var t=e.currentTarget.name,n=l(e.target),a=l(n.parents("form")[0]);a.data(i,t?[{name:t,value:e.currentTarget.value}]:[]),a.data(r,n),setTimeout(function(){a.removeData(i),a.removeData(r)},0)}),l(document).on("submit","form[data-ajax=true]",function(e){var t=l(this).data(i)||[],n=l(this).data(r),n=n&&(n.hasClass("cancel")||void 0!==n.attr("formnovalidate"));e.preventDefault(),!n&&((n=l(n=this).data("unobtrusiveValidation"))&&n.validate&&!n.validate())||a(this,{url:this.action,type:this.method||"GET",data:t.concat(l(this).serializeArray())})})}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(d){var n;d.extend(d.fn,{validate:function(e){if(this.length){var a=d.data(this[0],"validator");return a?a:(this.attr("novalidate","novalidate"),a=new d.validator(e,this[0]),d.data(this[0],"validator",a),a.settings.onsubmit&&(this.on("click.validate",":submit",function(e){a.submitButton=e.currentTarget,d(this).hasClass("cancel")&&(a.cancelSubmit=!0),void 0!==d(this).attr("formnovalidate")&&(a.cancelSubmit=!0)}),this.on("submit.validate",function(n){function e(){var e,t;return a.submitButton&&(a.settings.submitHandler||a.formSubmitted)&&(e=d("<input type='hidden'/>").attr("name",a.submitButton.name).val(d(a.submitButton).val()).appendTo(a.currentForm)),!(a.settings.submitHandler&&!a.settings.debug)||(t=a.settings.submitHandler.call(a,a.currentForm,n),e&&e.remove(),void 0!==t&&t)}return a.settings.debug&&n.preventDefault(),a.cancelSubmit?(a.cancelSubmit=!1,e()):a.form()?a.pendingRequest?!(a.formSubmitted=!0):e():(a.focusInvalid(),!1)})),a)}e&&e.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){var e,t,n;return d(this[0]).is("form")?e=this.validate().form():(n=[],e=!0,t=d(this[0].form).validate(),this.each(function(){(e=t.element(this)&&e)||(n=n.concat(t.errorList))}),t.errorList=n),e},rules:function(e,t){var n,a,i,r,o,s=this[0],l=void 0!==this.attr("contenteditable")&&"false"!==this.attr("contenteditable");if(null!=s&&(!s.form&&l&&(s.form=this.closest("form")[0],s.name=this.attr("name")),null!=s.form)){if(e)switch(a=(n=d.data(s.form,"validator").settings).rules,i=d.validator.staticRules(s),e){case"add":d.extend(i,d.validator.normalizeRule(t)),delete i.messages,a[s.name]=i,t.messages&&(n.messages[s.name]=d.extend(n.messages[s.name],t.messages));break;case"remove":return t?(o={},d.each(t.split(/\s/),function(e,t){o[t]=i[t],delete i[t]}),o):(delete a[s.name],i)}return(e=d.validator.normalizeRules(d.extend({},d.validator.classRules(s),d.validator.attributeRules(s),d.validator.dataRules(s),d.validator.staticRules(s)),s)).required&&(r=e.required,delete e.required,e=d.extend({required:r},e)),e.remote&&(r=e.remote,delete e.remote,e=d.extend(e,{remote:r})),e}}}),d.extend(d.expr.pseudos||d.expr[":"],{blank:function(e){return!d.trim(""+d(e).val())},filled:function(e){e=d(e).val();return null!==e&&!!d.trim(""+e)},unchecked:function(e){return!d(e).prop("checked")}}),d.validator=function(e,t){this.settings=d.extend(!0,{},d.validator.defaults,e),this.currentForm=t,this.init()},d.validator.format=function(n,e){return 1===arguments.length?function(){var e=d.makeArray(arguments);return e.unshift(n),d.validator.format.apply(this,e)}:(void 0===e||(2<arguments.length&&e.constructor!==Array&&(e=d.makeArray(arguments).slice(1)),e.constructor!==Array&&(e=[e]),d.each(e,function(e,t){n=n.replace(new RegExp("\\{"+e+"\\}","g"),function(){return t})})),n)},d.extend(d.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:d([]),errorLabelContainer:d([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e,t){9===t.which&&""===this.elementValue(e)||-1!==d.inArray(t.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(e.name in this.submitted||e.name in this.invalid)&&this.element(e)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(e,t,n){("radio"===e.type?this.findByName(e.name):d(e)).addClass(t).removeClass(n)},unhighlight:function(e,t,n){("radio"===e.type?this.findByName(e.name):d(e)).removeClass(t).addClass(n)}},setDefaults:function(e){d.extend(d.validator.defaults,e)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:d.validator.format("Please enter no more than {0} characters."),minlength:d.validator.format("Please enter at least {0} characters."),rangelength:d.validator.format("Please enter a value between {0} and {1} characters long."),range:d.validator.format("Please enter a value between {0} and {1}."),max:d.validator.format("Please enter a value less than or equal to {0}."),min:d.validator.format("Please enter a value greater than or equal to {0}."),step:d.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=d(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||d(this.currentForm),this.containers=d(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var n,i=this.currentForm,a=this.groups={};function e(e){var t,n,a=void 0!==d(this).attr("contenteditable")&&"false"!==d(this).attr("contenteditable");!this.form&&a&&(this.form=d(this).closest("form")[0],this.name=d(this).attr("name")),i===this.form&&(t=d.data(this.form,"validator"),n="on"+e.type.replace(/^validate/,""),(a=t.settings)[n]&&!d(this).is(a.ignore)&&a[n].call(t,this,e))}d.each(this.settings.groups,function(n,e){"string"==typeof e&&(e=e.split(/\s/)),d.each(e,function(e,t){a[t]=n})}),n=this.settings.rules,d.each(n,function(e,t){n[e]=d.validator.normalizeRule(t)}),d(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",e).on("click.validate","select, option, [type='radio'], [type='checkbox']",e),this.settings.invalidHandler&&d(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),d.extend(this.submitted,this.errorMap),this.invalid=d.extend({},this.errorMap),this.valid()||d(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(e){var t,n,a=this.clean(e),i=this.validationTargetFor(a),r=this,o=!0;return void 0===i?delete this.invalid[a.name]:(this.prepareElement(i),this.currentElements=d(i),(n=this.groups[i.name])&&d.each(this.groups,function(e,t){t===n&&e!==i.name&&(a=r.validationTargetFor(r.clean(r.findByName(e))))&&a.name in r.invalid&&(r.currentElements.push(a),o=r.check(a)&&o)}),t=!1!==this.check(i),o=o&&t,this.invalid[i.name]=!t,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),d(e).attr("aria-invalid",!t)),o},showErrors:function(t){var n;t&&(n=this,d.extend(this.errorMap,t),this.errorList=d.map(this.errorMap,function(e,t){return{message:e,element:n.findByName(t)[0]}}),this.successList=d.grep(this.successList,function(e){return!(e.name in t)})),this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){d.fn.resetForm&&d(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var e=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(e)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,n=0;for(t in e)void 0!==e[t]&&null!==e[t]&&!1!==e[t]&&n++;return n},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{d(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").trigger("focus").trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1===d.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var n=this,a={};return d(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var e=this.name||d(this).attr("name"),t=void 0!==d(this).attr("contenteditable")&&"false"!==d(this).attr("contenteditable");return!e&&n.settings.debug&&window.console&&console.error("%o has no name assigned",this),t&&(this.form=d(this).closest("form")[0],this.name=e),this.form===n.currentForm&&(!(e in a||!n.objectLength(d(this).rules()))&&(a[e]=!0))})},clean:function(e){return d(e)[0]},errors:function(){var e=this.settings.errorClass.split(" ").join(".");return d(this.settings.errorElement+"."+e,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=d([]),this.toHide=d([])},reset:function(){this.resetInternals(),this.currentElements=d([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(e){var t=d(e),n=e.type,a=void 0!==t.attr("contenteditable")&&"false"!==t.attr("contenteditable");return"radio"===n||"checkbox"===n?this.findByName(e.name).filter(":checked").val():"number"===n&&void 0!==e.validity?e.validity.badInput?"NaN":t.val():(t=a?t.text():t.val(),"file"===n?"C:\\fakepath\\"===t.substr(0,12)?t.substr(12):0<=(n=t.lastIndexOf("/"))||0<=(n=t.lastIndexOf("\\"))?t.substr(n+1):t:"string"==typeof t?t.replace(/\r/g,""):t)},check:function(t){t=this.validationTargetFor(this.clean(t));var e,n,a,i,r=d(t).rules(),o=d.map(r,function(e,t){return t}).length,s=!1,l=this.elementValue(t);for(n in"function"==typeof r.normalizer?i=r.normalizer:"function"==typeof this.settings.normalizer&&(i=this.settings.normalizer),i&&(l=i.call(t,l),delete r.normalizer),r){a={method:n,parameters:r[n]};try{if("dependency-mismatch"===(e=d.validator.methods[n].call(this,l,t,a.parameters))&&1===o){s=!0;continue}if(s=!1,"pending"===e)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!e)return this.formatAndAdd(t,a),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+a.method+"' method.",e),e instanceof TypeError&&(e.message+=".  Exception occurred when checking element "+t.id+", check the '"+a.method+"' method."),e}}if(!s)return this.objectLength(r)&&this.successList.push(t),!0},customDataMessage:function(e,t){return d(e).data("msg"+t.charAt(0).toUpperCase()+t.substring(1).toLowerCase())||d(e).data("msg")},customMessage:function(e,t){e=this.settings.messages[e];return e&&(e.constructor===String?e:e[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(e,t){"string"==typeof t&&(t={method:t});var n=this.findDefined(this.customMessage(e.name,t.method),this.customDataMessage(e,t.method),!this.settings.ignoreTitle&&e.title||void 0,d.validator.messages[t.method],"<strong>Warning: No message defined for "+e.name+"</strong>"),a=/\$?\{(\d+)\}/g;return"function"==typeof n?n=n.call(this,t.parameters,e):a.test(n)&&(n=d.validator.format(n.replace(a,"{$1}"),t.parameters)),n},formatAndAdd:function(e,t){var n=this.defaultMessage(e,t);this.errorList.push({message:n,element:e,method:t.method}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){for(var e,t,n=0;this.errorList[n];n++)t=this.errorList[n],this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(n=0;this.successList[n];n++)this.showLabel(this.successList[n]);if(this.settings.unhighlight)for(n=0,e=this.validElements();e[n];n++)this.settings.unhighlight.call(this,e[n],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return d(this.errorList).map(function(){return this.element})},showLabel:function(e,t){var n,a,i,r=this.errorsFor(e),o=this.idOrName(e),s=d(e).attr("aria-describedby");r.length?(r.removeClass(this.settings.validClass).addClass(this.settings.errorClass),r.html(t)):(n=r=d("<"+this.settings.errorElement+">").attr("id",o+"-error").addClass(this.settings.errorClass).html(t||""),this.settings.wrapper&&(n=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(n):this.settings.errorPlacement?this.settings.errorPlacement.call(this,n,d(e)):n.insertAfter(e),r.is("label")?r.attr("for",o):0===r.parents("label[for='"+this.escapeCssMeta(o)+"']").length&&(o=r.attr("id"),s?s.match(new RegExp("\\b"+this.escapeCssMeta(o)+"\\b"))||(s+=" "+o):s=o,d(e).attr("aria-describedby",s),(a=this.groups[e.name])&&(i=this,d.each(i.groups,function(e,t){t===a&&d("[name='"+i.escapeCssMeta(e)+"']",i.currentForm).attr("aria-describedby",r.attr("id"))})))),!t&&this.settings.success&&(r.text(""),"string"==typeof this.settings.success?r.addClass(this.settings.success):this.settings.success(r,e)),this.toShow=this.toShow.add(r)},errorsFor:function(e){var t=this.escapeCssMeta(this.idOrName(e)),e=d(e).attr("aria-describedby"),t="label[for='"+t+"'], label[for='"+t+"'] *";return e&&(t=t+", #"+this.escapeCssMeta(e).replace(/\s+/g,", #")),this.errors().filter(t)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||!this.checkable(e)&&e.id||e.name},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name)),d(e).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(e){return d(this.currentForm).find("[name='"+this.escapeCssMeta(e)+"']")},getLength:function(e,t){switch(t.nodeName.toLowerCase()){case"select":return d("option:selected",t).length;case"input":if(this.checkable(t))return this.findByName(t.name).filter(":checked").length}return e.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e){return e},string:function(e,t){return!!d(e,t.form).length},function:function(e,t){return e(t)}},optional:function(e){var t=this.elementValue(e);return!d.validator.methods.required.call(this,t,e)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,d(e).addClass(this.settings.pendingClass),this.pending[e.name]=!0)},stopRequest:function(e,t){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],d(e).removeClass(this.settings.pendingClass),t&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(d(this.currentForm).submit(),this.submitButton&&d("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove(),this.formSubmitted=!1):!t&&0===this.pendingRequest&&this.formSubmitted&&(d(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e,t){return t="string"==typeof t&&t||"remote",d.data(e,"previousValue")||d.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,{method:t})})},destroy:function(){this.resetForm(),d(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur").find(".validate-lessThan-blur").off(".validate-lessThan").removeClass("validate-lessThan-blur").find(".validate-lessThanEqual-blur").off(".validate-lessThanEqual").removeClass("validate-lessThanEqual-blur").find(".validate-greaterThanEqual-blur").off(".validate-greaterThanEqual").removeClass("validate-greaterThanEqual-blur").find(".validate-greaterThan-blur").off(".validate-greaterThan").removeClass("validate-greaterThan-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,t){e.constructor===String?this.classRuleSettings[e]=t:d.extend(this.classRuleSettings,e)},classRules:function(e){var t={},e=d(e).attr("class");return e&&d.each(e.split(" "),function(){this in d.validator.classRuleSettings&&d.extend(t,d.validator.classRuleSettings[this])}),t},normalizeAttributeRule:function(e,t,n,a){/min|max|step/.test(n)&&(null===t||/number|range|text/.test(t))&&(a=Number(a),isNaN(a)&&(a=void 0)),a||0===a?e[n]=a:t===n&&"range"!==t&&(e[n]=!0)},attributeRules:function(e){var t,n,a={},i=d(e),r=e.getAttribute("type");for(t in d.validator.methods)n="required"===t?(""===(n=e.getAttribute(t))&&(n=!0),!!n):i.attr(t),this.normalizeAttributeRule(a,r,t,n);return a.maxlength&&/-1|2147483647|524288/.test(a.maxlength)&&delete a.maxlength,a},dataRules:function(e){var t,n,a={},i=d(e),r=e.getAttribute("type");for(t in d.validator.methods)""===(n=i.data("rule"+t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()))&&(n=!0),this.normalizeAttributeRule(a,r,t,n);return a},staticRules:function(e){var t={},n=d.data(e.form,"validator");return n.settings.rules&&(t=d.validator.normalizeRule(n.settings.rules[e.name])||{}),t},normalizeRules:function(a,i){return d.each(a,function(e,t){if(!1!==t){if(t.param||t.depends){var n=!0;switch(typeof t.depends){case"string":n=!!d(t.depends,i.form).length;break;case"function":n=t.depends.call(i,i)}n?a[e]=void 0===t.param||t.param:(d.data(i.form,"validator").resetElements(d(i)),delete a[e])}}else delete a[e]}),d.each(a,function(e,t){a[e]=d.isFunction(t)&&"normalizer"!==e?t(i):t}),d.each(["minlength","maxlength"],function(){a[this]&&(a[this]=Number(a[this]))}),d.each(["rangelength","range"],function(){var e;a[this]&&(d.isArray(a[this])?a[this]=[Number(a[this][0]),Number(a[this][1])]:"string"==typeof a[this]&&(e=a[this].replace(/[\[\]]/g,"").split(/[\s,]+/),a[this]=[Number(e[0]),Number(e[1])]))}),d.validator.autoCreateRanges&&(null!=a.min&&null!=a.max&&(a.range=[a.min,a.max],delete a.min,delete a.max),null!=a.minlength&&null!=a.maxlength&&(a.rangelength=[a.minlength,a.maxlength],delete a.minlength,delete a.maxlength)),a},normalizeRule:function(e){var t;return"string"==typeof e&&(t={},d.each(e.split(/\s/),function(){t[this]=!0}),e=t),e},addMethod:function(e,t,n){d.validator.methods[e]=t,d.validator.messages[e]=void 0!==n?n:d.validator.messages[e],t.length<3&&d.validator.addClassRules(e,d.validator.normalizeRule(e))},methods:{required:function(e,t,n){if(!this.depend(n,t))return"dependency-mismatch";if("select"!==t.nodeName.toLowerCase())return this.checkable(t)?0<this.getLength(e,t):null!=e&&0<e.length;t=d(t).val();return t&&0<t.length},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)},date:(n=!1,function(e,t){return n||(n=!0,this.settings.debug&&window.console&&console.warn("The `date` method is deprecated and will be removed in version '2.0.0'.\nPlease don't use it, since it relies on the Date constructor, which\nbehaves very differently across browsers and locales. Use `dateISO`\ninstead or one of the locale specific methods in `localizations/`\nand `additional-methods.js`.")),this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())}),dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(e,t,n){e=d.isArray(e)?e.length:this.getLength(e,t);return this.optional(t)||n<=e},maxlength:function(e,t,n){e=d.isArray(e)?e.length:this.getLength(e,t);return this.optional(t)||e<=n},rangelength:function(e,t,n){e=d.isArray(e)?e.length:this.getLength(e,t);return this.optional(t)||e>=n[0]&&e<=n[1]},min:function(e,t,n){return this.optional(t)||n<=e},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},step:function(e,t,n){function a(e){return(e=(""+e).match(/(?:\.(\d+))?$/))&&e[1]?e[1].length:0}function i(e){return Math.round(e*Math.pow(10,r))}var r,o=d(t).attr("type"),s="Step attribute on input type "+o+" is not supported.",l=new RegExp("\\b"+o+"\\b"),c=!0;if(o&&!l.test(["text","number","range"].join()))throw new Error(s);return r=a(n),(a(e)>r||i(e)%i(n)!=0)&&(c=!1),this.optional(t)||c},equalTo:function(e,t,n){n=d(n);return this.settings.onfocusout&&n.not(".validate-equalTo-blur").length&&n.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){d(t).valid()}),e===n.val()},remote:function(a,i,e,r){if(this.optional(i))return"dependency-mismatch";r="string"==typeof r&&r||"remote";var o,t,s=this.previousValue(i,r);return this.settings.messages[i.name]||(this.settings.messages[i.name]={}),s.originalMessage=s.originalMessage||this.settings.messages[i.name][r],this.settings.messages[i.name][r]=s.message,e="string"==typeof e?{url:e}:e,t=d.param(d.extend({data:a},e.data)),s.old===t?s.valid:(s.old=t,(o=this).startRequest(i),(t={})[i.name]=a,d.ajax(d.extend(!0,{mode:"abort",port:"validate"+i.name,dataType:"json",data:t,context:o.currentForm,success:function(e){var t,n=!0===e||"true"===e;o.settings.messages[i.name][r]=s.originalMessage,n?(t=o.formSubmitted,o.resetInternals(),o.toHide=o.errorsFor(i),o.formSubmitted=t,o.successList.push(i),o.invalid[i.name]=!1,o.showErrors()):(t={},e=e||o.defaultMessage(i,{method:r,parameters:a}),t[i.name]=s.message=e,o.invalid[i.name]=!0,o.showErrors(t)),s.valid=n,o.stopRequest(i,n)}},e)),"pending")}}});var a,i={};return d.ajaxPrefilter?d.ajaxPrefilter(function(e,t,n){var a=e.port;"abort"===e.mode&&(i[a]&&i[a].abort(),i[a]=n)}):(a=d.ajax,d.ajax=function(e){var t=("mode"in e?e:d.ajaxSettings).mode,n=("port"in e?e:d.ajaxSettings).port;return"abort"===t?(i[n]&&i[n].abort(),i[n]=a.apply(this,arguments),i[n]):a.apply(this,arguments)}),d}),function(e){"function"==typeof define&&define.amd?define("jquery.validate.unobtrusive",["jquery-validation"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery-validation")):jQuery.validator.unobtrusive=e(jQuery)}(function(l){var e,o=l.validator,s="unobtrusiveValidation";function c(e,t,n){e.rules[t]=n,e.message&&(e.messages[t]=e.message)}function d(e){return e.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function n(e){return e.substr(0,e.lastIndexOf(".")+1)}function u(e,t){return 0===e.indexOf("*.")&&(e=e.replace("*.",t)),e}function h(e){var t=l(this),n="__jquery_unobtrusive_validation_form_reset";if(!t.data(n)){t.data(n,!0);try{t.data("validator").resetForm()}finally{t.removeData(n)}t.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors"),t.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}}function p(n){function e(e,t){(e=r[e])&&l.isFunction(e)&&e.apply(n,t)}var t=l(n),a=t.data(s),i=l.proxy(h,n),r=o.unobtrusive.options||{};return a||(a={options:{errorClass:r.errorClass||"input-validation-error",errorElement:r.errorElement||"span",errorPlacement:function(){(function(e,t){var n=l(this).find("[data-valmsg-for='"+d(t[0].name)+"']"),t=(t=n.attr("data-valmsg-replace"))?!1!==l.parseJSON(t):null;n.removeClass("field-validation-valid").addClass("field-validation-error"),e.data("unobtrusiveContainer",n),t?(n.empty(),e.removeClass("input-validation-error").appendTo(n)):e.hide()}).apply(n,arguments),e("errorPlacement",arguments)},invalidHandler:function(){(function(e,t){var n=l(this).find("[data-valmsg-summary=true]"),a=n.find("ul");a&&a.length&&t.errorList.length&&(a.empty(),n.addClass("validation-summary-errors").removeClass("validation-summary-valid"),l.each(t.errorList,function(){l("<li />").html(this.message).appendTo(a)}))}).apply(n,arguments),e("invalidHandler",arguments)},messages:{},rules:{},success:function(){(function(e){var t,n=e.data("unobtrusiveContainer");n&&(t=(t=n.attr("data-valmsg-replace"))?l.parseJSON(t):null,n.addClass("field-validation-valid").removeClass("field-validation-error"),e.removeData("unobtrusiveContainer"),t&&n.empty())}).apply(n,arguments),e("success",arguments)}},attachValidation:function(){t.off("reset."+s,i).on("reset."+s,i).validate(this.options)},validate:function(){return t.validate(),t.valid()}},t.data(s,a)),a}return o.unobtrusive={adapters:[],parseElement:function(a,e){var t,i,r,o=l(a),s=o.parents("form")[0];s&&((t=p(s)).options.rules[a.name]=i={},t.options.messages[a.name]=r={},l.each(this.adapters,function(){var e="data-val-"+this.name,t=o.attr(e),n={};void 0!==t&&(e+="-",l.each(this.params,function(){n[this]=o.attr(e+this)}),this.adapt({element:a,form:s,message:t,params:n,rules:i,messages:r}))}),l.extend(i,{__dummy__:!0}),e||t.attachValidation())},parse:function(e){var t=l(e),e=t.parents().addBack().filter("form").add(t.find("form")).has("[data-val=true]");t.find("[data-val=true]").each(function(){o.unobtrusive.parseElement(this,!0)}),e.each(function(){var e=p(this);e&&e.attachValidation()})}},(e=o.unobtrusive.adapters).add=function(e,t,n){return n||(n=t,t=[]),this.push({name:e,params:t,adapt:n}),this},e.addBool=function(t,n){return this.add(t,function(e){c(e,n||t,!0)})},e.addMinMax=function(e,a,i,r,t,n){return this.add(e,[t||"min",n||"max"],function(e){var t=e.params.min,n=e.params.max;t&&n?c(e,r,[t,n]):t?c(e,a,t):n&&c(e,i,n)})},e.addSingleVal=function(t,n,a){return this.add(t,[n||"val"],function(e){c(e,a||t,e.params[n])})},o.addMethod("__dummy__",function(e,t,n){return!0}),o.addMethod("regex",function(e,t,n){return!!this.optional(t)||(n=new RegExp(n).exec(e))&&0===n.index&&n[0].length===e.length}),o.addMethod("nonalphamin",function(e,t,n){var a;return n&&(a=(a=e.match(/\W/g))&&a.length>=n),a}),o.methods.extension?(e.addSingleVal("accept","mimtype"),e.addSingleVal("extension","extension")):e.addSingleVal("extension","extension","accept"),e.addSingleVal("regex","pattern"),e.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),e.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),e.addMinMax("minlength","minlength").addMinMax("maxlength","minlength","maxlength"),e.add("equalto",["other"],function(e){var t=n(e.element.name),t=u(e.params.other,t);c(e,"equalTo",l(e.form).find(":input").filter("[name='"+d(t)+"']")[0])}),e.add("required",function(e){"INPUT"===e.element.tagName.toUpperCase()&&"CHECKBOX"===e.element.type.toUpperCase()||c(e,"required",!0)}),e.add("remote",["url","type","additionalfields"],function(a){var i={url:a.params.url,type:a.params.type||"GET",data:{}},r=n(a.element.name);l.each((a.params.additionalfields||a.element.name).replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g),function(e,t){var n=u(t,r);i.data[n]=function(){var e=l(a.form).find(":input").filter("[name='"+d(n)+"']");return e.is(":checkbox")?e.filter(":checked").val()||e.filter(":hidden").val()||"":e.is(":radio")?e.filter(":checked").val()||"":e.val()}}),c(a,"remote",i)}),e.add("password",["min","nonalphamin","regex"],function(e){e.params.min&&c(e,"minlength",e.params.min),e.params.nonalphamin&&c(e,"nonalphamin",e.params.nonalphamin),e.params.regex&&c(e,"regex",e.params.regex)}),e.add("fileextensions",["extensions"],function(e){c(e,"extension",e.params.extensions)}),l(function(){o.unobtrusive.parse(document)}),o.unobtrusive}),function(u){function i(e,t,n){var a=[];return(e.reduction||e).filter(u.validity.settings.elementSupport).each(function(){t(this)?a.push(this):r(this,o(n,{field:s(this)}))}),e.reduction=u(a),e}function n(){u.validity.isValidating()&&(u.validity.report.errors++,u.validity.report.valid=!1)}function r(e,t){n(),u.validity.out.raise(u(e),t)}function h(e,t){n(),u.validity.out.raiseAggregate(e,t)}function a(e){var t=0;return e.each(function(){var e=parseFloat(this.value);t+=isNaN(e)?0:e}),t}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(RegExp("#\\{"+n+"\\}","g"),t[n]));return l(e)}function s(e){var t=(e=u(e)).prop("id"),n=u.validity.settings.defaultFieldName;if(e.prop("title").length)n=e.prop("title");else if(/^([A-Z0-9][a-z]*)+$/.test(t))n=t.replace(/([A-Z0-9])[a-z]*/g," $&");else if(/^[a-z0-9]+(_[a-z0-9]+)*$/.test(t)){for(e=t.split("_"),t=0;t<e.length;++t)e[t]=l(e[t]);n=e.join(" ")}return u.trim(n)}function l(e){return e.substring?e.substring(0,1).toUpperCase()+e.substring(1,e.length):e}var t;u.validity={settings:u.extend({outputMode:"tooltip",scrollTo:!1,modalErrorsClickable:!0,defaultFieldName:"This field",elementSupport:":text, :password, textarea, select, :radio, :checkbox, input[type='hidden'], input[type='tel'], input[type='email']",argToString:function(e){return e.getDate?[e.getMonth()+1,e.getDate(),e.getFullYear()].join("/"):e+""},debugPrivates:!1},{}),patterns:{integer:/^\d+$/,date:/^((0?\d)|(1[012]))[\/-]([012]?\d|30|31)[\/-]\d{1,4}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,usd:/^\$?((\d{1,3}(,\d{3})*)|\d+)(\.(\d{2})?)?$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,number:/^[+-]?(\d+(\.\d*)?|\.\d+)([Ee]-?\d+)?$/,zip:/^\d{5}(-\d{4})?$/,phone:/^[2-9]\d{2}-\d{3}-\d{4}$/,guid:/^(\{?([0-9a-fA-F]){8}-(([0-9a-fA-F]){4}-){3}([0-9a-fA-F]){12}\}?)$/,time12:/^((0?\d)|(1[012])):[0-5]\d?\s?[aApP]\.?[mM]\.?$/,time24:/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/,nonHtml:/^[^<>]*$/},messages:{require:"#{field} is required.",match:"#{field} is in an invalid format.",integer:"#{field} must be a positive, whole number.",date:"#{field} must be formatted as a date. (mm/dd/yyyy)",email:"#{field} must be formatted as an email.",usd:"#{field} must be formatted as a US Dollar amount.",url:"#{field} must be formatted as a URL.",number:"#{field} must be formatted as a number.",zip:"#{field} must be formatted as a zipcode ##### or #####-####.",phone:"#{field} must be formatted as a phone number ###-###-####.",guid:"#{field} must be formatted as a guid like {3F2504E0-4F89-11D3-9A0C-0305E82C3301}.",time24:"#{field} must be formatted as a 24 hour time: 23:00.",time12:"#{field} must be formatted as a 12 hour time: 12:00 AM/PM",lessThan:"#{field} must be less than #{max}.",lessThanOrEqualTo:"#{field} must be less than or equal to #{max}.",greaterThan:"#{field} must be greater than #{min}.",greaterThanOrEqualTo:"#{field} must be greater than or equal to #{min}.",range:"#{field} must be between #{min} and #{max}.",tooLong:"#{field} cannot be longer than #{max} characters.",tooShort:"#{field} cannot be shorter than #{min} characters.",nonHtml:"#{field} cannot contain HTML characters.",alphabet:"#{field} contains disallowed characters.",minCharClass:"#{field} cannot have more than #{min} #{charClass} characters.",maxCharClass:"#{field} cannot have less than #{min} #{charClass} characters.",equal:"Values don't match.",distinct:"A value was repeated.",sum:"Values don't add to #{sum}.",sumMax:"The sum of the values must be less than #{max}.",sumMin:"The sum of the values must be greater than #{min}.",radioChecked:"The selected value is not valid.",generic:"Invalid."},out:{start:function(){this.defer("start")},end:function(e){this.defer("end",e)},raise:function(e,t){this.defer("raise",e,t)},raiseAggregate:function(e,t){this.defer("raiseAggregate",e,t)},defer:function(e){var t=u.validity;(t=t.outputs[t.settings.outputMode])[e].apply(t,Array.prototype.slice.call(arguments,1))}},charClasses:{alphabetical:/\w/g,numeric:/\d/g,alphanumeric:/[A-Za-z0-9]/g,symbol:/[^A-Za-z0-9]/g},outputs:{},__private:void 0,setup:function(e){this.settings=u.extend(this.settings,e),this.__private=this.settings.debugPrivates?t:void 0},report:null,isValidating:function(){return!!this.report},start:function(){this.out.start(),this.report={errors:0,valid:!0}},end:function(){var e=this.report||{errors:0,valid:!0};return this.report=null,this.out.end(e),e},clear:function(){this.start(),this.end()}},u.fn.extend({validity:function(n){return this.each(function(){var e,t=this;"form"==this.tagName.toLowerCase()&&(e=null,"string"==typeof n?e=function(){u(n).require()}:u.isFunction(n)&&(e=n),n&&u(this).bind("submit",function(){return u.validity.start(),e.apply(t),u.validity.end().valid}))})},require:function(e){return i(this,function(e){return u(e).val()&&(null!=u(e).val()&&u(e).val().length)},e||u.validity.messages.require)},match:function(t,e){return e||(e=u.validity.messages.match,"string"==typeof t&&u.validity.messages[t]&&(e=u.validity.messages[t])),"string"==typeof t&&(t=u.validity.patterns[t]),i(this,u.isFunction(t)?function(e){return!e.value.length||t(e.value)}:function(e){return t.global&&(t.lastIndex=0),!e.value.length||t.test(e.value)},e)},range:function(t,n,e){return i(this,t.getTime&&n.getTime?function(e){return(e=new Date(e.value))>=new Date(t)&&e<=new Date(n)}:t.substring&&n.substring&&Big?function(e){return(e=new Big(e.value)).greaterThanOrEqualTo(new Big(t))&&e.lessThanOrEqualTo(new Big(n))}:function(e){return e=parseFloat(e.value),t<=e&&e<=n},e||o(u.validity.messages.range,{min:u.validity.settings.argToString(t),max:u.validity.settings.argToString(n)}))},greaterThan:function(t,e){return i(this,t.getTime?function(e){return new Date(e.value)>t}:t.substring&&Big?function(e){return new Big(e.value).greaterThan(new Big(t))}:function(e){return parseFloat(e.value)>t},e||o(u.validity.messages.greaterThan,{min:u.validity.settings.argToString(t)}))},greaterThanOrEqualTo:function(t,e){return i(this,t.getTime?function(e){return new Date(e.value)>=t}:t.substring&&Big?function(e){return new Big(e.value).greaterThanOrEqualTo(new Big(t))}:function(e){return parseFloat(e.value)>=t},e||o(u.validity.messages.greaterThanOrEqualTo,{min:u.validity.settings.argToString(t)}))},lessThan:function(t,e){return i(this,t.getTime?function(e){return new Date(e.value)<t}:t.substring&&Big?function(e){return new Big(e.value).lessThan(new Big(t))}:function(e){return parseFloat(e.value)<t},e||o(u.validity.messages.lessThan,{max:u.validity.settings.argToString(t)}))},lessThanOrEqualTo:function(t,e){return i(this,t.getTime?function(e){return new Date(e.value)<=t}:t.substring&&Big?function(e){return new Big(e.value).lessThanOrEqualTo(new Big(t))}:function(e){return parseFloat(e.value)<=t},e||o(u.validity.messages.lessThanOrEqualTo,{max:u.validity.settings.argToString(t)}))},maxLength:function(t,e){return i(this,function(e){return e.value.length<=t},e||o(u.validity.messages.tooLong,{max:t}))},minLength:function(t,e){return i(this,function(e){return e.value.length>=t},e||o(u.validity.messages.tooShort,{min:t}))},alphabet:function(n,e){var a=[];return i(this,function(e){for(var t=0;t<e.value.length;++t)if(-1==n.indexOf(e.value.charAt(t)))return a.push(e.value.charAt(t)),0;return 1},e||o(u.validity.messages.alphabet,{chars:a.join(", ")}))},minCharClass:function(t,n,e){return"string"==typeof t&&(t=t.toLowerCase(),u.validity.charClasses[t]&&(t=u.validity.charClasses[t])),i(this,function(e){return(e.value.match(t)||[]).length>=n},e||o(u.validity.messages.minCharClass,{min:n,charClass:t}))},maxCharClass:function(t,n,e){return"string"==typeof t&&(t=t.toLowerCase(),u.validity.charClasses[t]&&(t=u.validity.charClasses[t])),i(this,function(e){return(e.value.match(t)||[]).length<=n},e||o(u.validity.messages.maxCharClass,{max:n,charClass:t}))},nonHtml:function(e){return i(this,function(e){return u.validity.patterns.nonHtml.test(e.value)},e||u.validity.messages.nonHtml)},equal:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport),a=function(e){return e},i=u.validity.messages.equal;if(n.length){u.isFunction(e)?(a=e,"string"==typeof t&&(i=t)):"string"==typeof e&&(i=e);var r,o=u.map(n,function(e){return a(e.value)}),s=o[0],l=!0;for(r in o)o[r]!=s&&(l=!1);l||(h(n,i),this.reduction=u([]))}return this},distinct:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport),a=function(e){return e},i=u.validity.messages.distinct,r=[],o=[],s=!0;if(n.length){u.isFunction(e)?(a=e,"string"==typeof t&&(i=t)):"string"==typeof e&&(i=e);for(var l=u.map(n,function(e){return a(e.value)}),c=0;c<l.length;++c)if(l[c].length){for(var d=0;d<r.length;++d)r[d]==l[c]&&(s=!1,o.push(l[c]));r.push(l[c])}if(!s){for(r=0,s=(o=u.unique(o)).length;r<s;++r)h(n.filter("[value='"+o[r]+"']"),i);this.reduction=u([])}}return this},sum:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport);return n.length&&e!=a(n)&&(h(n,t||o(u.validity.messages.sum,{sum:e})),this.reduction=u([])),this},sumMax:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport);return n.length&&e<a(n)&&(h(n,t||o(u.validity.messages.sumMax,{max:e})),this.reduction=u([])),this},sumMin:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport);return n.length&&e>a(n)&&(h(n,t||o(u.validity.messages.sumMin,{min:e})),this.reduction=u([])),this},radioChecked:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport);n.is(":radio")&&n.find(":checked").val()!=e&&h(n,t||u.validity.messages.radioChecked)},radioNotChecked:function(e,t){var n=(this.reduction||this).filter(u.validity.settings.elementSupport);n.is(":radio")&&n.filter(":checked").val()==e&&h(n,t||u.validity.messages.radioChecked)},checkboxChecked:function(e){return i(this,function(e){return!u(e).is(":checkbox")||u(e).is(":checked")},e||u.validity.messages.nonHtml)},assert:function(e,t){var n=this.reduction||this;if(n.length){if(u.isFunction(e))return i(this,e,t||u.validity.messages.generic);e||(h(n,t||u.validity.messages.generic),this.reduction=u([]))}return this},fail:function(e){return this.assert(!1,e)}}),t={validate:i,addToReport:n,raiseError:r,raiseAggregateError:h,numericSum:a,format:o,infer:s,capitalize:l}}(jQuery),function(i){i.validity.outputs.tooltip={tooltipClass:"validity-tooltip",start:function(){i("."+i.validity.outputs.tooltip.tooltipClass).remove()},end:function(e){!e.valid&&i.validity.settings.scrollTo&&i(document).scrollTop(i("."+i.validity.outputs.tooltip.tooltipClass).offset().top)},raise:function(e,t){var n=e.offset();n.left+=e.width()+18,n.top+=8;var a=i('<div class="validity-tooltip">'+t+'<div class="validity-tooltip-outer"><div class="validity-tooltip-inner"></div></div></div>').click(function(){e.focus(),i(this).fadeOut()}).css(n).hide().appendTo("body").fadeIn();i.validity.settings.fadeOutTooltipsOnFocus&&e.on("focus",function(){a.fadeOut()})},raiseAggregate:function(e,t){e.length&&this.raise(e.filter(":last"),t)}}}(jQuery),function(a){function i(e){return e.attr("id").length?e.attr("id"):e.attr("name")}a.validity.outputs.label={cssClass:"error",start:function(){a("."+a.validity.outputs.label.cssClass).remove()},end:function(e){!e.valid&&a.validity.settings.scrollTo&&(location.hash=a("."+a.validity.outputs.label.cssClass+":eq(0)").attr("for"))},raise:function(e,t){var n="."+a.validity.outputs.label.cssClass+"[for='"+i(e)+"']";a(n).length?a(n).text(t):a("<label/>").attr("for",i(e)).addClass(a.validity.outputs.label.cssClass).text(t).click(function(){e.length&&e[0].select()}).insertAfter(e)},raiseAggregate:function(e,t){e.length&&this.raise(a(e.get(e.length-1)),t)}}}(jQuery),function(a){a.validity.outputs.modal={start:function(){a(".validity-modal-msg").remove()},end:function(e){!e.valid&&a.validity.settings.scrollTo&&(location.hash=a(".validity-modal-msg:eq(0)").attr("id"))},raise:function(e,t){var n;e.length&&(n=e.offset(),e.get(0),n={left:parseInt(n.left+e.width()+4,10)+"px",top:parseInt(n.top-10,10)+"px"},a("<div/>").addClass("validity-modal-msg").css(n).text(t).click(a.validity.settings.modalErrorsClickable?function(){a(this).remove()}:null).appendTo("body"))},raiseAggregate:function(e,t){e.length&&this.raise(a(e.get(e.length-1)),t)}}}(jQuery),function(t){var n=[];t.validity.outputs.summary={start:function(){t(".validity-erroneous").removeClass("validity-erroneous"),n=[]},end:function(){if(t(".validity-summary-container").stop().hide().find("ul").html(""),n.length){for(var e=0;e<n.length;++e)t("<li/>").text(n[e]).appendTo(".validity-summary-container ul");t(".validity-summary-container").show(),t.validity.settings.scrollTo&&(location.hash=t(".validity-erroneous:eq(0)").attr("id"))}},raise:function(e,t){n.push(t),e.addClass("validity-erroneous")},raiseAggregate:function(e,t){this.raise(e,t)},container:function(){document.write('<div class="validity-summary-container">The form didn\'t submit for the following reason(s):<ul></ul></div>')}}}(jQuery),function(A){A.extend({tablesorter:new function(){function S(){var e=arguments[0],t=1<arguments.length?Array.prototype.slice.call(arguments):e;"undefined"!=typeof console&&void 0!==console.log?console[/error/i.test(e)?"error":/warn/i.test(e)?"warn":"log"](t):alert(t)}function w(e,t){S(e+" ("+((new Date).getTime()-t.getTime())+"ms)")}function g(e){for(var t in e)return;return 1}function k(e,t,n){if(!t)return"";var a=e.config,i=a.textExtraction||"",r="basic"===i?A(t).attr(a.textAttribute)||t.textContent||t.innerText||A(t).text()||"":"function"==typeof i?i(t,e,n):"function"==typeof(i=D.getColumnData(e,i,n))?i(t,e,n):t.textContent||t.innerText||A(t).text()||"";return A.trim(r)}function f(e){var t,n,a,i,r,o,s,l,c,d,u,h=e.config,p=h.$tbodies=h.$table.children("tbody:not(."+h.cssInfoBlock+")"),f=0,m="",g=p.length;if(0===g)return h.debug&&S("Warning: *Empty table!* Not building a parser cache");for(h.debug&&(u=new Date,S("Detecting parsers for each column")),t=[],n=[];f<g;){if((a=p[f].rows)[f])for(i=h.columns,r=0;r<i;r++){if(o=h.$headers.filter('[data-column="'+r+'"]:last'),s=D.getColumnData(e,h.headers,r),d=D.getParserById(D.getData(o,s,"extractor")),c=D.getParserById(D.getData(o,s,"sorter")),l="false"===D.getData(o,s,"parser"),h.empties[r]=(D.getData(o,s,"empty")||h.emptyTo||(h.emptyToBottom?"bottom":"top")).toLowerCase(),h.strings[r]=(D.getData(o,s,"string")||h.stringTo||"max").toLowerCase(),l&&(c=D.getParserById("no-parser")),d=d||!1,!c)e:{o=e,s=a,l=-1,c=r;for(var v=void 0,y=D.parsers.length,C=!1,b="",v=!0;""===b&&v;)s[++l]?(b=k(o,C=s[l].cells[c],c),o.config.debug&&S("Checking if value was empty on row "+l+", column: "+c+': "'+b+'"')):v=!1;for(;0<=--y;)if((v=D.parsers[y])&&"text"!==v.id&&v.is&&v.is(b,o,C)){c=v;break e}c=D.getParserById("text")}h.debug&&(m+="column:"+r+"; extractor:"+d.id+"; parser:"+c.id+"; string:"+h.strings[r]+"; empty: "+h.empties[r]+"\n"),n[r]=c,t[r]=d}f+=n.length?g:1}h.debug&&(S(m||"No parsers detected"),w("Completed detecting parsers",u)),h.parsers=n,h.extractors=t}function m(e){var t,n,a,i,r,o,s,l,c,d,u,h=e.config,p=h.$table.children("tbody"),f=h.extractors,m=h.parsers;if(h.cache={},h.totalRows=0,!m)return h.debug&&S("Warning: *Empty table!* Not building a cache");for(h.debug&&(l=new Date),h.showProcessing&&D.isProcessing(e,!0),r=0;r<p.length;r++)if(u=[],t=h.cache[r]={normalized:[]},!p.eq(r).hasClass(h.cssInfoBlock)){for(c=p[r]&&p[r].rows.length||0,a=0;a<c;++a)if(d={child:[]},s=[],(o=A(p[r].rows[a])).hasClass(h.cssChildRow)&&0!==a)n=t.normalized.length-1,t.normalized[n][h.columns].$row=t.normalized[n][h.columns].$row.add(o),o.prev().hasClass(h.cssChildRow)||o.prev().addClass(D.css.cssHasChild),d.child[n]=A.trim(o[0].textContent||o[0].innerText||o.text()||"");else{for(d.$row=o,d.order=a,i=0;i<h.columns;++i)void 0===m[i]?h.debug&&S("No parser found for cell:",o[0].cells[i],"does it have a header?"):(n=k(e,o[0].cells[i],i),n=void 0===f[i].id?n:f[i].format(n,e,o[0].cells[i],i),n="no-parser"===m[i].id?"":m[i].format(n,e,o[0].cells[i],i),s.push(h.ignoreCase&&"string"==typeof n?n.toLowerCase():n),"numeric"===(m[i].type||"").toLowerCase()&&(u[i]=Math.max(Math.abs(n)||0,u[i]||0)));s[h.columns]=d,t.normalized.push(s)}t.colMax=u,h.totalRows+=t.normalized.length}h.showProcessing&&D.isProcessing(e),h.debug&&w("Building cache for "+c+" rows",l)}function v(e,t){var n,a,i,r,o,s,l=e.config,c=l.widgetOptions,d=e.tBodies,u=[],h=l.cache;if(g(h))return l.appender?l.appender(e,u):e.isUpdating&&l.$table.trigger("updateComplete",e);for(l.debug&&(s=new Date),o=0;o<d.length;o++)if((n=A(d[o])).length&&!n.hasClass(l.cssInfoBlock)){for(i=D.processTbody(e,n,!0),a=(n=h[o].normalized).length,r=0;r<a;r++)u.push(n[r][l.columns].$row),l.appender&&(!l.pager||l.pager.removeRows&&c.pager_removeRows||l.pager.ajax)||i.append(n[r][l.columns].$row);D.processTbody(e,i,!1)}l.appender&&l.appender(e,u),l.debug&&w("Rebuilt table",s),t||l.appender||D.applyWidget(e),e.isUpdating&&l.$table.trigger("updateComplete",e)}function l(e){return/^d/i.test(e)||1===e}function c(t){var n,a,i,r,o,e,s=t.config;s.headerList=[],s.headerContent=[],s.debug&&(e=new Date),s.columns=D.computeColumnIndex(s.$table.children("thead, tfoot").children("tr")),i=s.cssIcon?'<i class="'+(s.cssIcon===D.css.icon?D.css.icon:s.cssIcon+" "+D.css.icon)+'"></i>':"",s.$headers=A(t).find(s.selectorHeaders).each(function(e){n=A(this),o=D.getColumnData(t,s.headers,e,!0),s.headerContent[e]=A(this).html(),""!==s.headerTemplate&&(r=s.headerTemplate.replace(/\{content\}/g,A(this).html()).replace(/\{icon\}/g,i),s.onRenderTemplate&&(a=s.onRenderTemplate.apply(n,[e,r]))&&"string"==typeof a&&(r=a),A(this).html('<div class="'+D.css.headerIn+'">'+r+"</div>")),s.onRenderHeader&&s.onRenderHeader.apply(n,[e]),this.column=parseInt(A(this).attr("data-column"),10),this.order=l(D.getData(n,o,"sortInitialOrder")||s.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,this.lockedOrder=!1,void 0!==(o=D.getData(n,o,"lockedOrder")||!1)&&!1!==o&&(this.order=this.lockedOrder=l(o)?[1,1,1]:[0,0,0]),n.addClass(D.css.header+" "+s.cssHeader),s.headerList[e]=this,n.parent().addClass(D.css.headerRow+" "+s.cssHeaderRow).attr("role","row"),s.tabIndex&&n.attr("tabindex",0)}).attr({scope:"col",role:"columnheader"}),C(t),s.debug&&(w("Built headers:",e),S(s.$headers))}function y(e,t,n){var a=e.config;a.$table.find(a.selectorRemove).remove(),f(e),m(e),x(a.$table,t,n)}function C(n){var a,i,r=n.config;r.$headers.each(function(e,t){a=A(t),i=D.getColumnData(n,r.headers,e,!0),i="false"===D.getData(t,i,"sorter")||"false"===D.getData(t,i,"parser"),t.sortDisabled=i,a[i?"addClass":"removeClass"]("sorter-false").attr("aria-disabled",""+i),n.id&&(i?a.removeAttr("aria-controls"):a.attr("aria-controls",n.id))})}function b(e){var t,n,a=e.config,i=a.sortList,r=i.length,o=D.css.sortNone+" "+a.cssNone,s=[D.css.sortAsc+" "+a.cssAsc,D.css.sortDesc+" "+a.cssDesc],l=["ascending","descending"],c=A(e).find("tfoot tr").children().add(a.$extraHeaders).removeClass(s.join(" "));for(a.$headers.removeClass(s.join(" ")).addClass(o).attr("aria-sort","none"),t=0;t<r;t++)if(2!==i[t][1]&&(e=a.$headers.not(".sorter-false").filter('[data-column="'+i[t][0]+'"]'+(1===r?":last":""))).length){for(n=0;n<e.length;n++)e[n].sortDisabled||e.eq(n).removeClass(o).addClass(s[i[t][1]]).attr("aria-sort",l[i[t][1]]);c.length&&c.filter('[data-column="'+i[t][0]+'"]').removeClass(o).addClass(s[i[t][1]])}a.$headers.not(".sorter-false").each(function(){var e=A(this),t=this.order[(this.count+1)%(a.sortReset?3:2)],t=e.text()+": "+D.language[e.hasClass(D.css.sortAsc)?"sortAsc":e.hasClass(D.css.sortDesc)?"sortDesc":"sortNone"]+D.language[0===t?"nextAsc":1===t?"nextDesc":"nextNone"];e.attr("aria-label",t)})}function M(i){var r,e,o,t,s,l,c,d,u,h=i.config,p=h.textSorter||"",f=h.sortList,m=f.length,n=i.tBodies.length;if(!h.serverSideSorting&&!g(h.cache)){for(h.debug&&(t=new Date),e=0;e<n;e++)s=h.cache[e].colMax,h.cache[e].normalized.sort(function(e,t){for(r=0;r<m&&(o=f[r][0],l=f[r][1],u=0===l,!h.sortStable||e[o]!==t[o]||1!==m);r++)if(d=/n/i.test((n=h.parsers,a=o,n&&n[a]&&n[a].type||""))&&h.strings[o]?(c="boolean"==typeof h.string[h.strings[o]]?(u?1:-1)*(h.string[h.strings[o]]?-1:1):h.strings[o]&&h.string[h.strings[o]]||0,h.numberSorter?h.numberSorter(e[o],t[o],u,s[o],i):D["sortNumeric"+(u?"Asc":"Desc")](e[o],t[o],c,s[o],o,i)):(c=u?e:t,d=u?t:e,"function"==typeof p?p(c[o],d[o],u,o,i):"object"==typeof p&&p.hasOwnProperty(o)?p[o](c[o],d[o],u,o,i):D["sortNatural"+(u?"Asc":"Desc")](e[o],t[o],o,i,h)))return d;var n,a;return e[h.columns].order-t[h.columns].order});h.debug&&w("Sorting on "+f.toString()+" and dir "+l+" time",t)}}function i(e,t){var n=e[0];n.isUpdating&&e.trigger("updateComplete",n),A.isFunction(t)&&t(e[0])}function x(e,t,n){var a=e[0].config.sortList;!1!==t&&!e[0].isProcessing&&a.length?e.trigger("sorton",[a,function(){i(e,n)},!0]):(i(e,n),D.applyWidget(e[0],!1))}function d(u){var h=u.config,p=h.$table;p.unbind("sortReset update updateRows updateCell updateAll addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave ".split(" ").join(h.namespace+" ")).bind("sortReset"+h.namespace,function(e,t){e.stopPropagation(),h.sortList=[],b(u),M(u),v(u),A.isFunction(t)&&t(u)}).bind("updateAll"+h.namespace,function(e,t,n){e.stopPropagation(),u.isUpdating=!0,D.refreshWidgets(u,!0,!0),D.restoreHeaders(u),c(u),D.bindEvents(u,h.$headers,!0),d(u),y(u,t,n)}).bind("update"+h.namespace+" updateRows"+h.namespace,function(e,t,n){e.stopPropagation(),u.isUpdating=!0,C(u),y(u,t,n)}).bind("updateCell"+h.namespace,function(e,t,n,a){var i,r,o;e.stopPropagation(),u.isUpdating=!0,p.find(h.selectorRemove).remove(),r=p.find("tbody"),o=A(t),e=r.index(A.fn.closest?o.closest("tbody"):o.parents("tbody").filter(":first")),i=A.fn.closest?o.closest("tr"):o.parents("tr").filter(":first"),t=o[0],r.length&&0<=e&&(r=r.eq(e).find("tr").index(i),o=o.index(),h.cache[e].normalized[r][h.columns].$row=i,i=void 0===h.extractors[o].id?k(u,t,o):h.extractors[o].format(k(u,t,o),u,t,o),t="no-parser"===h.parsers[o].id?"":h.parsers[o].format(i,u,t,o),h.cache[e].normalized[r][o]=h.ignoreCase&&"string"==typeof t?t.toLowerCase():t,"numeric"===(h.parsers[o].type||"").toLowerCase()&&(h.cache[e].colMax[o]=Math.max(Math.abs(t)||0,h.cache[e].colMax[o]||0)),x(p,n,a))}).bind("addRows"+h.namespace,function(e,t,n,a){if(e.stopPropagation(),u.isUpdating=!0,g(h.cache))C(u),y(u,n,a);else{var i,r,o,s,l,c=(t=A(t).attr("role","row")).filter("tr").length,d=p.find("tbody").index(t.parents("tbody").filter(":first"));for(h.parsers&&h.parsers.length||f(u),e=0;e<c;e++){for(r=t[e].cells.length,l=[],s={child:[],$row:t.eq(e),order:h.cache[d].normalized.length},i=0;i<r;i++)o=void 0===h.extractors[i].id?k(u,t[e].cells[i],i):h.extractors[i].format(k(u,t[e].cells[i],i),u,t[e].cells[i],i),o="no-parser"===h.parsers[i].id?"":h.parsers[i].format(o,u,t[e].cells[i],i),l[i]=h.ignoreCase&&"string"==typeof o?o.toLowerCase():o,"numeric"===(h.parsers[i].type||"").toLowerCase()&&(h.cache[d].colMax[i]=Math.max(Math.abs(l[i])||0,h.cache[d].colMax[i]||0));l.push(s),h.cache[d].normalized.push(l)}x(p,n,a)}}).bind("updateComplete"+h.namespace,function(){u.isUpdating=!1}).bind("sorton"+h.namespace,function(e,t,n,a){var i,r,o,s,l,c,d=u.config;e.stopPropagation(),p.trigger("sortStart",this),t=t,c=u.config,t=t||c.sortList,c.sortList=[],A.each(t,function(e,t){if(s=parseInt(t[0],10),o=c.$headers.filter('[data-column="'+s+'"]:last')[0]){switch(r=(r=(""+t[1]).match(/^(1|d|s|o|n)/))?r[0]:""){case"1":case"d":r=1;break;case"s":r=l||0;break;case"o":i=o.order[(l||0)%(c.sortReset?3:2)],r=0===i?1:1===i?0:2;break;case"n":o.count+=1,r=o.order[o.count%(c.sortReset?3:2)];break;default:r=0}l=0===e?r:l,i=[s,parseInt(r,10)||0],c.sortList.push(i),r=A.inArray(i[1],o.order),o.count=0<=r?r:i[1]%(c.sortReset?3:2)}}),b(u),d.delayInit&&g(d.cache)&&m(u),p.trigger("sortBegin",this),M(u),v(u,a),p.trigger("sortEnd",this),D.applyWidget(u),A.isFunction(n)&&n(u)}).bind("appendCache"+h.namespace,function(e,t,n){e.stopPropagation(),v(u,n),A.isFunction(t)&&t(u)}).bind("updateCache"+h.namespace,function(e,t){h.parsers&&h.parsers.length||f(u),m(u),A.isFunction(t)&&t(u)}).bind("applyWidgetId"+h.namespace,function(e,t){e.stopPropagation(),D.getWidgetById(t).format(u,h,h.widgetOptions)}).bind("applyWidgets"+h.namespace,function(e,t){e.stopPropagation(),D.applyWidget(u,t)}).bind("refreshWidgets"+h.namespace,function(e,t,n){e.stopPropagation(),D.refreshWidgets(u,t,n)}).bind("destroy"+h.namespace,function(e,t,n){e.stopPropagation(),D.destroy(u,t,n)}).bind("resetToLoadState"+h.namespace,function(){D.refreshWidgets(u,!0,!0),h=A.extend(!0,D.defaults,h.originalSettings),u.hasInitialized=!1,D.setup(u,h)})}var D=this;D.version="2.17.8",D.parsers=[],D.widgets=[],D.defaults={theme:"default",widthFixed:!1,showProcessing:!1,headerTemplate:"{content}",onRenderTemplate:null,onRenderHeader:null,cancelSelection:!0,tabIndex:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",sortResetKey:"ctrlKey",usNumberFormat:!0,delayInit:!1,serverSideSorting:!1,headers:{},ignoreCase:!0,sortForce:null,sortList:[],sortAppend:null,sortStable:!1,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"basic",textAttribute:"data-text",textSorter:null,numberSorter:null,widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,tableClass:"",cssAsc:"",cssDesc:"",cssNone:"",cssHeader:"",cssHeaderRow:"",cssProcessing:"",cssChildRow:"tablesorter-childRow",cssIcon:"tablesorter-icon",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"> thead th, > thead td",selectorSort:"th, td",selectorRemove:".remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},D.css={table:"tablesorter",cssHasChild:"tablesorter-hasChildRow",childRow:"tablesorter-childRow",header:"tablesorter-header",headerRow:"tablesorter-headerRow",headerIn:"tablesorter-header-inner",icon:"tablesorter-icon",info:"tablesorter-infoOnly",processing:"tablesorter-processing",sortAsc:"tablesorter-headerAsc",sortDesc:"tablesorter-headerDesc",sortNone:"tablesorter-headerUnSorted"},D.language={sortAsc:"Ascending sort applied, ",sortDesc:"Descending sort applied, ",sortNone:"No sort applied, ",nextAsc:"activate to apply an ascending sort",nextDesc:"activate to apply a descending sort",nextNone:"activate to remove the sort"},D.log=S,D.benchmark=w,D.construct=function(t){return this.each(function(){var e=A.extend(!0,{},D.defaults,t);e.originalSettings=t,!this.hasInitialized&&D.buildTable&&"TABLE"!==this.tagName?D.buildTable(this,e):D.setup(this,e)})},D.setup=function(t,n){if(!t||!t.tHead||0===t.tBodies.length||!0===t.hasInitialized)return n.debug?S("ERROR: stopping initialization! No table, thead, tbody or tablesorter has already been initialized"):"";var e,a,i,r="",o=A(t),s=A.metadata;t.hasInitialized=!1,t.isProcessing=!0,t.config=n,A.data(t,"tablesorter",n),n.debug&&A.data(t,"startoveralltimer",new Date),n.supportsDataObject=((e=A.fn.jquery.split("."))[0]=parseInt(e[0],10),1<e[0]||1===e[0]&&4<=parseInt(e[1],10)),n.string={max:1,min:-1,emptymin:1,emptymax:-1,zero:0,none:0,null:0,top:!0,bottom:!1},n.emptyTo=n.emptyTo.toLowerCase(),n.stringTo=n.stringTo.toLowerCase(),/tablesorter\-/.test(o.attr("class"))||(r=""!==n.theme?" tablesorter-"+n.theme:""),n.table=t,n.$table=o.addClass(D.css.table+" "+n.tableClass+r).attr("role","grid"),n.$headers=o.find(n.selectorHeaders),n.namespace=n.namespace?"."+n.namespace.replace(/\W/g,""):".tablesorter"+Math.random().toString(16).slice(2),n.$table.children().children("tr").attr("role","row"),n.$tbodies=o.children("tbody:not(."+n.cssInfoBlock+")").attr({"aria-live":"polite","aria-relevant":"all"}),n.$table.find("caption").length&&n.$table.attr("aria-labelledby","theCaption"),n.widgetInit={},n.textExtraction=n.$table.attr("data-text-extraction")||n.textExtraction||"basic",c(t),(r=(e=t).config).widthFixed&&0===r.$table.find("colgroup").length&&(a=A("<colgroup>"),i=A(e).width(),A(e.tBodies).not("."+r.cssInfoBlock).find("tr:first").children(":visible").each(function(){a.append(A("<col>").css("width",parseInt(A(this).width()/i*1e3,10)/10+"%"))}),r.$table.prepend(a)),f(t),n.totalRows=0,n.delayInit||m(t),D.bindEvents(t,n.$headers,!0),d(t),n.supportsDataObject&&void 0!==o.data().sortlist?n.sortList=o.data().sortlist:s&&o.metadata()&&o.metadata().sortlist&&(n.sortList=o.metadata().sortlist),D.applyWidget(t,!0),0<n.sortList.length?o.trigger("sorton",[n.sortList,{},!n.initWidgets,!0]):(b(t),n.initWidgets&&D.applyWidget(t,!1)),n.showProcessing&&o.unbind("sortBegin"+n.namespace+" sortEnd"+n.namespace).bind("sortBegin"+n.namespace+" sortEnd"+n.namespace,function(e){clearTimeout(n.processTimer),D.isProcessing(t),"sortBegin"===e.type&&(n.processTimer=setTimeout(function(){D.isProcessing(t,!0)},500))}),t.hasInitialized=!0,t.isProcessing=!1,n.debug&&D.benchmark("Overall initialization time",A.data(t,"startoveralltimer")),o.trigger("tablesorter-initialized",t),"function"==typeof n.initialized&&n.initialized(t)},D.getColumnData=function(e,t,n,a){if(null!=t){var i,r=(e=A(e)[0]).config;if(t[n])return a?t[n]:t[r.$headers.index(r.$headers.filter('[data-column="'+n+'"]:last'))];for(i in t)if("string"==typeof i&&(e=(a?r.$headers.eq(n):r.$headers.filter('[data-column="'+n+'"]:last')).filter(i),e.length))return t[i]}},D.computeColumnIndex=function(e){for(var t,n,a,i,r,o,s,l,c,d=[],u=0,h=0;h<e.length;h++)for(i=e[h].cells,t=0;t<i.length;t++){for(n=i[t],a=A(n),r=n.parentNode.rowIndex,a.index(),o=n.rowSpan||1,s=n.colSpan||1,void 0===d[r]&&(d[r]=[]),n=0;n<d[r].length+1;n++)if(void 0===d[r][n]){l=n;break}for(u=Math.max(l,u),a.attr({"data-column":l}),n=r;n<r+o;n++)for(void 0===d[n]&&(d[n]=[]),c=d[n],a=l;a<l+s;a++)c[a]="x"}return u+1},D.isProcessing=function(e,t,n){var a=(e=A(e))[0].config,i=n||e.find("."+D.css.header);t?(void 0!==n&&0<a.sortList.length&&(i=i.filter(function(){return!this.sortDisabled&&0<=D.isValueInArray(parseFloat(A(this).attr("data-column")),a.sortList)})),e.add(i).addClass(D.css.processing+" "+a.cssProcessing)):e.add(i).removeClass(D.css.processing+" "+a.cssProcessing)},D.processTbody=function(e,t,n){if(e=A(e)[0],n)return e.isProcessing=!0,t.before('<span class="tablesorter-savemyplace"/>'),A.fn.detach?t.detach():t.remove();n=A(e).find("span.tablesorter-savemyplace"),t.insertAfter(n),n.remove(),e.isProcessing=!1},D.clearTableBody=function(e){A(e)[0].config.$tbodies.children().detach()},D.bindEvents=function(a,i,e){var r,o=(a=A(a)[0]).config;!0!==e&&(o.$extraHeaders=o.$extraHeaders?o.$extraHeaders.add(i):i),i.find(o.selectorSort).add(i.filter(o.selectorSort)).unbind(["mousedown","mouseup","sort","keyup",""].join(o.namespace+" ")).bind(["mousedown","mouseup","sort","keyup",""].join(o.namespace+" "),function(e,t){var n=e.type;if(!(1!==(e.which||e.button)&&!/sort|keyup/.test(n)||"keyup"===n&&13!==e.which||"mouseup"===n&&!0!==t&&250<(new Date).getTime()-r)){if("mousedown"===n)return r=(new Date).getTime(),/(input|select|button|textarea)/i.test(e.target.tagName)?"":!o.cancelSelection;o.delayInit&&g(o.cache)&&m(a),n=A.fn.closest?A(this).closest("th, td")[0]:/TH|TD/.test(this.tagName)?this:A(this).parents("th, td")[0],(n=o.$headers[i.index(n)]).sortDisabled||function e(t,n,a){if(t.isUpdating)return setTimeout(function(){e(t,n,a)},50);var i,r,o,s,l=t.config,c=!a[l.sortMultiSortKey],d=l.$table;if(d.trigger("sortStart",t),n.count=a[l.sortResetKey]?2:(n.count+1)%(l.sortReset?3:2),l.sortRestart&&(r=n,l.$headers.each(function(){this===r||!c&&A(this).is("."+D.css.sortDesc+",."+D.css.sortAsc)||(this.count=-1)})),r=n.column,c){if(l.sortList=[],null!==l.sortForce)for(i=l.sortForce,o=0;o<i.length;o++)i[o][0]!==r&&l.sortList.push(i[o]);if((i=n.order[n.count])<2&&(l.sortList.push([r,i]),1<n.colSpan))for(o=1;o<n.colSpan;o++)l.sortList.push([r+o,i])}else{if(l.sortAppend&&1<l.sortList.length)for(o=0;o<l.sortAppend.length;o++)0<=(s=D.isValueInArray(l.sortAppend[o][0],l.sortList))&&l.sortList.splice(s,1);if(0<=D.isValueInArray(r,l.sortList))for(o=0;o<l.sortList.length;o++)s=l.sortList[o],i=l.$headers.filter('[data-column="'+s[0]+'"]:last')[0],s[0]===r&&(s[1]=i.order[n.count],2===s[1]&&(l.sortList.splice(o,1),i.count=-1));else if((i=n.order[n.count])<2&&(l.sortList.push([r,i]),1<n.colSpan))for(o=1;o<n.colSpan;o++)l.sortList.push([r+o,i])}if(null!==l.sortAppend)for(i=l.sortAppend,o=0;o<i.length;o++)i[o][0]!==r&&l.sortList.push(i[o]);d.trigger("sortBegin",t),setTimeout(function(){b(t),M(t),v(t),d.trigger("sortEnd",t)},1)}(a,n,e)}}),o.cancelSelection&&i.attr("unselectable","on").bind("selectstart",!1).css({"user-select":"none",MozUserSelect:"none"})},D.restoreHeaders=function(e){var t=A(e)[0].config;t.$table.find(t.selectorHeaders).each(function(e){A(this).find("."+D.css.headerIn).length&&A(this).html(t.headerContent[e])})},D.destroy=function(e,t,n){var a,i,r,o,s;(e=A(e)[0]).hasInitialized&&(D.refreshWidgets(e,!0,!0),a=A(e),i=e.config,o=(r=a.find("thead:first")).find("tr."+D.css.headerRow).removeClass(D.css.headerRow+" "+i.cssHeaderRow),s=a.find("tfoot:first > tr").children("th, td"),!1===t&&0<=A.inArray("uitheme",i.widgets)&&(a.trigger("applyWidgetId",["uitheme"]),a.trigger("applyWidgetId",["zebra"])),r.find("tr").not(o).remove(),a.removeData("tablesorter").unbind("sortReset update updateAll updateRows updateCell addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave keypress sortBegin sortEnd resetToLoadState ".split(" ").join(i.namespace+" ")),i.$headers.add(s).removeClass([D.css.header,i.cssHeader,i.cssAsc,i.cssDesc,D.css.sortAsc,D.css.sortDesc,D.css.sortNone].join(" ")).removeAttr("data-column").removeAttr("aria-label").attr("aria-disabled","true"),o.find(i.selectorSort).unbind(["mousedown","mouseup","keypress",""].join(i.namespace+" ")),D.restoreHeaders(e),a.toggleClass(D.css.table+" "+i.tableClass+" tablesorter-"+i.theme,!1===t),e.hasInitialized=!1,delete e.config.cache,"function"==typeof n&&n(e))},D.regex={chunk:/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,chunks:/(^\\0|\\0$)/,hex:/^0x[0-9a-f]+$/i},D.sortNatural=function(e,t){if(e===t)return 0;var n,a,i,r,o,s=D.regex;if(s.hex.test(t)){if((n=parseInt(e.match(s.hex),16))<(a=parseInt(t.match(s.hex),16)))return-1;if(a<n)return 1}for(n=e.replace(s.chunk,"\\0$1\\0").replace(s.chunks,"").split("\\0"),s=t.replace(s.chunk,"\\0$1\\0").replace(s.chunks,"").split("\\0"),o=Math.max(n.length,s.length),r=0;r<o;r++){if(a=isNaN(n[r])?n[r]||0:parseFloat(n[r])||0,i=isNaN(s[r])?s[r]||0:parseFloat(s[r])||0,isNaN(a)!==isNaN(i))return isNaN(a)?1:-1;if(typeof a!=typeof i&&(a+="",i+=""),a<i)return-1;if(i<a)return 1}return 0},D.sortNaturalAsc=function(e,t,n,a,i){return e===t?0:(n=i.string[i.empties[n]||i.emptyTo],""===e&&0!==n?"boolean"==typeof n?n?-1:1:-n||-1:""===t&&0!==n?"boolean"==typeof n?n?1:-1:n||1:D.sortNatural(e,t))},D.sortNaturalDesc=function(e,t,n,a,i){return e===t?0:(n=i.string[i.empties[n]||i.emptyTo],""===e&&0!==n?"boolean"==typeof n?n?-1:1:n||1:""===t&&0!==n?"boolean"==typeof n?n?1:-1:-n||-1:D.sortNatural(t,e))},D.sortText=function(e,t){return t<e?1:e<t?-1:0},D.getTextValue=function(e,t,n){if(n){var a=e?e.length:0,i=n+t;for(n=0;n<a;n++)i+=e.charCodeAt(n);return t*i}return 0},D.sortNumericAsc=function(e,t,n,a,i,r){return e===t?0:(i=(r=r.config).string[r.empties[i]||r.emptyTo],""===e&&0!==i?"boolean"==typeof i?i?-1:1:-i||-1:""===t&&0!==i?"boolean"==typeof i?i?1:-1:i||1:(isNaN(e)&&(e=D.getTextValue(e,n,a)),isNaN(t)&&(t=D.getTextValue(t,n,a)),e-t))},D.sortNumericDesc=function(e,t,n,a,i,r){return e===t?0:(i=(r=r.config).string[r.empties[i]||r.emptyTo],""===e&&0!==i?"boolean"==typeof i?i?-1:1:i||1:""===t&&0!==i?"boolean"==typeof i?i?1:-1:-i||-1:(isNaN(e)&&(e=D.getTextValue(e,n,a)),isNaN(t)&&(t=D.getTextValue(t,n,a)),t-e))},D.sortNumeric=function(e,t){return e-t},D.characterEquivalents={a:"",A:"",c:"",C:"",e:"",E:"",i:"",I:"",o:"",O:"",ss:"",SS:"",u:"",U:""},D.replaceAccents=function(e){var t,n="[",a=D.characterEquivalents;if(!D.characterRegex){for(t in D.characterRegexArray={},a)"string"==typeof t&&(n+=a[t],D.characterRegexArray[t]=new RegExp("["+a[t]+"]","g"));D.characterRegex=new RegExp(n+"]")}if(D.characterRegex.test(e))for(t in a)"string"==typeof t&&(e=e.replace(D.characterRegexArray[t],t));return e},D.isValueInArray=function(e,t){for(var n=t.length,a=0;a<n;a++)if(t[a][0]===e)return a;return-1},D.addParser=function(e){for(var t=D.parsers.length,n=!0,a=0;a<t;a++)D.parsers[a].id.toLowerCase()===e.id.toLowerCase()&&(n=!1);n&&D.parsers.push(e)},D.getParserById=function(e){if("false"==e)return!1;for(var t=D.parsers.length,n=0;n<t;n++)if(D.parsers[n].id.toLowerCase()===e.toString().toLowerCase())return D.parsers[n];return!1},D.addWidget=function(e){D.widgets.push(e)},D.hasWidget=function(e,t){return(e=A(e)).length&&e[0].config&&e[0].config.widgetInit[t]||!1},D.getWidgetById=function(e){for(var t,n=D.widgets.length,a=0;a<n;a++)if((t=D.widgets[a])&&t.hasOwnProperty("id")&&t.id.toLowerCase()===e.toLowerCase())return t},D.applyWidget=function(n,a){var e,t,i,r=(n=A(n)[0]).config,o=r.widgetOptions,s=[];!1!==a&&n.hasInitialized&&(n.isApplyingWidgets||n.isUpdating)||(r.debug&&(e=new Date),r.widgets.length&&(n.isApplyingWidgets=!0,r.widgets=A.grep(r.widgets,function(e,t){return A.inArray(e,r.widgets)===t}),A.each(r.widgets||[],function(e,t){(i=D.getWidgetById(t))&&i.id&&(i.priority||(i.priority=10),s[e]=i)}),s.sort(function(e,t){return e.priority<t.priority?-1:e.priority===t.priority?0:1}),A.each(s,function(e,t){t&&(!a&&r.widgetInit[t.id]||(r.widgetInit[t.id]=!0,t.hasOwnProperty("options")&&(o=n.config.widgetOptions=A.extend(!0,{},t.options,o)),t.hasOwnProperty("init")&&t.init(n,t,r,o)),!a&&t.hasOwnProperty("format")&&t.format(n,r,o,!1))})),setTimeout(function(){n.isApplyingWidgets=!1},0),r.debug&&(t=r.widgets.length,w("Completed "+(!0===a?"initializing ":"applying ")+t+" widget"+(1!==t?"s":""),e)))},D.refreshWidgets=function(e,t,n){for(var a=(e=A(e)[0]).config,i=a.widgets,r=D.widgets,o=r.length,s=0;s<o;s++)r[s]&&r[s].id&&(t||A.inArray(r[s].id,i)<0)&&(a.debug&&S('Refeshing widgets: Removing "'+r[s].id+'"'),r[s].hasOwnProperty("remove")&&a.widgetInit[r[s].id]&&(r[s].remove(e,a,a.widgetOptions),a.widgetInit[r[s].id]=!1));!0!==n&&D.applyWidget(e,t)},D.getData=function(e,t,n){var a,i,r="";return(e=A(e)).length?(a=!!A.metadata&&e.metadata(),i=" "+(e.attr("class")||""),void 0!==e.data(n)||void 0!==e.data(n.toLowerCase())?r+=e.data(n)||e.data(n.toLowerCase()):a&&void 0!==a[n]?r+=a[n]:t&&void 0!==t[n]?r+=t[n]:" "!==i&&i.match(" "+n+"-")&&(r=i.match(new RegExp("\\s"+n+"-([\\w-]+)"))[1]||""),A.trim(r)):""},D.formatFloat=function(e,t){return"string"!=typeof e||""===e?e:(e=(t&&t.config?!1!==t.config.usNumberFormat:void 0===t||t)?e.replace(/,/g,""):e.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(e)&&(e=e.replace(/^\s*\(([.\d]+)\)/,"-$1")),t=parseFloat(e),isNaN(t)?A.trim(e):t)},D.isDigit=function(e){return!isNaN(e)||/^[\-+(]?\d+[)]?$/.test(e.toString().replace(/[,.'"\s]/g,""))}}});var c=A.tablesorter;A.fn.extend({tablesorter:c.construct}),c.addParser({id:"no-parser",is:function(){return!1},format:function(){return""},type:"text"}),c.addParser({id:"text",is:function(){return!0},format:function(e,t){t=t.config;return e&&(e=A.trim(t.ignoreCase?e.toLocaleLowerCase():e),e=t.sortLocaleCompare?c.replaceAccents(e):e),e},type:"text"}),c.addParser({id:"digit",is:function(e){return c.isDigit(e)},format:function(e,t){var n=c.formatFloat((e||"").replace(/[^\w,. \-()]/g,""),t);return e&&"number"==typeof n?n:e&&A.trim(e&&t.config.ignoreCase?e.toLocaleLowerCase():e)},type:"numeric"}),c.addParser({id:"currency",is:function(e){return/^\(?\d+[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]|[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+\)?$/.test((e||"").replace(/[+\-,. ]/g,""))},format:function(e,t){var n=c.formatFloat((e||"").replace(/[^\w,. \-()]/g,""),t);return e&&"number"==typeof n?n:e&&A.trim(e&&t.config.ignoreCase?e.toLocaleLowerCase():e)},type:"numeric"}),c.addParser({id:"ipAddress",is:function(e){return/^\d{1,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(e)},format:function(e,t){for(var n=e?e.split("."):"",a="",i=n.length,r=0;r<i;r++)a+=("00"+n[r]).slice(-3);return e&&c.formatFloat(a,t)},type:"numeric"}),c.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\//.test(e)},format:function(e){return e&&A.trim(e.replace(/(https?|ftp|file):\/\//,""))},parsed:!0,type:"text"}),c.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/.test(e)},format:function(e,t){return e&&c.formatFloat(""!==e?new Date(e.replace(/-/g,"/")).getTime()||e:"",t)},type:"numeric"}),c.addParser({id:"percent",is:function(e){return/(\d\s*?%|%\s*?\d)/.test(e)&&e.length<15},format:function(e,t){return e&&c.formatFloat(e.replace(/%/g,""),t)},type:"numeric"}),c.addParser({id:"usLongDate",is:function(e){return/^[A-Z]{3,10}\.?\s+\d{1,2},?\s+(\d{4})(\s+\d{1,2}:\d{2}(:\d{2})?(\s+[AP]M)?)?$/i.test(e)||/^\d{1,2}\s+[A-Z]{3,10}\s+\d{4}/i.test(e)},format:function(e,t){return e&&c.formatFloat(new Date(e.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||e,t)},type:"numeric"}),c.addParser({id:"shortDate",is:function(e){return/(^\d{1,2}[\/\s]\d{1,2}[\/\s]\d{4})|(^\d{4}[\/\s]\d{1,2}[\/\s]\d{1,2})/.test((e||"").replace(/\s+/g," ").replace(/[\-.,]/g,"/"))},format:function(e,t,n,a){var i;return e&&(a=(i=(n=t.config).$headers.filter("[data-column="+a+"]:last")).length&&i[0].dateFormat||c.getData(i,c.getColumnData(t,n.headers,a),"dateFormat")||n.dateFormat,e=e.replace(/\s+/g," ").replace(/[\-.,]/g,"/"),"mmddyyyy"===a?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2"):"ddmmyyyy"===a?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1"):"yyyymmdd"===a&&(e=e.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3"))),e&&c.formatFloat(new Date(e).getTime()||e,t)},type:"numeric"}),c.addParser({id:"time",is:function(e){return/^(([0-2]?\d:[0-5]\d)|([0-1]?\d:[0-5]\d\s?([AP]M)))$/i.test(e)},format:function(e,t){return e&&c.formatFloat(new Date("2000/01/01 "+e.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||e,t)},type:"numeric"}),c.addParser({id:"metadata",is:function(){return!1},format:function(e,t,n){return e=(e=t.config).parserMetadataName||"sortValue",A(n).metadata()[e]},type:"numeric"}),c.addWidget({id:"zebra",priority:90,format:function(e,t,n){var a,i,r,o,s=new RegExp(t.cssChildRow,"i"),l=t.$tbodies;for(t.debug&&(o=new Date),e=0;e<l.length;e++)i=0,l.eq(e).children("tr:visible").not(t.selectorRemove).each(function(){a=A(this),s.test(this.className)||i++,r=0==i%2,a.removeClass(n.zebra[r?1:0]).addClass(n.zebra[r?0:1])});t.debug&&c.benchmark("Applying Zebra widget",o)},remove:function(e,t,n){var a;t=t.$tbodies;var i=(n.zebra||["even","odd"]).join(" ");for(n=0;n<t.length;n++)(a=A.tablesorter.processTbody(e,t.eq(n),!0)).children().removeClass(i),A.tablesorter.processTbody(e,a,!1)}})}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(w){function a(e,t){var n,a,i=e.nodeName.toLowerCase();return"area"===i?(a=(n=e.parentNode).name,!(!e.href||!a||"map"!==n.nodeName.toLowerCase())&&(!!(a=w("img[usemap='#"+a+"']")[0])&&r(a))):(/^(input|select|textarea|button|object)$/.test(i)?!e.disabled:"a"===i&&e.href||t)&&r(e)}function r(e){return w.expr.filters.visible(e)&&!w(e).parents().addBack().filter(function(){return"hidden"===w.css(this,"visibility")}).length}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},w.extend(this._defaults,this.regional[""]),this.regional.en=w.extend(!0,{},this.regional[""]),this.regional["en-US"]=w.extend(!0,{},this.regional.en),this.dpDiv=n(w("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){w(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&w(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&w(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",o)}function o(){w.datepicker._isDisabledDatepicker((d.inline?d.dpDiv.parent():d.input)[0])||(w(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),w(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&w(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&w(this).addClass("ui-datepicker-next-hover"))}function l(e,t){for(var n in w.extend(e,t),t)null==t[n]&&(e[n]=t[n]);return e}var t,i,s,c,d;w.ui=w.ui||{},w.extend(w.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),w.fn.extend({scrollParent:function(e){var t=this.css("position"),n="absolute"===t,a=e?/(auto|scroll|hidden)/:/(auto|scroll)/,e=this.parents().filter(function(){var e=w(this);return(!n||"static"!==e.css("position"))&&a.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&e.length?e:w(this[0].ownerDocument||document)},uniqueId:(c=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++c)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&w(this).removeAttr("id")})}}),w.extend(w.expr[":"],{data:w.expr.createPseudo?w.expr.createPseudo(function(t){return function(e){return!!w.data(e,t)}}):function(e,t,n){return!!w.data(e,n[3])},focusable:function(e){return a(e,!isNaN(w.attr(e,"tabindex")))},tabbable:function(e){var t=w.attr(e,"tabindex"),n=isNaN(t);return(n||0<=t)&&a(e,!n)}}),w("<a>").outerWidth(1).jquery||w.each(["Width","Height"],function(e,n){function a(e,t,n,a){return w.each(i,function(){t-=parseFloat(w.css(e,"padding"+this))||0,n&&(t-=parseFloat(w.css(e,"border"+this+"Width"))||0),a&&(t-=parseFloat(w.css(e,"margin"+this))||0)}),t}var i="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),o={innerWidth:w.fn.innerWidth,innerHeight:w.fn.innerHeight,outerWidth:w.fn.outerWidth,outerHeight:w.fn.outerHeight};w.fn["inner"+n]=function(e){return void 0===e?o["inner"+n].call(this):this.each(function(){w(this).css(r,a(this,e)+"px")})},w.fn["outer"+n]=function(e,t){return"number"!=typeof e?o["outer"+n].call(this,e):this.each(function(){w(this).css(r,a(this,e,!0,t)+"px")})}}),w.fn.addBack||(w.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),w("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(w.fn.removeData=(s=w.fn.removeData,function(e){return arguments.length?s.call(this,w.camelCase(e)):s.call(this)})),w.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),w.fn.extend({focus:(i=w.fn.focus,function(t,n){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){w(e).focus(),n&&n.call(e)},t)}):i.apply(this,arguments)}),disableSelection:(t="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(t+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,n,a=w(this[0]);a.length&&a[0]!==document;){if(("absolute"===(t=a.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(a.css("zIndex"),10),!isNaN(n)&&0!==n))return n;a=a.parent()}return 0}}),w.ui.plugin={add:function(e,t,n){var a,i=w.ui[e].prototype;for(a in n)i.plugins[a]=i.plugins[a]||[],i.plugins[a].push([t,n[a]])},call:function(e,t,n,a){var i,r=e.plugins[t];if(r&&(a||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;r.length>i;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},w.extend(w.ui,{datepicker:{version:"1.11.4"}}),w.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return l(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var n,a=e.nodeName.toLowerCase(),i="div"===a||"span"===a;e.id||(this.uuid+=1,e.id="dp"+this.uuid),(n=this._newInst(w(e),i)).settings=w.extend({},t||{}),"input"===a?this._connectDatepicker(e,n):i&&this._inlineDatepicker(e,n)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?n(w("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var n=w(e);t.append=w([]),t.trigger=w([]),n.hasClass(this.markerClassName)||(this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),w.data(e,"datepicker",t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var n,a=this._get(t,"appendText"),i=this._get(t,"isRTL");t.append&&t.append.remove(),a&&(t.append=w("<span class='"+this._appendClass+"'>"+a+"</span>"),e[i?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),"focus"!==(n=this._get(t,"showOn"))&&"both"!==n||e.focus(this._showDatepicker),"button"!==n&&"both"!==n||(a=this._get(t,"buttonText"),n=this._get(t,"buttonImage"),t.trigger=w(this._get(t,"buttonImageOnly")?w("<img/>").addClass(this._triggerClass).attr({src:n,alt:a,title:a}):w("<button type='button'></button>").addClass(this._triggerClass).html(n?w("<img/>").attr({src:n,alt:a,title:a}):a)),e[i?"before":"after"](t.trigger),t.trigger.click(function(){return w.datepicker._datepickerShowing&&w.datepicker._lastInput===e[0]?w.datepicker._hideDatepicker():(w.datepicker._datepickerShowing&&w.datepicker._lastInput!==e[0]&&w.datepicker._hideDatepicker(),w.datepicker._showDatepicker(e[0])),!1}))},_autoSize:function(e){var t,n,a,i,r,o;this._get(e,"autoSize")&&!e.inline&&(r=new Date(2009,11,20),(o=this._get(e,"dateFormat")).match(/[DM]/)&&(t=function(e){for(i=a=n=0;e.length>i;i++)e[i].length>n&&(n=e[i].length,a=i);return a},r.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),e.input.attr("size",this._formatDate(e,r).length))},_inlineDatepicker:function(e,t){var n=w(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(t.dpDiv),w.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,n,a,i){var r,o=this._dialogInst;return o||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=w("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),w("body").append(this._dialogInput),(o=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},w.data(this._dialogInput[0],"datepicker",o)),l(o.settings,a||{}),t=t&&t.constructor===Date?this._formatDate(o,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null,this._pos||(r=document.documentElement.clientWidth,a=document.documentElement.clientHeight,t=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[r/2-100+t,a/2-150+i]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),o.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),w.blockUI&&w.blockUI(this.dpDiv),w.data(this._dialogInput[0],"datepicker",o),this},_destroyDatepicker:function(e){var t,n=w(e),a=w.data(e,"datepicker");n.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),w.removeData(e,"datepicker"),"input"===t?(a.append.remove(),a.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==t&&"span"!==t||n.removeClass(this.markerClassName).empty(),d===a&&(d=null))},_enableDatepicker:function(t){var e,n=w(t),a=w.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==e&&"span"!==e||((n=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=w.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,n=w(t),a=w.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==e&&"span"!==e||((n=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=w.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return w.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var a,i,r,o,s=this._getInst(e);return 2===arguments.length&&"string"==typeof t?"defaults"===t?w.extend({},w.datepicker._defaults):s?"all"===t?w.extend({},s.settings):this._get(s,t):null:(a=t||{},"string"==typeof t&&((a={})[t]=n),void(s&&(this._curInst===s&&this._hideDatepicker(),i=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(s,"min"),o=this._getMinMaxDate(s,"max"),l(s.settings,a),null!==r&&void 0!==a.dateFormat&&void 0===a.minDate&&(s.settings.minDate=this._formatDate(s,r)),null!==o&&void 0!==a.dateFormat&&void 0===a.maxDate&&(s.settings.maxDate=this._formatDate(s,o)),"disabled"in a&&(a.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(w(e),s),this._autoSize(s),this._setDate(s,i),this._updateAlternate(s),this._updateDatepicker(s))))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){e=this._getInst(e);e&&this._updateDatepicker(e)},_setDateDatepicker:function(e,t){e=this._getInst(e);e&&(this._setDate(e,t),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(e,t){e=this._getInst(e);return e&&!e.inline&&this._setDateFromField(e,t),e?this._getDate(e):null},_doKeyDown:function(e){var t,n,a=w.datepicker._getInst(e.target),i=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,w.datepicker._datepickerShowing)switch(e.keyCode){case 9:w.datepicker._hideDatepicker(),i=!1;break;case 13:return(n=w("td."+w.datepicker._dayOverClass+":not(."+w.datepicker._currentClass+")",a.dpDiv))[0]&&w.datepicker._selectDay(e.target,a.selectedMonth,a.selectedYear,n[0]),(t=w.datepicker._get(a,"onSelect"))?(n=w.datepicker._formatDate(a),t.apply(a.input?a.input[0]:null,[n,a])):w.datepicker._hideDatepicker(),!1;case 27:w.datepicker._hideDatepicker();break;case 33:w.datepicker._adjustDate(e.target,e.ctrlKey?-w.datepicker._get(a,"stepBigMonths"):-w.datepicker._get(a,"stepMonths"),"M");break;case 34:w.datepicker._adjustDate(e.target,e.ctrlKey?+w.datepicker._get(a,"stepBigMonths"):+w.datepicker._get(a,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&w.datepicker._clearDate(e.target),i=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&w.datepicker._gotoToday(e.target),i=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&w.datepicker._adjustDate(e.target,r?1:-1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&w.datepicker._adjustDate(e.target,e.ctrlKey?-w.datepicker._get(a,"stepBigMonths"):-w.datepicker._get(a,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&w.datepicker._adjustDate(e.target,-7,"D"),i=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&w.datepicker._adjustDate(e.target,r?-1:1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&w.datepicker._adjustDate(e.target,e.ctrlKey?+w.datepicker._get(a,"stepBigMonths"):+w.datepicker._get(a,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&w.datepicker._adjustDate(e.target,7,"D"),i=e.ctrlKey||e.metaKey;break;default:i=!1}else 36===e.keyCode&&e.ctrlKey?w.datepicker._showDatepicker(this):i=!1;i&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,n=w.datepicker._getInst(e.target);return w.datepicker._get(n,"constrainInput")?(t=w.datepicker._possibleChars(w.datepicker._get(n,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||n<" "||!t||-1<t.indexOf(n)):void 0},_doKeyUp:function(e){var t=w.datepicker._getInst(e.target);if(t.input.val()!==t.lastVal)try{w.datepicker.parseDate(w.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,w.datepicker._getFormatConfig(t))&&(w.datepicker._setDateFromField(t),w.datepicker._updateAlternate(t),w.datepicker._updateDatepicker(t))}catch(e){}return!0},_showDatepicker:function(e){var t,n,a,i;"input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=w("input",e.parentNode)[0]),w.datepicker._isDisabledDatepicker(e)||w.datepicker._lastInput===e||(i=w.datepicker._getInst(e),w.datepicker._curInst&&w.datepicker._curInst!==i&&(w.datepicker._curInst.dpDiv.stop(!0,!0),i&&w.datepicker._datepickerShowing&&w.datepicker._hideDatepicker(w.datepicker._curInst.input[0])),!1!==(n=(a=w.datepicker._get(i,"beforeShow"))?a.apply(e,[e,i]):{})&&(l(i.settings,n),i.lastVal=null,w.datepicker._lastInput=e,w.datepicker._setDateFromField(i),w.datepicker._inDialog&&(e.value=""),w.datepicker._pos||(w.datepicker._pos=w.datepicker._findPos(e),w.datepicker._pos[1]+=e.offsetHeight),t=!1,w(e).parents().each(function(){return!(t|="fixed"===w(this).css("position"))}),a={left:w.datepicker._pos[0],top:w.datepicker._pos[1]},w.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),w.datepicker._updateDatepicker(i),a=w.datepicker._checkOffset(i,a,t),i.dpDiv.css({position:w.datepicker._inDialog&&w.blockUI?"static":t?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(n=w.datepicker._get(i,"showAnim"),a=w.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(e){for(var t,n;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(e.css("zIndex"),10),!isNaN(n)&&0!==n))return n;e=e.parent()}return 0}(w(e))+1),w.datepicker._datepickerShowing=!0,w.effects&&w.effects.effect[n]?i.dpDiv.show(n,w.datepicker._get(i,"showOptions"),a):i.dpDiv[n||"show"](n?a:null),w.datepicker._shouldFocusInput(i)&&i.input.focus(),w.datepicker._curInst=i)))},_updateDatepicker:function(e){this.maxRows=4,(d=e).dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var t,n=this._getNumberOfMonths(e),a=n[1],i=e.dpDiv.find("."+this._dayOverClass+" a");0<i.length&&o.apply(i.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<a&&e.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",17*a+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===w.datepicker._curInst&&w.datepicker._datepickerShowing&&w.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,n){var a=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(n?0:w(document).scrollLeft()),l=document.documentElement.clientHeight+(n?0:w(document).scrollTop());return t.left-=this._get(e,"isRTL")?a-r:0,t.left-=n&&t.left===e.input.offset().left?w(document).scrollLeft():0,t.top-=n&&t.top===e.input.offset().top+o?w(document).scrollTop():0,t.left-=Math.min(t.left,t.left+a>s&&a<s?Math.abs(t.left+a-s):0),t.top-=Math.min(t.top,t.top+i>l&&i<l?Math.abs(i+o):0),t},_findPos:function(e){for(var t=this._getInst(e),n=this._get(t,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||w.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return[(t=w(e).offset()).left,t.top]},_hideDatepicker:function(e){var t,n,a=this._curInst;!a||e&&a!==w.data(e,"datepicker")||this._datepickerShowing&&(t=this._get(a,"showAnim"),n=this._get(a,"duration"),e=function(){w.datepicker._tidyDialog(a)},w.effects&&(w.effects.effect[t]||w.effects[t])?a.dpDiv.hide(t,w.datepicker._get(a,"showOptions"),n,e):a.dpDiv["slideDown"===t?"slideUp":"fadeIn"===t?"fadeOut":"hide"](t?n:null,e),t||e(),this._datepickerShowing=!1,(e=this._get(a,"onClose"))&&e.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),w.blockUI&&(w.unblockUI(),w("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){var t;w.datepicker._curInst&&(t=w(e.target),e=w.datepicker._getInst(t[0]),(t[0].id===w.datepicker._mainDivId||0!==t.parents("#"+w.datepicker._mainDivId).length||t.hasClass(w.datepicker.markerClassName)||t.closest("."+w.datepicker._triggerClass).length||!w.datepicker._datepickerShowing||w.datepicker._inDialog&&w.blockUI)&&(!t.hasClass(w.datepicker.markerClassName)||w.datepicker._curInst===e)||w.datepicker._hideDatepicker())},_adjustDate:function(e,t,n){var a=w(e),e=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(e,t+("M"===n?this._get(e,"showCurrentAtPos"):0),n),this._updateDatepicker(e))},_gotoToday:function(e){var t=w(e),n=this._getInst(t[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(e=new Date,n.selectedDay=e.getDate(),n.drawMonth=n.selectedMonth=e.getMonth(),n.drawYear=n.selectedYear=e.getFullYear()),this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var a=w(e),e=this._getInst(a[0]);e["selected"+("M"===n?"Month":"Year")]=e["draw"+("M"===n?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(a)},_selectDay:function(e,t,n,a){var i=w(e);w(a).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0])||((i=this._getInst(i[0])).selectedDay=i.currentDay=w("a",a).html(),i.selectedMonth=i.currentMonth=t,i.selectedYear=i.currentYear=n,this._selectDate(e,this._formatDate(i,i.currentDay,i.currentMonth,i.currentYear)))},_clearDate:function(e){e=w(e);this._selectDate(e,"")},_selectDate:function(e,t){var n=w(e),e=this._getInst(n[0]);t=null!=t?t:this._formatDate(e),e.input&&e.input.val(t),this._updateAlternate(e),(n=this._get(e,"onSelect"))?n.apply(e.input?e.input[0]:null,[t,e]):e.input&&e.input.trigger("change"),e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,n,a,i=this._get(e,"altField");i&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),a=this.formatDate(t,n,this._getFormatConfig(e)),w(i).each(function(){w(this).val(a)}))},noWeekends:function(e){e=e.getDay();return[0<e&&e<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());return t.setDate(t.getDate()+4-(t.getDay()||7)),e=t.getTime(),t.setMonth(0),t.setDate(1),Math.floor(Math.round((e-t)/864e5)/7)+1},parseDate:function(t,i,e){if(null==t||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?""+i:i+""))return null;function r(e){return(e=t.length>S+1&&t.charAt(S+1)===e)&&S++,e}function n(e){var t=r(e),t="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,t=RegExp("^\\d{"+("y"===e?t:1)+","+t+"}");if(!(t=i.substring(d).match(t)))throw"Missing number at position "+d;return d+=t[0].length,parseInt(t[0],10)}function a(e,t,n){var a=-1,t=w.map(r(e)?n:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(w.each(t,function(e,t){var n=t[1];return i.substr(d,n.length).toLowerCase()===n.toLowerCase()?(a=t[0],d+=n.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+d}function o(){if(i.charAt(d)!==t.charAt(S))throw"Unexpected literal at position "+d;d++}for(var s,l,c,d=0,u=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof u?u:(new Date).getFullYear()%100+parseInt(u,10),h=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,p=(e?e.dayNames:null)||this._defaults.dayNames,f=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,m=(e?e.monthNames:null)||this._defaults.monthNames,g=-1,v=-1,y=-1,C=-1,b=!1,S=0;t.length>S;S++)if(b)"'"!==t.charAt(S)||r("'")?o():b=!1;else switch(t.charAt(S)){case"d":y=n("d");break;case"D":a("D",h,p);break;case"o":C=n("o");break;case"m":v=n("m");break;case"M":v=a("M",f,m);break;case"y":g=n("y");break;case"@":g=(c=new Date(n("@"))).getFullYear(),v=c.getMonth()+1,y=c.getDate();break;case"!":g=(c=new Date((n("!")-this._ticksTo1970)/1e4)).getFullYear(),v=c.getMonth()+1,y=c.getDate();break;case"'":r("'")?o():b=!0;break;default:o()}if(i.length>d&&(l=i.substr(d),!/^\s+/.test(l)))throw"Extra/unparsed characters found in date: "+l;if(-1===g?g=(new Date).getFullYear():g<100&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(g<=u?0:-100)),-1<C)for(v=1,y=C;!(y<=(s=this._getDaysInMonth(g,v-1)));)v++,y-=s;if((c=this._daylightSavingAdjust(new Date(g,v-1,y))).getFullYear()!==g||c.getMonth()+1!==v||c.getDate()!==y)throw"Invalid date";return c},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,n){if(!e)return"";function i(e){return(e=t.length>o+1&&t.charAt(o+1)===e)&&o++,e}function a(e,t,n){var a=""+t;if(i(e))for(;n>a.length;)a="0"+a;return a}function r(e,t,n,a){return(i(e)?a:n)[t]}var o,s=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,l=(n?n.dayNames:null)||this._defaults.dayNames,c=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,d=(n?n.monthNames:null)||this._defaults.monthNames,u="",h=!1;if(e)for(o=0;t.length>o;o++)if(h)"'"!==t.charAt(o)||i("'")?u+=t.charAt(o):h=!1;else switch(t.charAt(o)){case"d":u+=a("d",e.getDate(),2);break;case"D":u+=r("D",e.getDay(),s,l);break;case"o":u+=a("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=a("m",e.getMonth()+1,2);break;case"M":u+=r("M",e.getMonth(),c,d);break;case"y":u+=i("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":i("'")?u+="'":h=!0;break;default:u+=t.charAt(o)}return u},_possibleChars:function(t){function e(e){return(e=t.length>i+1&&t.charAt(i+1)===e)&&i++,e}for(var n="",a=!1,i=0;t.length>i;i++)if(a)"'"!==t.charAt(i)||e("'")?n+=t.charAt(i):a=!1;else switch(t.charAt(i)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":e("'")?n+="'":a=!0;break;default:n+=t.charAt(i)}return n},_get:function(e,t){return(void 0!==e.settings[t]?e.settings:this._defaults)[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),a=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),r=i,o=this._getFormatConfig(e);try{r=this.parseDate(n,a,o)||i}catch(e){a=t?"":a}e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),e.currentDay=a?r.getDate():0,e.currentMonth=a?r.getMonth():0,e.currentYear=a?r.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(s,e,t){var n,a,e=null==e||""===e?t:"string"==typeof e?function(e){try{return w.datepicker.parseDate(w.datepicker._get(s,"dateFormat"),e,w.datepicker._getFormatConfig(s))}catch(e){}for(var t=(e.toLowerCase().match(/^c/)?w.datepicker._getDate(s):null)||new Date,n=t.getFullYear(),a=t.getMonth(),i=t.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,o=r.exec(e);o;){switch(o[2]||"d"){case"d":case"D":i+=parseInt(o[1],10);break;case"w":case"W":i+=7*parseInt(o[1],10);break;case"m":case"M":a+=parseInt(o[1],10),i=Math.min(i,w.datepicker._getDaysInMonth(n,a));break;case"y":case"Y":n+=parseInt(o[1],10),i=Math.min(i,w.datepicker._getDaysInMonth(n,a))}o=r.exec(e)}return new Date(n,a,i)}(e):"number"==typeof e?isNaN(e)?t:(n=e,(a=new Date).setDate(a.getDate()+n),a):new Date(e.getTime());return(e=e&&"Invalid Date"==""+e?t:e)&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),this._daylightSavingAdjust(e)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var a=!t,i=e.selectedMonth,r=e.selectedYear,t=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=t.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=t.getMonth(),e.drawYear=e.selectedYear=e.currentYear=t.getFullYear(),i===e.selectedMonth&&r===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(a?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){w.datepicker._adjustDate(n,-t,"M")},next:function(){w.datepicker._adjustDate(n,+t,"M")},hide:function(){w.datepicker._hideDatepicker()},today:function(){w.datepicker._gotoToday(n)},selectDay:function(){return w.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return w.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return w.datepicker._selectMonthYear(n,this,"Y"),!1}};w(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,a,i,r,o,s,l,c,d,u,h,p,f,m,g,v,y,C,b,S,w,k,M,x,D,A,T,_,j,I,$,F=new Date,R=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),P=this._get(e,"isRTL"),L=this._get(e,"showButtonPanel"),U=this._get(e,"hideIfNoPrevNext"),E=this._get(e,"navigationAsDateFormat"),N=this._getNumberOfMonths(e),O=this._get(e,"showCurrentAtPos"),F=this._get(e,"stepMonths"),B=1!==N[0]||1!==N[1],q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),H=this._getMinMaxDate(e,"min"),W=this._getMinMaxDate(e,"max"),J=e.drawMonth-O,V=e.drawYear;if(J<0&&(J+=12,V--),W)for(t=this._daylightSavingAdjust(new Date(W.getFullYear(),W.getMonth()-N[0]*N[1]+1,W.getDate())),t=H&&t<H?H:t;this._daylightSavingAdjust(new Date(V,J,1))>t;)--J<0&&(J=11,V--);for(e.drawMonth=J,e.drawYear=V,O=this._get(e,"prevText"),O=E?this.formatDate(O,this._daylightSavingAdjust(new Date(V,J-F,1)),this._getFormatConfig(e)):O,n=this._canAdjustMonth(e,-1,V,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+O+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+O+"</span></a>":U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+O+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+O+"</span></a>",O=this._get(e,"nextText"),O=E?this.formatDate(O,this._daylightSavingAdjust(new Date(V,J+F,1)),this._getFormatConfig(e)):O,a=this._canAdjustMonth(e,1,V,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+O+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+O+"</span></a>":U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+O+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+O+"</span></a>",U=this._get(e,"currentText"),O=this._get(e,"gotoCurrent")&&e.currentDay?q:R,U=E?this.formatDate(U,O,this._getFormatConfig(e)):U,E=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",E=L?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(P?E:"")+(this._isInRange(e,O)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+U+"</button>":"")+(P?"":E)+"</div>":"",i=parseInt(this._get(e,"firstDay"),10),i=isNaN(i)?0:i,r=this._get(e,"showWeek"),o=this._get(e,"dayNames"),s=this._get(e,"dayNamesMin"),l=this._get(e,"monthNames"),c=this._get(e,"monthNamesShort"),d=this._get(e,"beforeShowDay"),u=this._get(e,"showOtherMonths"),h=this._get(e,"selectOtherMonths"),p=this._getDefaultDate(e),f="",g=0;N[0]>g;g++){for(v="",this.maxRows=4,y=0;N[1]>y;y++){if(C=this._daylightSavingAdjust(new Date(V,J,e.selectedDay)),b=" ui-corner-all",S="",B){if(S+="<div class='ui-datepicker-group",1<N[1])switch(y){case 0:S+=" ui-datepicker-group-first",b=" ui-corner-"+(P?"right":"left");break;case N[1]-1:S+=" ui-datepicker-group-last",b=" ui-corner-"+(P?"left":"right");break;default:S+=" ui-datepicker-group-middle",b=""}S+="'>"}for(S+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+b+"'>"+(/all|left/.test(b)&&0===g?P?a:n:"")+(/all|right/.test(b)&&0===g?P?n:a:"")+this._generateMonthYearHeader(e,J,V,H,W,0<g||0<y,l,c)+"</div><table class='ui-datepicker-calendar'><thead><tr>",w=r?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",m=0;m<7;m++)w+="<th scope='col'"+(5<=(m+i+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+o[k=(m+i)%7]+"'>"+s[k]+"</span></th>";for(S+=w+"</tr></thead><tbody>",x=this._getDaysInMonth(V,J),V===e.selectedYear&&J===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,x)),M=(this._getFirstDayOfMonth(V,J)-i+7)%7,x=Math.ceil((M+x)/7),D=B&&this.maxRows>x?this.maxRows:x,this.maxRows=D,A=this._daylightSavingAdjust(new Date(V,J,1-M)),T=0;T<D;T++){for(S+="<tr>",_=r?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(A)+"</td>":"",m=0;m<7;m++)j=d?d.apply(e.input?e.input[0]:null,[A]):[!0,""],$=(I=A.getMonth()!==J)&&!h||!j[0]||H&&A<H||W&&W<A,_+="<td class='"+(5<=(m+i+6)%7?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(A.getTime()===C.getTime()&&J===e.selectedMonth&&e._keyEvent||p.getTime()===A.getTime()&&p.getTime()===C.getTime()?" "+this._dayOverClass:"")+($?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!u?"":" "+j[1]+(A.getTime()===q.getTime()?" "+this._currentClass:"")+(A.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(I&&!u||!j[2]?"":" title='"+j[2].replace(/'/g,"&#39;")+"'")+($?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(I&&!u?"&#xa0;":$?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===R.getTime()?" ui-state-highlight":"")+(A.getTime()===q.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);S+=_+"</tr>"}11<++J&&(J=0,V++),v+=S+="</tbody></table>"+(B?"</div>"+(0<N[0]&&y===N[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}f+=v}return f+=E,e._keyEvent=!1,f},_generateMonthYearHeader:function(e,t,n,a,i,r,o,s){var l,c,d,u,h,p,f,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),v=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",C="";if(r||!m)C+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(l=a&&a.getFullYear()===n,c=i&&i.getFullYear()===n,C+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;d<12;d++)(!l||d>=a.getMonth())&&(!c||i.getMonth()>=d)&&(C+="<option value='"+d+"'"+(d===t?" selected='selected'":"")+">"+s[d]+"</option>");C+="</select>"}if(v||(y+=C+(!r&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!g)y+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(u=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=(o=function(e){e=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(e)?h:e})(u[0]),f=Math.max(p,o(u[1]||"")),p=a?Math.max(p,a.getFullYear()):p,f=i?Math.min(f,i.getFullYear()):f,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p<=f;p++)e.yearshtml+="<option value='"+p+"'"+(p===n?" selected='selected'":"")+">"+p+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),v&&(y+=(!r&&m&&g?"":"&#xa0;")+C),y+"</div>"},_adjustInstDate:function(e,t,n){var a=e.drawYear+("Y"===n?t:0),i=e.drawMonth+("M"===n?t:0),t=Math.min(e.selectedDay,this._getDaysInMonth(a,i))+("D"===n?t:0),t=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(a,i,t)));e.selectedDay=t.getDate(),e.drawMonth=e.selectedMonth=t.getMonth(),e.drawYear=e.selectedYear=t.getFullYear(),"M"!==n&&"Y"!==n||this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),e=this._getMinMaxDate(e,"max"),t=n&&t<n?n:t;return e&&e<t?e:t},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){e=this._get(e,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,a){var i=this._getNumberOfMonths(e),i=this._daylightSavingAdjust(new Date(n,a+(t<0?t:i[0]*i[1]),1));return t<0&&i.setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())),this._isInRange(e,i)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),i=null,r=null,o=this._get(e,"yearRange");return o&&(e=o.split(":"),o=(new Date).getFullYear(),i=parseInt(e[0],10),r=parseInt(e[1],10),e[0].match(/[+\-].*/)&&(i+=o),e[1].match(/[+\-].*/)&&(r+=o)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!i||t.getFullYear()>=i)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,a){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);t=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(a,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),t,this._getFormatConfig(e))}}),w.fn.datepicker=function(e){if(!this.length)return this;w.datepicker.initialized||(w(document).mousedown(w.datepicker._checkExternalClick),w.datepicker.initialized=!0),0===w("#"+w.datepicker._mainDivId).length&&w("body").append(w.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&("isDisabled"===e||"getDate"===e||"widget"===e)||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?w.datepicker["_"+e+"Datepicker"].apply(w.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?w.datepicker["_"+e+"Datepicker"].apply(w.datepicker,[this].concat(t)):w.datepicker._attachDatepicker(this,e)})},w.datepicker=new e,w.datepicker.initialized=!1,w.datepicker.uuid=(new Date).getTime(),w.datepicker.version="1.11.4",w.datepicker}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(ye){ye.fn.jScrollPane=function(n){function a(C,e){function b(e){var t,n,a,i,r,o,s,l,c,d,u,h,p,f,m,g=!1,v=!1;if(U=e,void 0===E)a=C.scrollTop(),i=C.scrollLeft(),C.css({overflow:"hidden",padding:0}),N=C.innerWidth()+ve,O=C.innerHeight(),C.width(N),E=ye('<div class="jspPane" />').css("padding",pe).append(C.children()),B=ye('<div class="jspContainer" />').css({width:N+"px",height:O+"px"}).append(E).appendTo(C);else{if(C.css("width",""),g=U.stickToBottom&&(20<(o=H-O)&&o-P()<10),v=U.stickToRight&&(20<(r=q-N)&&r-R()<10),(o=C.innerWidth()+ve!=N||C.outerHeight()!=O)&&(N=C.innerWidth()+ve,O=C.innerHeight(),B.css({width:N+"px",height:O+"px"})),!o&&fe==q&&E.outerHeight()==H)return C.width(N),0;fe=q,E.css("width",""),C.width(N),B.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}function y(){var e=Z,t=K;switch(s){case 40:me.scrollByY(U.keyboardSpeed,!1);break;case 38:me.scrollByY(-U.keyboardSpeed,!1);break;case 34:case 32:me.scrollByY(O*U.scrollPagePercent,!1);break;case 33:me.scrollByY(-O*U.scrollPagePercent,!1);break;case 39:me.scrollByX(U.keyboardSpeed,!1);break;case 37:me.scrollByX(-U.keyboardSpeed,!1)}return l=e!=Z||t!=K}E.css("overflow","auto"),q=e.contentWidth||E[0].scrollWidth,H=E[0].scrollHeight,E.css("overflow",""),V=1<(J=H/O),(z=1<(W=q/N))||V?(C.addClass("jspScrollable"),(r=U.maintainPosition&&(K||Z))&&(t=R(),n=P()),V&&(B.append(ye('<div class="jspVerticalBar" />').append(ye('<div class="jspCap jspCapTop" />'),ye('<div class="jspTrack" />').append(ye('<div class="jspDrag" />').append(ye('<div class="jspDragTop" />'),ye('<div class="jspDragBottom" />'))),ye('<div class="jspCap jspCapBottom" />'))),ee=B.find(">.jspVerticalBar"),te=ee.find(">.jspTrack"),Y=te.find(">.jspDrag"),U.showArrows&&(ie=ye('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",M(0,-1)).bind("click.jsp",L),re=ye('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",M(0,1)).bind("click.jsp",L),U.arrowScrollOnHover&&(ie.bind("mouseover.jsp",M(0,-1,ie)),re.bind("mouseover.jsp",M(0,1,re))),k(te,U.verticalArrowPositions,ie,re)),ne=O,B.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ne-=ye(this).outerHeight()}),Y.hover(function(){Y.addClass("jspHover")},function(){Y.removeClass("jspHover")}).bind("mousedown.jsp",function(e){ye("html").bind("dragstart.jsp selectstart.jsp",L),Y.addClass("jspActive");var t=e.pageY-Y.position().top;return ye("html").bind("mousemove.jsp",function(e){A(e.pageY-t,!1)}).bind("mouseup.jsp mouseleave.jsp",D),!1}),S()),z&&(B.append(ye('<div class="jspHorizontalBar" />').append(ye('<div class="jspCap jspCapLeft" />'),ye('<div class="jspTrack" />').append(ye('<div class="jspDrag" />').append(ye('<div class="jspDragLeft" />'),ye('<div class="jspDragRight" />'))),ye('<div class="jspCap jspCapRight" />'))),oe=B.find(">.jspHorizontalBar"),se=oe.find(">.jspTrack"),G=se.find(">.jspDrag"),U.showArrows&&(de=ye('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",M(-1,0)).bind("click.jsp",L),ue=ye('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",M(1,0)).bind("click.jsp",L),U.arrowScrollOnHover&&(de.bind("mouseover.jsp",M(-1,0,de)),ue.bind("mouseover.jsp",M(1,0,ue))),k(se,U.horizontalArrowPositions,de,ue)),G.hover(function(){G.addClass("jspHover")},function(){G.removeClass("jspHover")}).bind("mousedown.jsp",function(e){ye("html").bind("dragstart.jsp selectstart.jsp",L),G.addClass("jspActive");var t=e.pageX-G.position().left;return ye("html").bind("mousemove.jsp",function(e){_(e.pageX-t,!1)}).bind("mouseup.jsp mouseleave.jsp",D),!1}),le=B.innerWidth(),w()),z&&V&&(o=se.outerHeight(),e=te.outerWidth(),ne-=o,ye(oe).find(">.jspCap:visible,>.jspArrow").each(function(){le+=ye(this).outerWidth()}),le-=e,O-=e,N-=o,se.parent().append(ye('<div class="jspCorner" />').css("width",o+"px")),S(),w()),z&&E.width(B.outerWidth()-ve+"px"),H=E.outerHeight(),J=H/O,z&&((ce=Math.ceil(1/W*le))>U.horizontalDragMaxWidth?ce=U.horizontalDragMaxWidth:ce<U.horizontalDragMinWidth&&(ce=U.horizontalDragMinWidth),G.width(ce+"px"),X=le-ce,j(Z)),V&&((ae=Math.ceil(1/J*ne))>U.verticalDragMaxHeight?ae=U.verticalDragMaxHeight:ae<U.verticalDragMinHeight&&(ae=U.verticalDragMinHeight),Y.height(ae+"px"),Q=ne-ae,T(K)),r&&($(v?q-N:t,!1),I(g?H-O:n,!1)),E.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){F(e.target,!1)}),B.unbind(ge).bind(ge,function(e,t,n,a){var i=Z=Z||0,r=K=K||0,e=e.deltaFactor||U.mouseWheelSpeed;return me.scrollBy(n*e,-a*e,!1),i==Z&&r==K}),m=!1,B.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(e){e=e.originalEvent.touches[0];d=R(),u=P(),h=e.pageX,p=e.pageY,m=!(f=!1)}).bind("touchmove.jsp",function(e){if(m){var t=e.originalEvent.touches[0],n=Z,e=K;return me.scrollTo(d+h-t.pageX,u+p-t.pageY),f=f||5<Math.abs(h-t.pageX)||5<Math.abs(p-t.pageY),n==Z&&e==K}}).bind("touchend.jsp",function(){m=!1}).bind("click.jsp-touchclick",function(){return f?f=!1:void 0}),U.enableKeyboardNavigation&&(c=[],z&&c.push(oe[0]),V&&c.push(ee[0]),E.bind("focus.jsp",function(){C.focus()}),C.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||c.length&&ye(e.target).closest(c).length){var t=Z,n=K;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=e.keyCode,y();break;case 35:I(H-O),s=null;break;case 36:I(0),s=null}return!(l=e.keyCode==s&&t!=Z||n!=K)}}).bind("keypress.jsp",function(e){return e.keyCode==s&&y(),e.target===this||c.length&&ye(e.target).closest(c).length?!l:void 0}),U.hideFocus?(C.css("outline","none"),"hideFocus"in B[0]&&C.attr("hideFocus",!0)):(C.css("outline",""),"hideFocus"in B[0]&&C.attr("hideFocus",!1))),U.clickOnTrack&&(x(),V&&te.bind("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget==a.currentTarget){var i,r=ye(this),e=r.offset(),o=a.pageY-e.top-K,s=!0,l=function(){var e=r.offset(),t=a.pageY-e.top-ae/2,n=O*U.scrollPagePercent,e=Q*n/(H-O);if(o<0)t<K-e?me.scrollByY(-n):A(t);else{if(!(0<o))return void c();K+e<t?me.scrollByY(n):A(t)}i=setTimeout(l,s?U.initialDelay:U.trackClickRepeatFreq),s=!1},c=function(){i&&clearTimeout(i),i=null,ye(document).unbind("mouseup.jsp",c)};return l(),ye(document).bind("mouseup.jsp",c),!1}}),z&&se.bind("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget==a.currentTarget){var i,r=ye(this),e=r.offset(),o=a.pageX-e.left-Z,s=!0,l=function(){var e=r.offset(),t=a.pageX-e.left-ce/2,n=N*U.scrollPagePercent,e=X*n/(q-N);if(o<0)t<Z-e?me.scrollByX(-n):_(t);else{if(!(0<o))return void c();Z+e<t?me.scrollByX(n):_(t)}i=setTimeout(l,s?U.initialDelay:U.trackClickRepeatFreq),s=!1},c=function(){i&&clearTimeout(i),i=null,ye(document).unbind("mouseup.jsp",c)};return l(),ye(document).bind("mouseup.jsp",c),!1}})),function(){if(location.hash&&1<location.hash.length){var e,t,n=escape(location.hash.substr(1));try{e=ye("#"+n+', a[name="'+n+'"]')}catch(e){return}e.length&&E.find(n)&&(0===B.scrollTop()?t=setInterval(function(){0<B.scrollTop()&&(F(e,!0),ye(document).scrollTop(B.position().top),clearInterval(t))},50):(F(e,!0),ye(document).scrollTop(B.position().top)))}}(),U.hijackInternalLinks&&(ye(document.body).data("jspHijack")||(ye(document.body).data("jspHijack",!0),ye(document.body).delegate('a[href*="#"]',"click",function(e){var t,n,a,i=this.href.substr(0,this.href.indexOf("#")),r=location.href;if(-1!==location.href.indexOf("#")&&(r=location.href.substr(0,location.href.indexOf("#"))),i===r){t=escape(this.href.substr(this.href.indexOf("#")+1));try{n=ye("#"+t+', a[name="'+t+'"]')}catch(e){return}n.length&&((a=n.closest(".jspScrollable")).data("jsp").scrollToElement(n,!0),a[0].scrollIntoView&&(i=ye(window).scrollTop(),((r=n.offset().top)<i||r>i+ye(window).height())&&a[0].scrollIntoView()),e.preventDefault())}})))):(C.removeClass("jspScrollable"),E.css({top:0,left:0,width:B.width()-ve}),B.unbind(ge),E.find(":input,a").unbind("focus.jsp"),C.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),E.unbind(".jsp"),x()),U.autoReinitialise&&!he?he=setInterval(function(){b(U)},U.autoReinitialiseDelay):!U.autoReinitialise&&he&&clearInterval(he),a&&C.scrollTop(0)&&I(a,!1),i&&C.scrollLeft(0)&&$(i,!1),C.trigger("jsp-initialised",[z||V])}function S(){te.height(ne+"px"),K=0,t=U.verticalGutter+te.outerWidth(),E.width(N-t-ve);try{0===ee.position().left&&E.css("margin-left",t+"px")}catch(e){}}function w(){B.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){le-=ye(this).outerWidth()}),se.width(le+"px"),Z=0}function k(e,t,n,a){var i="before",r="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==i?r=t:t==r&&(i=t,t=n,n=a,a=t),e[i](n)[r](a)}function M(e,t,n){return function(){return function(e,t,n,a){n=ye(n).addClass("jspActive");var i,r,o=!0,s=function(){0!==e&&me.scrollByX(e*U.arrowButtonSpeed),0!==t&&me.scrollByY(t*U.arrowButtonSpeed),r=setTimeout(s,o?U.initialDelay:U.arrowRepeatFreq),o=!1};s(),i=a?"mouseout.jsp":"mouseup.jsp",(a=a||ye("html")).bind(i,function(){n.removeClass("jspActive"),r&&clearTimeout(r),r=null,a.unbind(i)})}(e,t,this,n),this.blur(),!1}}function x(){se&&se.unbind("mousedown.jsp"),te&&te.unbind("mousedown.jsp")}function D(){ye("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Y&&Y.removeClass("jspActive"),G&&G.removeClass("jspActive")}function A(e,t){var n,a,i,r;V&&(e<0?e=0:Q<e&&(e=Q),n=new ye.Event("jsp-will-scroll-y"),C.trigger(n,[e]),n.isDefaultPrevented()||(a=0===(n=e||0),i=n==Q,r=-(e/Q)*(H-O),void 0===t&&(t=U.animateScroll),t?me.animate(Y,"top",e,T,function(){C.trigger("jsp-user-scroll-y",[-r,a,i])}):(Y.css("top",e),T(e),C.trigger("jsp-user-scroll-y",[-r,a,i]))))}function T(e){void 0===e&&(e=Y.position().top),B.scrollTop(0);var t,n=0===(K=e||0),a=K==Q,i=-(e/Q)*(H-O);r==n&&s==a||(r=n,s=a,C.trigger("jsp-arrow-change",[r,s,o,l])),t=n,e=a,U.showArrows&&(ie[t?"addClass":"removeClass"]("jspDisabled"),re[e?"addClass":"removeClass"]("jspDisabled")),E.css("top",i),C.trigger("jsp-scroll-y",[-i,n,a]).trigger("scroll")}function _(e,t){var n,a,i,r;z&&(e<0?e=0:X<e&&(e=X),n=new ye.Event("jsp-will-scroll-x"),C.trigger(n,[e]),n.isDefaultPrevented()||(a=0===(n=e||0),i=n==X,r=-(e/X)*(q-N),void 0===t&&(t=U.animateScroll),t?me.animate(G,"left",e,j,function(){C.trigger("jsp-user-scroll-x",[-r,a,i])}):(G.css("left",e),j(e),C.trigger("jsp-user-scroll-x",[-r,a,i]))))}function j(e){void 0===e&&(e=G.position().left),B.scrollTop(0);var t,n=0===(Z=e||0),a=Z==X,i=-(e/X)*(q-N);o==n&&l==a||(o=n,l=a,C.trigger("jsp-arrow-change",[r,s,o,l])),t=n,e=a,U.showArrows&&(de[t?"addClass":"removeClass"]("jspDisabled"),ue[e?"addClass":"removeClass"]("jspDisabled")),E.css("left",i),C.trigger("jsp-scroll-x",[-i,n,a]).trigger("scroll")}function I(e,t){A(e/(H-O)*Q,t)}function $(e,t){_(e/(q-N)*X,t)}function F(e,t,n){var a,i,r,o,s,l,c,d=0,u=0;try{a=ye(e)}catch(e){return}for(o=a.outerHeight(),i=a.outerWidth(),B.scrollTop(0),B.scrollLeft(0);!a.is(".jspPane");)if(d+=a.position().top,u+=a.position().left,a=a.offsetParent(),/^body|html$/i.test(a[0].nodeName))return;s=(r=P())+O,d<r||t?l=d-U.horizontalGutter:s<d+o&&(l=d-O+o+U.horizontalGutter),isNaN(l)||I(l,n),l=(o=R())+N,u<o||t?c=u-U.horizontalGutter:l<u+i&&(c=u-N+i+U.horizontalGutter),isNaN(c)||$(c,n)}function R(){return-E.position().left}function P(){return-E.position().top}function L(){return!1}var U,E,N,O,B,q,H,W,J,V,z,Y,Q,K,G,X,Z,ee,te,t,ne,ae,ie,re,oe,se,le,ce,de,ue,he,pe,fe,me=this,r=!0,o=!0,s=!1,l=!1,n=C.clone(!1,!1).empty(),ge=ye.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp",ve="border-box"===C.css("box-sizing")?pe=0:(pe=C.css("paddingTop")+" "+C.css("paddingRight")+" "+C.css("paddingBottom")+" "+C.css("paddingLeft"),(parseInt(C.css("paddingLeft"),10)||0)+(parseInt(C.css("paddingRight"),10)||0));ye.extend(me,{reinitialise:function(e){b(e=ye.extend({},U,e))},scrollToElement:function(e,t,n){F(e,t,n)},scrollTo:function(e,t,n){$(e,n),I(t,n)},scrollToX:function(e,t){$(e,t)},scrollToY:function(e,t){I(e,t)},scrollToPercentX:function(e,t){$(e*(q-N),t)},scrollToPercentY:function(e,t){I(e*(H-O),t)},scrollBy:function(e,t,n){me.scrollByX(e,n),me.scrollByY(t,n)},scrollByX:function(e,t){_((R()+Math[e<0?"floor":"ceil"](e))/(q-N)*X,t)},scrollByY:function(e,t){A((P()+Math[e<0?"floor":"ceil"](e))/(H-O)*Q,t)},positionDragX:function(e,t){_(e,t)},positionDragY:function(e,t){A(e,t)},animate:function(e,t,n,a,i){var r={};r[t]=n,e.animate(r,{duration:U.animateDuration,easing:U.animateEase,queue:!1,step:a,complete:i})},getContentPositionX:R,getContentPositionY:P,getContentWidth:function(){return q},getContentHeight:function(){return H},getPercentScrolledX:function(){return R()/(q-N)},getPercentScrolledY:function(){return P()/(H-O)},getIsScrollableH:function(){return z},getIsScrollableV:function(){return V},getContentPane:function(){return E},scrollToBottom:function(e){A(Q,e)},hijackInternalLinks:ye.noop,destroy:function(){var e,t;e=P(),t=R(),C.removeClass("jspScrollable").unbind(".jsp"),E.unbind(".jsp"),C.replaceWith(n.append(E.children())),n.scrollTop(e),n.scrollLeft(t),he&&clearInterval(he)}}),b(e)}return n=ye.extend({},ye.fn.jScrollPane.defaults,n),ye.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){n[this]=n[this]||n.speed}),this.each(function(){var e=ye(this),t=e.data("jsp");t?t.reinitialise(n):(ye("script",e).filter('[type="text/javascript"],:not([type])').remove(),t=new a(e,n),e.data("jsp",t))})},ye.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(d){var u,h,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],p=Array.prototype.slice;if(d.event.fixHooks)for(var n=e.length;n;)d.event.fixHooks[e[--n]]=d.event.mouseHooks;var f=d.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],a,!1);else this.onmousewheel=a;d.data(this,"mousewheel-line-height",f.getLineHeight(this)),d.data(this,"mousewheel-page-height",f.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],a,!1);else this.onmousewheel=null;d.removeData(this,"mousewheel-line-height"),d.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var t=d(e),e=t["offsetParent"in d.fn?"offsetParent":"parent"]();return e.length||(e=d("body")),parseInt(e.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(e){return d(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function a(e){var t,n=e||window.event,a=p.call(arguments,1),i=0,r=0,o=0,s=0,l=0,c=0;if(e=d.event.fix(n),e.type="mousewheel","detail"in n&&(o=-1*n.detail),"wheelDelta"in n&&(o=n.wheelDelta),"wheelDeltaY"in n&&(o=n.wheelDeltaY),"wheelDeltaX"in n&&(r=-1*n.wheelDeltaX),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(r=-1*o,o=0),i=0===o?r:o,"deltaY"in n&&(i=o=-1*n.deltaY),"deltaX"in n&&(r=n.deltaX,0===o&&(i=-1*r)),0!==o||0!==r)return 1===n.deltaMode?(i*=t=d.data(this,"mousewheel-line-height"),o*=t,r*=t):2===n.deltaMode&&(i*=t=d.data(this,"mousewheel-page-height"),o*=t,r*=t),s=Math.max(Math.abs(o),Math.abs(r)),(!h||s<h)&&g(n,h=s)&&(h/=40),g(n,s)&&(i/=40,r/=40,o/=40),i=Math[1<=i?"floor":"ceil"](i/h),r=Math[1<=r?"floor":"ceil"](r/h),o=Math[1<=o?"floor":"ceil"](o/h),f.settings.normalizeOffset&&this.getBoundingClientRect&&(s=this.getBoundingClientRect(),l=e.clientX-s.left,c=e.clientY-s.top),e.deltaX=r,e.deltaY=o,e.deltaFactor=h,e.offsetX=l,e.offsetY=c,e.deltaMode=0,a.unshift(e,i,r,o),u&&clearTimeout(u),u=setTimeout(m,200),(d.event.dispatch||d.event.handle).apply(this,a)}function m(){h=null}function g(e,t){return f.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}d.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});var SCM=SCM||{};SCM.RelatedObjectLinks=function(i){return{init:function(){i('.js-related-object[object-type="chapter"]').on("click",e)}};function e(){var t="/customerror?statuscode=404",e=i(this),n=e.attr("isbn"),a=i("#BookId").val(),e=e.attr("legacySectionId");i("div[name='"+e+"']").length?window.location.hash=e:(n=null==n?"":n.trim(),e=null==e?"":e.trim(),""!==n?i.ajax({url:"/PlatformBook/GoToRelatedObjectLink",cache:!0,dataType:"json",data:{isbn:n.toLowerCase(),legacySectionId:e.toLowerCase(),currentBookId:a}}).done(function(e){e&&e.Success?window.top.location.assign(e.RedirectURL):window.top.location.assign(t)}).fail(function(){window.top.location.assign(t)}):window.top.location.assign(t))}}(jQuery),jQuery(function(){SCM.RelatedObjectLinks.init()});var debounce=function(a,i,r){var o;return function(){var e=this,t=arguments,n=r&&!o;clearTimeout(o),o=setTimeout(function(){o=null,r||a.apply(e,t)},i),n&&a.apply(e,t)}};function updateViewportDimensions(){var e=window,t=document,n=t.documentElement,t=t.getElementsByTagName("body")[0];return{width:e.innerWidth||n.clientWidth||t.clientWidth,height:e.innerHeight||n.clientHeight||t.clientHeight}}var viewport=updateViewportDimensions(),SCM=SCM||{};SCM.JSUtility=function(d){return{equalHeights:function(n,a){function e(){var t,e;d(n).length&&d(window).width()>a?(t=0,(e=d(n)).attr("style",""),e.each(function(){var e=d(this).outerHeight();t<e&&(t=e)}),d(n).css("height",t)):d(n).attr("style","")}e(),d(window).resize(function(){e()})},addStateToggle:function(e,t,n){var a=d(e),i=d(t),r="active-state",o="target-active",s=d("body"),l=t.replace(/.|#/,"")+"-active",t=i.find(".close");function c(){i.removeClass(r),a.removeClass(o),n&&s.removeClass(l)}n=n||!1,a.click(function(e){e.preventDefault(),i.toggleClass(r),a.toggleClass(o),n&&s.toggleClass(l)}),s.click(function(e){d(e.target).closest(a.add(i)).length||c()}),t.click(function(){c()})},toggleVisibility:function(e,t,n){var a=d(e),i="target-active";t=t||!1,n=n||640;function r(){var e=d(this),t=d("."+e.attr("data-toggle-target"));e.toggleClass(i),t.slideToggle().toggleClass("active")}var o=debounce(function(){t?(viewport=updateViewportDimensions()).width>n?(a.off("click.toggle-visibility"),a.removeClass(i),a.each(function(){d("."+d(this).attr("data-toggle-target")).removeAttr("style").removeClass("active")})):(a.off("click.toggle-visibility"),a.on("click.toggle-visibility",r)):a.on("click.toggle-visibility",r)},150,!0);o(),t&&d(window).resize(function(){o()})},getParameterByName:function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}}}(jQuery);var SCM=SCM||{};SCM.Logging=function(){var e={debug:function(e){n()&&console.log(e)},warn:function(e){console.warn(e)},error:function(e){console.error(e)}},t=null;return{init:function(){},getLogger:function(){return e},isJsDebugEnabled:n};function n(){var e;return null!==t?t:t=(e=SCM.JSUtility.getParameterByName("JsDebug",window.location.href))&&"true"===e}}();var SCM=SCM||{};SCM.JqueryMigrateLogger=function(){var t,n,a=5e3,e=20,i=0;return{init:function(){if(n=SCM.Logging.getLogger(),!((t=$("[data-jquery-migrate-logging-enabled]"))&&t.length&&jQuery.migrateWarnings))return void n.debug("jquery-migrate logging is disabled");n.debug("jquery-migrate logging is enabled.  Attempting to initialize Application Insights.");var e=function(){if(!t&&!t.length)return"";var e=t.data("jqueryMigrateInstrumentationKey");return e?e.trim():""}();if(!e)return;if(function(e){var t="appInsightsSDK";window[t]="appInsights";t=window[t],e=window[t]||function(t){function e(t){o[t]=function(){var e=arguments;o.queue.push(function(){o[t].apply(o,e)})}}var o={config:t,initialize:!0},n=document,a=window;setTimeout(function(){var e=n.createElement("script");e.src=t.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",n.getElementsByTagName("script")[0].parentNode.appendChild(e)});try{o.cookie=n.cookie}catch(t){}o.queue=[],o.version=2;for(var s=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];s.length;)e("track"+s.pop());e("startTrackPage"),e("stopTrackPage");var l,i="Track"+s[0];return e("start"+i),e("stop"+i),e("setAuthenticatedUserContext"),e("clearAuthenticatedUserContext"),e("flush"),!0===t.disableExceptionTracking||t.extensionConfig&&t.extensionConfig.ApplicationInsightsAnalytics&&!0===t.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking||(e("_"+(s="onerror")),l=a[s],a[s]=function(e,t,n,a,i){var r=l&&l(e,t,n,a,i);return!0!==r&&o["_"+s]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},t.autoExceptionInstrumented=!0),o}({instrumentationKey:e,disableAjaxTracking:!0});window[t]=e}(e),!window.appInsights)return void n.warn("Application Insights failed to initialize.");setTimeout(r,a)}};function r(){jQuery.migrateWarnings&&jQuery.migrateWarnings.length&&(n.debug("Logging "+jQuery.migrateWarnings.length+" jquery-migrate warnings."),jQuery.migrateWarnings.forEach(function(e){n.debug(e),appInsights.trackEvent({name:"jquery-migrate-warning",properties:{host:window.location.hostname,url:window.location.href,warning:e}})}),jQuery.migrateReset()),++i<e&&setTimeout(r,a)}}();var SCM=SCM||{};SCM.Common={getQueryStringValue:function(e,t){var n=t+"=",t=e.indexOf(n);{if(-1===t)return null;t+=n.length}t=0<=e.indexOf("&",t)?(n=e.indexOf("&",t),e.substring(t,n)):e.substring(t);return t},isDefined:function(e){return void 0!==e&&void 0!==e&&null!=e}};var SCM=SCM||{};SCM.UploadImage_Complete=function(e){var t,n=$.extend({targetSelector:"#UploadTarget",jsonResultSelector:"#jsonResult",replacementContainerSelector:"#id"},e),e=$(n.targetSelector).contents().find(n.jsonResultSelector);1===e.length&&(e=$.parseJSON(e.html()),$("[data-valmsg-for]").attr("class","field-validation-valid").html(""),e.Success?n.success&&n.success():0<e.Messages.length?(t="Error \n",e.Messages.forEach(function(e){t+=e+"\n"}),alert(t)):e.Html?$(n.replacementContainerSelector).replaceWith(e.Html.replace(/{{/g,"&quot;")):e.ValidationErrors.forEach(function(e){var t=$("[data-valmsg-for="+e.Key+"]");t.addClass("field-validation-error").removeClass("field-validation-valid"),e.Errors.forEach(function(e){t.html(t.html()+e+"<br />")})}))},SCM.AjaxHelperSuccessCallback=function(e,t,n){e.RedirectUrl&&0<e.RedirectUrl.length?window.location=e.RedirectUrl:e.Html&&0<e.Html.length?t.replaceWith(e.Html):e.Success?n():t.replaceWith(e)},SCM.AjaxHelperErrorCallback=function(e,t,n){e.RedirectUrl&&0<e.RedirectUrl.length?window.location=e.RedirectUrl:e.Html&&0<e.Html.length?t.replaceWith(e.Html):e.Success?n():t.replaceWith(e)},SCM.showModal=function(){var t=[];"undefined"!=typeof tinyMCE&&tinyMCE.editors.forEach(function(e){$("#divDefaultUpdateTarget").find("#"+e.editorContainer).each(function(){t.push(e.id)})}),$.fancybox({autosize:!0,autoScale:!1,title:"",href:"#divDefaultUpdateTarget"}),"undefined"!=typeof tinyMCE&&t.forEach(function(e){$("#"+e).scmTinyMCE()})},SCM.hideModal=function(){$.fancybox.close()},SCM.refreshModal=function(){$.fancybox.update()},function(){var r=$("body");function o(e,t){return 0===e.indexOf("*.")&&(e=e.replace("*.",t)),e}$(document).ajaxError(function(e,t,n){if(r.removeClass("wait"),t.responseText)try{var a,i=$.parseJSON(t.responseText);null==i.Success||i.Success||(a="There was an error processing the request \n",i.Messages.forEach(function(e){a+=e+"\n"}),alert(a))}catch(e){console.log("Ajax error occured, responseText is not json: "+e.message)}}),$.validator.addMethod("isDateGreaterThan",function(e,t,n){return 1!=function(e,t){t=new Date(t),e=new Date(e);{if(t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate())return!1;if(e<t)return!0}return!1}($(t).val(),n)},""),$(document).ajaxStart(function(){r.addClass("wait")}).ajaxStop(function(){r.removeClass("wait")}),r.on("keypress","[data-default-button]",function(e){if(13==e.which)return $("#"+$(this).data("defaultButton")).click(),!1}),$.validator.unobtrusive.adapters.add("dynamicrange",["minvalueproperty","maxvalueproperty"],function(e){e.rules.dynamicrange=e.params,null!=e.message&&($.validator.messages.dynamicrange=e.message)}),$.validator.addMethod("dynamicrange",function(e,t,n){var a=(i=t.name).substr(0,i.lastIndexOf(".")+1),i=parseInt($('input[name="'+o(n.minvalueproperty,a)+'"]').val(),10),a=parseInt($('input[name="'+o(n.maxvalueproperty,a)+'"]').val(),10),e=parseInt(e,10);return!(isNaN(i)||isNaN(a)||isNaN(e)||e<i||a<e)||($.validator.messages.dynamicrange=$.format($(t).attr("data-val-dynamicrange"),i,a),!1)},"")}(),function(o){o.fn.radiobuttonEnable=function(){return this.each(function(){var a=o(this);a.find("*[data-rb-enable-name]").each(function(){var e,t=o(this),n=a.find('input:radio[name="'+t.data("rbEnableName")+'"]:checked');0<n.length&&(null!=(e=t.data("rbEnableValue"))&&n.val().toString().toLowerCase()!=e.toString().toLowerCase()&&t.prop("disabled",!0),null!=(e=t.data("rbMakeVisibleValue"))&&n.val().toString().toLowerCase()!=e.toString().toLowerCase()&&t.hide())}),a.find("input:radio").on("change",function(){var a=o(this),e='[data-rb-enable-name="'+a.attr("name")+'"]';o(e).each(function(){var e=o(this),t=tinymce.editors[e[0].id],n=e.data("rbEnableValue");null!=n&&(n.toString().toLowerCase()==a.val().toLowerCase()?(e.prop("disabled",!1),t&&t.getBody().setAttribute("contenteditable",!0)):(e.prop("disabled",!0),t&&t.getBody().setAttribute("contenteditable",!1))),null!=(n=e.data("rbMakeVisibleValue"))&&(n.toString().toLowerCase()==a.val().toLowerCase()&&!e.is(":visible")||n.toString().toLowerCase()!=a.val().toLowerCase()&&e.is(":visible"))&&e.fadeToggle()})})})},o.fn.configureSCMForm=function(e){var n=o.extend({cancelButtonSelector:".cancel",submitButtonSelector:".submit",nextQuestionButtonSelector:".nextQuestion",skipButtonSelector:".skip",validatorIgnores:":disabled, input[type='hidden']",nextQuestion:null,cancel:null,skip:null,validateOnSubmit:null,validateOnKeyUp:!1},e);return this.each(function(){var t=o(this);jQuery.validator.unobtrusive.parse("#"+this.id),t.validate();var e=o.data(t[0],"validator").settings;e.ignore=n.validatorIgnores,!0===n.validateOnKeyUp&&(n.validateOnKeyUp=null),e.onkeyup=n.validateOnKeyUp,e.onsubmit=n.validateOnSubmit,t.find(n.submitButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(e){e.preventDefault(),t.valid()&&t.trigger("submit")}),t.find(n.nextQuestionButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(e){e.preventDefault(),n.nextQuestion()}),t.find(n.skipButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(e){e.preventDefault(),n.skip()}),t.find(n.cancelButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(e){e.preventDefault(),n.cancel?n.cancel():(t.hide(),SCM.hideModal())})})},o.fn.viewMore=function(e){var n=o.extend({hiddenSelector:".read-more",readMoreButtonSelector:"#readMore",readMoreText:"Read More",readLessText:"Read Less"},e);return this.each(function(){var t=o(n.hiddenSelector);t.hide(),o(n.readMoreButtonSelector).on("click",function(e){e.preventDefault(),t.fadeToggle()})})},o.fn.scmTinyMCE=function(){return o(".mceOpen.mce_forecolor").show(),o(".mce_forecolor .mceLast .mceIconOnly").show(),o(".mceOpen.mce_backcolor").show(),o(".mceOpen.mce_backcolor .mceIconOnly").show(),this.each(function(){o(this).tinymce({gecko_spellcheck:!0,theme:"advanced",theme_advanced_buttons1:"bold,italic,underline,|,bullist,numlist,|,sub,sup,|,charmap,|,forecolor,backcolor,|,link",theme_advanced_buttons2:"",theme_advanced_buttons3:"",plugins:"inlinepopups",theme_advanced_statusbar_location:null,oninit:function(e){var t=o("#"+e.editorId+"[data-rb-enable-name]"),e=o('input:radio[name="'+t.data("rbEnableName")+'"]');0<e.length&&e.val().toString().toLowerCase()!=t.data("rbEnableValue").toString().toLowerCase()&&(t.prop("disabled",!0),(t=tinymce.editors[t[0].id])&&t.getBody().setAttribute("contenteditable",!1))}})})},o.fn.scmTimer=function(t){return this.each(function(){var e,n,a,i=o(this),r=o.extend({h:0,m:0,s:0,hs:0,stop:!1,milliseconds:150,intervalCheck:null},t);r.stop?clearInterval(i.data("scmTimerToken")):(e=function(e){return e<10&&(e="0"+e),e},n=(new Date).getTime(),(a=function(){i.text(e(r.h)+":"+e(r.m)+":"+e(r.s)+":"+e(r.hs))})(),i.data("scmTimerToken",setInterval(function(){var e,t;i.is(":visible")?(t=(e=(new Date).getTime())-n,r.hs+=Math.floor(t/10),n=e,100<=r.hs&&(r.s+=Math.floor(r.hs/100),r.hs=r.hs%100,60<=r.s&&(r.m+=Math.floor(r.s/60),r.s=r.s%60),60<=r.m&&(r.h+=Math.floor(r.m/60),r.m=r.m%60)),a(),r.intervalCheck&&(r.intervalCheck(r)||clearInterval(i.data("scmTimerToken")))):clearInterval(i.data("scmTimerToken"))},r.milliseconds)))})},o.fn.wkTimer=function(t){return this.each(function(){var e,n,a,i=o(this),r=o.extend({h:0,m:0,s:0,hs:0,stop:!1,milliseconds:150,intervalCheck:null},t);r.stop?clearInterval(i.data("wkTimerToken")):(e=function(e){return e<10&&(e="0"+e),e},n=(new Date).getTime(),(a=function(){i.text(e(r.m)+":"+e(r.s))})(),i.data("wkTimerToken",setInterval(function(){var e,t;i.is(":visible")?(t=(e=(new Date).getTime())-n,r.hs+=Math.floor(t/10),n=e,100<=r.hs&&(r.s+=Math.floor(r.hs/100),r.hs=r.hs%100,60<=r.s&&(r.m+=Math.floor(r.s/60),r.s=r.s%60),60<=r.m&&(r.h+=Math.floor(r.m/60),r.m=r.m%60)),a(),r.intervalCheck&&(r.intervalCheck(r)||clearInterval(i.data("wkTimerToken")))):clearInterval(i.data("wkTimerToken"))},r.milliseconds)))})}}(jQuery);var SCM=SCM||{};SCM.__namespace=!0,SCM.eventManager=function(r){function e(e,t){return r.pubsub("subscribe",e,t)}function n(e,t){r.pubsub("publish",e,t)}function a(n,a){return e(s,function(e,t){n===t.actionEnum&&a(t.data)})}var i="actionCompleted",o=function(n,a){return e(i,function(e,t){n===t.actionEnum&&a(t)})},s="actionCompleteactionRequest";return{subscribeWidgetRefresh:function(e,t){var a=r.extend({refreshWhenInvisible:!1,messageContainerSelector:"#divMessage"},t),i="",i=o(e,function(t){var n;a.refreshIf&&!a.refreshIf(t)||(n=r(a.containerSelector),(a.refreshWhenInvisible||n.is(":visible"))&&r.ajax({type:"POST",url:a.url,data:a.data,dataType:"html",success:function(e){r.pubsub("unsubscribe",i),n.replaceWith(e).show(),a.refreshSuccess&&a.refreshSuccess(t)}}))})},subscribe:e,publish:n,publishActionCompleted:function(e,t){t=r.extend({actionEnum:e},t);n(i,t)},subscribeActionCompleted:o,publishActionRequest:function(e,t){return n(s,{actionEnum:e,data:t})},subscribeActionRequest:a,subscribeActionRequestDisplayResult:function(e,t){return a(e,function(e){e=r.extend({type:"POST"},e);r.ajax({type:e.type,url:e.url,data:e.data,dataType:"html",success:function(e){r(t).html(e).show()},error:function(e){alert(e)}}),SCM.hideModal()})}}}(jQuery),SCM.eventManager.subscriptionMessages={playVideo:"SCM.PlayVideo"};var SCM=SCM||{};!function(e,t){var a={},i=a.hasOwnProperty;e.subscribe=function(e,t){i.call(a,e)||(a[e]=[]);var n=a[e].push(t)-1;return{remove:function(){delete a[e][n]}}},e.publish=function(e,n){i.call(a,e)&&t.each(a[e],function(e,t){t(void 0!==n?n:{})})}}(SCM.EventEmitter=SCM.EventEmitter||{},jQuery);var SCM=SCM||{};SCM.AdvancedSearch={},SCM.AdvancedSearch.configSettings={preSelectSingleBookFacet:"true"};var textCharectorLimit=$("#hfSolrMaxAllowSearchChar").val(),UrlStripTrailingCharactersPattern="^.*[/\\\\]$";function AppendSubscriptionParameterToUrl(e){var t=e,n=!1;return $("#hfEnableSubscriptionFilter").length&&(n="true"==$("#hfEnableSubscriptionFilter").val().toLowerCase()),n&&(t=e+"&subonly=true"),t}function StripTrailingCharacters(e,t){for(var n=new RegExp(t);n.test(e);)e=e.substring(0,e.length-1);return e}function isValidDate(e){var t=/^(\d{2})[-\/](\d{2})[-\/](\d{4})$/.exec(e);if(null==t)return!1;var n=t[2],a=t[1]-1,e=t[3],t=new Date(e,a,n);return t.getDate()==n&&t.getMonth()==a&&t.getFullYear()==e}function isYearOnly(e){e=/^(\d{4})$/.exec(e);return e&&-1<e[1]}function updateYearOnlyToFullDate(e,t){var n=e.val(),a=null,i=null,i=t?a="01":(a="12","31");return e.val(a+"/"+i+"/"+n),e.val()}function restoreQbData(){if(sessionStorage){var e=sessionStorage.getItem("querybuilder_html");if(!e)return null;e=JSON.parse(e);$("#queryBuilder").html(e)}}Date.prototype.today=function(){return(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)+"/"+(this.getDate()<10?"0":"")+this.getDate()+"/"+this.getFullYear()},null!=textCharectorLimit&&""!=textCharectorLimit||(textCharectorLimit="255");var micrositeJournalDisplayName="",micrositeJournalId="",solrsearchScope=$("#hfSolrJournalID").val(),solrBookSearchScope=$("#hfSolrBookID").val();function GetQueryStringCharacter(e){return e.includes("?")?"&":"?"}function AddQueryStringParams(e){$(".access-filter-input-radio[value=contentowned]").is(":checked")&&(e=e+GetQueryStringCharacter(e)+"access_openaccess=true&access_free=true&access_unlocked=true");var t="";return $("#advancedSearch .advanced-search-content-type:checked").each(function(){this.checked&&(t?0<t.length&&(t+=" OR "+$(this).attr("value")):t=$(this).attr("value"))}),t&&(e=e+GetQueryStringCharacter(e)+"fl_ContentType="+t),e}void 0===solrsearchScope?solrsearchScope="":null!=solrsearchScope&&(solrsearchScope=solrsearchScope.replace("J","")),void 0===solrBookSearchScope?solrBookSearchScope="":null!=solrBookSearchScope&&(solrBookSearchScope=solrBookSearchScope.replace("B","")),$(document).ready(function(e){function t(e){var t,n;null==e||""==e?alert("Please enter a term to search"):e.length>parseInt(textCharectorLimit)?alert("Please enter a term between 1 to "+textCharectorLimit+" characters"):(t='"'+e+'"',e=n="",solrsearchScope&&(e="&fl_JournalID="+micrositeJournalId+"&f_JournalDisplayName="+encodeURIComponent($.trim(micrositeJournalDisplayName))),n="/search-results?q="+encodeURIComponent(t)+"&fd_ArticleTitle="+encodeURIComponent(t),n=AppendSubscriptionParameterToUrl(n+=""!=e?e:"&allJournals=1"),e=StripTrailingCharacters($("#hfSiteURL").val(),UrlStripTrailingCharactersPattern),window.location.href=window.location.protocol+"//"+e+n+"&searchType=advanced")}function n(){var e,t="1",n=null,a=null,i=[],r=[],o=[],s={},l=null,c=null,d=null,u=null,h=!1,p=!1,f=$("#advancedSearchQueryTerm").val();if((p=$("#queryBuilder").length)||null!=f&&""!=f)if(!p&&f.length>parseInt(textCharectorLimit))alert("Please enter a term between 1 to "+textCharectorLimit+" characters.");else{switch(s.q=f,$("#advancedSearch input.anyAllExact[type=radio]").each(function(){this.checked&&(t=$(this).attr("id"))}),e='"'+f+'"',t){case"1":s.hd="advancedAny",l=f;break;case"2":s.hd="advancedAll",l=f;break;case"3":l=e}s.q=encodeURIComponent($.trim(l));p=$("#advancedSearch #authorName").val();if(null!=p&&""!=p&&(s.author=p),null!=(n=$("#startDateSemanticSearch").val())&&""!=n&&"mm/dd/yyyy"!=n){if(isYearOnly(n))n=updateYearOnlyToFullDate($("#startDateSemanticSearch"),!0);else if(!isValidDate(n))return void alert("please enter valid start date");if(""===$("#endDateSemanticSearch").val())$("#endDateSemanticSearch").val((new Date).today()),a=$("#endDateSemanticSearch").val();else if(isYearOnly(a=$("#endDateSemanticSearch").val()))a=updateYearOnlyToFullDate($("#endDateSemanticSearch"),!1);else if(!isValidDate(a)||new Date(a)<new Date(n))return void alert("please enter valid end date");s.rg_PublicationDate=n+" TO "+a}$("#advancedSearch input.rbPublication[type=radio]").each(function(){this.checked&&(h="J*"==$(this).attr("value"),$(this).attr("value"))}),$("#advancedSearch .advancedSearchJournal:checked").each(function(){h=!0,d=$(this).attr("currentjournaldisplayname"),c=$(this).attr("text"),o.push($(this).attr("value")),i.push($(this).attr("jid"))}),$("#advancedSearch .advancedSearchBook:checked").each(function(){u=$(this).attr("text"),r.push($(this).attr("bid"))}),p=s,n=function(){var a=[];$("#js_qb_groups .js_qb_group").each(function(){var n={},e=$(this);e.children(".row").children(".js_qb_data").each(function(){var e=$(this),t=e.attr("data-qb-json-element");n[t]=e.val()});var t=[];e.find(".js_qb_term").each(function(){var n={};$(this).find(".js_qb_data").each(function(){var e=$(this),t=e.attr("data-qb-json-element");n[t]="exactMatch"===t?e.is(":checked"):e.val()}),n.input&&n.input.length&&t.push(n)}),t.length&&(t[0].condition&&delete t[0].condition,n.terms=t,a.push(n))}),!Object.keys(a).length||a[0].condition&&delete a[0].condition;return a}(),function(){var e,t;sessionStorage&&(e=$("#queryBuilder").length,t=$("#queryBuilder").html(),e&&t.length&&sessionStorage.setItem("querybuilder_html",JSON.stringify(t)))}(),Object.keys(n).length&&(p.cqb=JSON.stringify(n));a="/search-results?"+$.param(s);h&&(m=o.join(" OR "),p=i.join(" OR "),a+="&restypeid=3",1==o.length?(n=encodeURIComponent($.trim(c)),journalQuery=c==d?"&fl_JournalID="+p+"&f_JournalDisplayName="+n:"&fl_JournalID="+p+"&f_JournalDisplayName="+encodeURIComponent($.trim(d))+"&fd_LegacyJournalDisplayName="+n,a+=journalQuery):1<o.length?a+="&fl_JournalHistID="+m:0==o.length&&(a+="&allJournals=1")),null!=solrBookSearchScope&&""!=solrBookSearchScope&&!h&&(a+=g(r,u)),a=AddQueryStringParams(a=AppendSubscriptionParameterToUrl(a));var m=StripTrailingCharacters($("#hfSiteURL").val(),UrlStripTrailingCharactersPattern);window.location.href=window.location.protocol+"//"+m+a+"&searchType=advanced"}else alert("Please enter a term to search")}function a(){var e=null,t=null,n=null,a=[],i=[],r=[],o={},s=null,l=null,c=null,d=!1,u=!1;if(null!=(n=$("#advancedAuthorSearchQueryTerm").val())&&""!=n)if(n.length>parseInt(textCharectorLimit))alert("Please enter a term between 1 to "+textCharectorLimit+" characters.");else{if(o.author=encodeURIComponent($.trim(n)),o.q=encodeURIComponent($.trim(n)),null!=(e=$("#startDateAuthor").val())&&""!=e&&"mm/dd/yyyy"!=e){if(isYearOnly(e)&&(e=updateYearOnlyToFullDate($("#startDateAuthor"),!0)),!isValidDate(e))return void alert("please enter valid start date");if(""===$("#endDateAuthor").val()?($("#endDateAuthor").val((new Date).today()),t=$("#endDateAuthor").val()):isYearOnly(t=$("#endDateAuthor").val())&&(t=updateYearOnlyToFullDate($("#endDateAuthor"),!1)),!isValidDate(t)||new Date(t)<new Date(e))return void alert("please enter valid end date");o.rg_PublicationDate=e+" TO "+t}$(".advancedAuthorSearch input.rbPublication[type=radio]").each(function(){this.checked&&(u="J*"==$(this).attr("value"),d="B*"==$(this).attr("value"))}),$(".advancedAuthorSearch .advancedSearchJournal:checked").each(function(){u=!0,l=$(this).attr("currentjournaldisplayname"),s=$(this).attr("text"),r.push($(this).attr("value")),a.push($(this).attr("jid"))}),$("#advancedSearch #chkAdvancedSearchBook:checked").each(function(){d=!0,c=$(this).attr("text"),i.push($(this).attr("bid"))});e="/search-results?"+$.param(o);u&&(h=r.join(" OR "),t=a.join(" OR "),e+="&restypeid=3",1==r.length?(o=encodeURIComponent($.trim(s)),journalQuery=s==l?"&fl_JournalID="+t+"&f_JournalDisplayName="+o:"&fl_JournalID="+t+"&f_JournalDisplayName="+encodeURIComponent($.trim(l))+"&fd_LegacyJournalDisplayName="+o,e+=journalQuery):1<r.length?e+="&fl_JournalHistID="+h:0==r.length&&(e+="&allJournals=1")),d&&(e+=g(i,c)),e=AppendSubscriptionParameterToUrl(e);var h=StripTrailingCharacters($("#hfSiteURL").val(),UrlStripTrailingCharactersPattern);window.location.href=window.location.protocol+"//"+h+e+"&searchType=advanced"}else alert("Please enter a term to search")}function i(){var e,t=$("#Doi").val().trim();null!=(e=$("#Doi").val().trim())&&""!=e?(t={doi:t},$.ajax({type:"POST",url:"/Solr/DoiSearch/search",data:t,success:function(e){0==e&&alert("Invalid DOI. Please enter a valid DOI")},error:function(e){alert("There was a problem with your request. Please try again later")}})):alert("Please enter a Doi to search")}function g(e,t){var n="&restypeid=1",a=e.join(" OR ");return"true"==SCM.AdvancedSearch.configSettings.preSelectSingleBookFacet&&1===e.length?n=n+"&f_BookDisplayName="+encodeURIComponent($.trim(t))+"&fl_BookID="+a:0<e.length?n=n+"&fl_BookID="+a:0===e.length&&(n+="&allBooks=1"),n}null==solrBookSearchScope||""==solrBookSearchScope?($("#advancedSearch input.advancedSearchBook[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$(".advancedAuthorSearch input.advancedSearchBook[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$("input.rbPublication[type=radio]").each(function(){"B*"==$(this).attr("value")?$(this).prop("checked",!1):$(this).prop("checked",!0)})):($("#advancedSearch input.advancedSearchJournal[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$(".advancedAuthorSearch input.advancedSearchJournal[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$("input.rbPublication[type=radio]").each(function(){"J*"==$(this).attr("value")?$(this).prop("checked",!1):$(this).prop("checked",!0)})),(null!=solrsearchScope&&""!=solrsearchScope||null!=solrBookSearchScope&&""!=solrBookSearchScope)&&($(".advancedAuthorSearch input:checkbox").each(function(){var e=$(this).attr("currentjournaldisplayname"),t=$(this).attr("text"),n=$(this).attr("jid"),a=$(this).attr("bid");if(null!=e&null!=t&&e==t){if(n==solrsearchScope)return this.checked=!0,micrositeJournalDisplayName=t,micrositeJournalId=n,!1}else null!=a&&""!=a&&(a!=solrBookSearchScope&&"*"!==solrBookSearchScope||(this.checked=!0))}),$("#advancedSearch input:checkbox").each(function(){var e=$(this).attr("currentjournaldisplayname"),t=$(this).attr("text"),n=$(this).attr("jid"),a=$(this).attr("bid");if(null!=e&null!=t&&e==t){if(n==solrsearchScope)return this.checked=!0,micrositeJournalDisplayName=t,micrositeJournalId=n,!1}else null!=a&&""!=a&&(a!=solrBookSearchScope&&"*"!==solrBookSearchScope||(this.checked=!0))}),$(".citationJournal").each(function(){$("option",this).each(function(){var e=$(this).val().split(",");null!=e&&"C"==e[0]&&e[1]==solrsearchScope&&$(this).prop("selected",!0)})})),$("#btnAdvancedTitleSearch").click(function(){t($("#articleTitle").val())}),$("#articleTitle").keydown(function(e){13==e.keyCode&&t($("#articleTitle").val())}),$("#btnAdvancedCitationSearch").click(function(){!function(){var e=$("#citationYear").val(),t=$("#citationVolume").val(),n=$("#citationVolume").attr("pattern"),a=$("#citationPage").val(),i=$(".citationJournal").val(),r=$(".citationJournal option:selected").text(),o=!1,s="";$("#citationIssueNo").length&&(s=$("#citationIssueNo").val());var l={},c=null!=i&&""!=i&&"- Select a Journal"!=i?"":"Please select a journal.\n";null!=e&&""!=e&&"Yr"!=e&&(isNaN(e)?c+="Year must be numeric.\n":(e="01/01/"+e+" TO 12/31/"+e,l.rg_PublicationDate=e)),null!=t&&""!=t&&"Vol"!=t&&(new RegExp(n).test(t)?l.fd_Volume=t:c+="Volume must be alphanumeric without spaces"),null!==s&&""!==s&&"Issue"!==s&&(l.fd_IssueNo=s),""!=a&&"1st Pg"!=a&&(l.fd_StartPage=a),0<c.length?alert(c):("C"==(i=i.split(","))[0]?(l.fl_JournalID=i[1],o=!0):l.fl_JournalHistID=i[2],l="/search-results?"+$.param(l),l+=o?"&f_JournalDisplayName="+encodeURIComponent($.trim(r)):"&fd_LegacyJournalDisplayName="+encodeURIComponent($.trim(r)),r=StripTrailingCharacters($("#hfSiteURL").val(),UrlStripTrailingCharactersPattern),window.location.href=window.location.protocol+"//"+r+l+"&searchType=advanced")}()}),$("#btnAdvancedCitationSearch").keyup(function(e){13==e.keyCode&&(e.preventDefault(),doAdvancedCitationSerach())}),$("#advancedSearchQueryTerm").keydown(function(e){13==e.keyCode&&n()}),$(document).on("click","#btnAdvancedSearch, #btnAdvancedSearchTop",function(){n()}),$(document).on("click","#btnAdvancedAuthorSearch, #btnAdvancedAuthorSearchTop",function(){a()}),$("#advancedAuthorSearchQueryTerm").keydown(function(e){13==e.keyCode&&a()}),$("#Doi").on("keydown",function(e){13==e.keyCode&&i()}),$("#btnDoiSearch").on("click",function(e){i()});function r(){var e=$("#js_qb_term_template").html();$(this).siblings(".js_qb_terms_list").append(e)}var o,s;function d(e,t){t=new RegExp("[?&]"+e+"=([^&#]*)").exec(t);return t&&1<t.length?decodeURI(t[1].toString()):""}$(document).on("click",".js_qb_add_group",function(){var e=$("#js_qb_group_template").html();$("#js_qb_groups").append(e)}),$(document).on("click","#btnAdvancedSearchReset",function(){sessionStorage.removeItem("querybuilder_html"),0<=window.location.href.indexOf("?")?window.location.href=window.location.href.split("?")[0]:window.location.reload()}),$(document).on("click",".js_qb_add_term",r),(s=window.location.href.split("?")[1]||"")&&(function(e){if(e=d("cqb",e)){for(var t=JSON.parse(e),n=Object.keys(t).length-1,a=0;a<n;a++)$(".js_qb_add_group").click();for(a=0;a<Object.keys(t).length;a++){var i=t[a],r=$("#js_qb_groups .js_qb_group").eq(a);i.condition&&r.find('select[data-qb-json-element="condition"]').val(i.condition);for(var o=i.terms.length-2,s=0;s<o;s++)r.find(".js_qb_add_term").click();for(s=0;s<i.terms.length;s++){var l=i.terms[s],c=r.find(".js_qb_term").eq(s);l.condition&&c.find('select[data-qb-json-element="condition"]').val(l.condition),c.find('select[data-qb-json-element="filter"]').val(l.filter),c.find('input[data-qb-json-element="input"]').val(l.input),l.exactMatch&&c.find('input[data-qb-json-element="exactMatch"]').click()}}}else restoreQbData()}(s=decodeURIComponent(s.replace(/\+/g," "))),(o=d("rg_PublicationDate",o=s))&&(o=o.split(/\sTO\s/),$("#startDateSemanticSearch").val(o[0]),$("#endDateSemanticSearch").val(o[1])),(s=d("f_JournalDisplayName",o=s))?function(e){e&&$('.advancedSearchJournal[currentjournaldisplayname="'+e+'"]').click()}(s):(function(e){(e=d("fl_JournalID",e))&&$('.advancedSearchJournal[jid="'+e+'"]').click()}(o),function(e){(e=d("fl_JournalHistID",e))&&e.split(/\sOR\s/).forEach(function(e){$('.advancedSearchJournal[value="'+e+'"]').click()})}(o))),$(document).on("click",".toggle-expanded",function(){$(this).parents(".search-module").toggleClass("collapsed").toggleClass("expanded")})}),$(function(){try{$("#startDateSemanticSearch").on("keydown",function(e){if(13==e.which&&isYearOnly($("#startDateSemanticSearch").val()))return updateYearOnlyToFullDate($("#startDateSemanticSearch"),!0),e.preventDefault(),e.stopImmediatePropagation(),!1}),$("#endDateSemanticSearch").on("keydown",function(e){if(13==e.which&&isYearOnly($("#endDateSemanticSearch").val()))return updateYearOnlyToFullDate($("#endDateSemanticSearch"),!0),e.preventDefault(),e.stopImmediatePropagation(),!1}),$("#startDateAuthor").on("keydown",function(e){if(13==e.which&&isYearOnly($("#startDateAuthor").val()))return updateYearOnlyToFullDate($("#startDateAuthor"),!0),e.preventDefault(),e.stopImmediatePropagation(),!1}),$("#endDateAuthor").on("keydown",function(e){if(13==e.which&&isYearOnly($("#endDateAuthor").val()))return updateYearOnlyToFullDate($("#endDateAuthor"),!0),e.preventDefault(),e.stopImmediatePropagation(),!1})}catch(e){}});var SCM=SCM||{};!function(pdf,$){function formatIssuePurchaseLink(e,t){var n=e;return 0<=e.toLowerCase().indexOf("resourceid=")&&(n=e.replace(/resourceID=\{0\}|resourceID=\d+/i,"resourceid="+t)),n}function logErrors(jqXHR,textStatus,errorThrown){var err;window.console&&(err=eval("("+jqXHR.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}function openPDF(e){window.location.href=e}function openNoAccessModalArticle(e,t){e.attr({"data-reveal-id":"noAccessReveal","data-reveal":""}).removeAttr("data-ajax-url");t="/article.aspx?articleid="+t+"#purchaseSubscriptionBox";pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href",t),SCM.Utilities.Reveal.open(pdf.$noAccessModal)}function openNoAccessModalArticleSeo(e,t,n){e.attr({"data-reveal-id":"noAccessReveal","data-reveal":""}).removeAttr("data-ajax-url"),"DO_NOT_USE"===n?pdf.$noAccessModal.find("#articleLinkToPurchase").remove():(n=n,pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href",n)),SCM.Utilities.Reveal.open(pdf.$noAccessModal)}pdf.$noAccessModal=$("#noAccessReveal"),pdf.checkArticlePDFAccess=function(t){var n=t.attr("data-article-id"),a=t.attr("data-article-url"),e=t.attr("data-ajax-url"),i=$("#hfSiteURL"),r="";null!==t.attr("data-article-seo-url")&&(r=t.attr("data-article-seo-url")),void 0!==i&&void 0!==i.val()&&""!==i&&(e="//"+i.val()+e);i={};i.aId=n,$.ajax({type:"POST",url:e,data:i,traditional:!0,success:function(e){e.Success?openPDF(a):0<r.length?openNoAccessModalArticleSeo(t,n,r):openNoAccessModalArticle(t,n)},error:function(e,t,n){logErrors(e,t,n)}})},pdf.checkIssuePDFAccess=function(a){var e,t;a.length&&(e=a.attr("data-issue-id"),t=a.attr("data-ajax-issue-url"),$.ajax({type:"POST",url:t,data:{issueId:e},traditional:!0,success:function(e){e.Success?a.show():a.hide()},error:function(e,t,n){a.hide()}}))},pdf.bindUiEvents=function(){$(document).on("click",".al-link.pdfaccess",function(){SCM.Utilities.Reveal.close(pdf.$noAccessModal),pdf.$noAccessModal.find("#articleLinkToPurchase").show(),pdf.$noAccessModal.find(".issue-purchase-modal").hide(),$(this).attr("data-reveal-id")||pdf.checkArticlePDFAccess($(this))}),pdf.checkIssuePDFAccess($(".js-issue-pdfLink"))},pdf.init=function(){pdf.bindUiEvents()}}(SCM.PDFAccess=SCM.PDFAccess||{},jQuery);var SCM=SCM||{};SCM.ArticleListResources=SCM.ArticleListResources||{},SCM.ArticleListResources.registerSnippetViewMore=function(){$(document).on("click",".al-article-snippet-view-more",function(){$(this).parent(".al-article-snippet").toggleClass("collapsed expanded")})},SCM.ArticleListResources.getArticleDetails=function(){$(document).ready(function(){var e,t="";$(".al-article-items[data-article-id]").has(".Locked").each(function(){0<t.length&&(t+=","),t+=$(this).attr("data-article-id")});0<t.length&&(e=$(".article-list-resources").first().attr("data-journalIds"),$.post("/Article/ArticleListResourcesDetails",{journalIds:e,accessCheckArticleIds:t},function(e){for(var t in e)$('.al-article-items[data-article-id="'+t+'"]').find(".article-accessType").removeClass("Locked").addClass(e[t])},"json"))})},SCM.ArticleListResources.registerSnippetViewMore(),SCM.ArticleListResources.getArticleDetails();var SCM=SCM||{};SCM.BookBasicInfo=SCM.BookBasicInfo||{},SCM.BookBasicInfo.registerAbstractSnippetReadMore=function(){$(document).on("click",".js-toggle-book-abstract-snippet",function(){$(this).parents(".book-info__abstract").toggleClass("collapsed"),$(this).toggleClass("expanded"),$(this).children(".js-arrow-icon").toggleClass("icon-general_arrow-down icon-general_arrow-up")})},SCM.BookBasicInfo.registerAbstractSnippetReadMore();var SCM=SCM||{};SCM.QueryBuilder={},SCM.QueryBuilder.defaults={runSearch:function(e){window.location.hash="#"+e}},SCM.QueryBuilder.configure=function(){function n(e){var t=e,e=t.closest(".querybuilder-instance");t.hasClass("filter-citation")?(e.find(r).addClass("hide"),e.find(o).removeClass("hide")):(e.find(o).addClass("hide"),e.find(r).removeClass("hide"))}var t,e=$(".querybuilder-filter"),a=$(".querybuilder-filter-current-wrap"),i=$(".querybuilder-filter-dropdown"),r=$(".querybuilder-input-standard"),o=$(".querybuilder-input-citation"),s=$(".querybuilder-instance"),l=$(".querybuilder-add");function c(n,a){s.each(function(){var e=s.attr("id"),t=$(this).find("li[data-fieldname='Citation']");e===n&&null!==n||(a?t.show():t.hide())})}(t=jQuery)(".querybuilder-instance").each(function(){t(this).hasClass("hide")||0}),e.each(function(){var e=t(this);e.hasClass("selected")&&(e.closest(a).find(".querybuilder-filter-label-text").text(e.text()),n(e))}),a.off("click"),a.on("click",function(e){$(".sort-order-list").addClass("hide"),e.stopPropagation();e=$(this).find(i);i.not(e).addClass("hide"),e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")}),$(document).off("click",".pg_searchresults"),$(document).on("click",".pg_searchresults",function(){i.addClass("hide")}),e.off("click"),e.on("click",function(){var e=$(this),t=e.closest(".querybuilder-filter-dropdown");$thisLabel=e.closest(a).find(".querybuilder-filter-label-text"),t.children(e).removeClass("selected"),e.addClass("selected"),$thisLabel.text(e.text()),n(e),e.hasClass("filter-citation")?c(e.closest(".querybuilder-instance").attr("id)"),!1):c(e=function(){var e=null;return s.each(function(){if(!$(this).hasClass("hide")&&!$(this).find(o).hasClass("hide"))return e=$(this).attr("id"),!1}),e}(),null===e)}),$(".querybuilder-input, .citation-input").on("keyup",function(){$("#queryBuilderSubmit").addClass("btn-green").removeAttr("style"),!function(e){var t=e;if(t.hasClass("citation-input")){var n=t.find(".citation-year").val().replace(/\'/g,"").trim().length,a=t.find(".citation-volume").val().replace(/\'/g,"").trim().length,i=t.find(".citation-issue").val().replace(/\'/g,"").trim().length,e=t.find(".citation-page").val().replace(/\'/g,"").trim().length;return 0<n||0<a||0<i||0<e?!0:(0!==n||0!==a||0!==i||0!==e)&&void 0}t=t.val().replace(/\'/g,"").trim().length;return 0!==t&&(0<t||void 0)}($(this))?l.removeClass("valid").prop("disabled",!0):l.addClass("valid").prop("disabled",!1)}),l.off("click"),l.on("click",function(){var e;$(this).prop("disabled")?alert("A value must be entered before adding another filter."):(e=1,s.each(function(){$(this).hasClass("hide")||e++}),$("#qbInstance"+e).removeClass("hide"),l.removeClass("valid").prop("disabled",!0))}),$(".querybuilder-submit").off("click"),$(".querybuilder-submit").on("click",function(){$(this).removeClass("btn-green").attr("style","opacity: 0.3;")})},$(".js-main").off("click",".querybuilder-submit"),$(".js-main").on("click",".querybuilder-submit",function(){var e="",f=$("#hfCurrentSearchTerm").val(),m=$(".querybuilder-submit").attr("data-current-url"),g=new Object,v=1,y=!1;function C(e,t){var n,a="";return 0<=t.indexOf("q=")?((n=SCM.Common.getQueryStringValue(t,"q")).startsWith("(")||(a="("),a=n.endsWith(")")?a+n.slice(0,-1)+" AND "+e+")":a+n+" AND "+e+")",t.replace(n,a)):"q="+e+"&"+t}$(".querybuilder-wrap .querybuilder-instance").each(function(e){if(!$(this).hasClass("hide")){var t=$(this).find(".querybuilder-filter-dropdown li.selected").text(),n=$(this).find(".querybuilder-filter-dropdown li.selected").attr("data-fieldname"),a=!1;if(1===v){if(null==n||""===$.trim(n)){var i,r=(r=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&"));return f!==r&&(m=0<=(i=m.indexOf("q="))?(o=0<=m.indexOf("&",i)?"&":"",null!==(i=SCM.Common.getQueryStringValue(m,"q"))&&""!==i?(i="q="+i+o,m.replace(i,"q="+r+o)):"q="+r+"&"+m):"q="+r+"&"+m),g.q=r,v++,y=!0}var o=SCM.Common.getQueryStringValue(m,"q");null!==o&&""!==o&&(o="q="+o,r=m.indexOf(o)+o.length,o+="&"===m[r]?"&":"",m=m.replace(o,"")),a=!0}var s="";switch(t){case"":var l="q"+v;""!==(s=(s=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&")))&&(m=C(s,m),g[l]=s,y=!0);break;case"All":""!==(s=(s=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&")))&&(m=C(s,m),(1===v&&a||1!==v)&&(g["All"+v]=s,y=!0));break;case"Citation":var c=new Object,d="Citation"+v,u=$(this).find("#instance_CitationYear").val().trim(),h=$(this).find("#instance_CitationVolume").val().trim(),l=$(this).find("#instance_CitationIssueNo").val().trim(),p=$(this).find("#instance_CitationPage").val().trim();""===u&&""===h&&""===l&&""===p||(g[d]=c,y=!0,null!==u&&""!==u&&(c.Year=u),null!==h&&""!==h&&(c.Volume=h),null!==l&&""!==l&&(c.IssueNo=l),null!==p&&""!==p&&(c.StartPage=p));break;default:p=n+v;""!==(s=(s=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&")))&&(g[p]=s,y=!0)}}v++});var t,n=SCM.Common.getQueryStringValue(m,"page");"page=1"===m&&(m="&page=1"),null!==n&&""!==n&&(m=m.replace("page="+n+"&","page=1&")),e=m,y&&(t=-1!==(t=JSON.stringify(g)).indexOf("&")?encodeURIComponent(t):t,e=(n=SCM.Common.getQueryStringValue(m,"qb"))?e.replace(n,t):e+("&"===e[e.length-1]?"qb=":"&qb=")+t),SCM.QueryBuilder.defaults.runSearch(e)}),$(".querybuilder-input").keyup(function(e){var t=e.which;13===t&&e.preventDefault();e=$.trim($(this).val());if(13===t&&""!==e)return $(".querybuilder-submit").click(),!1}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;e=n.lastIndexOf(e,t);return-1!==e&&e===t});var SCM=SCM||{};!function(e,o,n){var t,s,a,i;function r(){var t,e;o(".tab-item").parent("li").show(),o(".tabs-content").length&&(t="",o(".tabs-content > .content").each(function(){var e=o(this);e.hasClass("active")&&(t=e.attr("id"))}),o("#ViewsDrop li").show(),o("#ViewsDrop").find('[data-tab="#'+t+'"]').closest("li").hide()),(e=o(".item-with-dropdown")).show(),e.each(function(){var t=!1,n=o(this),e=n.hasClass("item-pdf");n.find("ul li").each(function(){var e="none"===n.css("display");!n.is(":visible")&&e||(t=!0)}),t||e||n.hide()})}function l(e,t){var n,a,i,r=o('.widget-items[data-widgetname="'+e+'"]').find(".js-content-section"),r={$contentTopSections:o('.widget-items[data-widgetname="'+e+'"]').children(),$contentSections:r,$figuresTablesSections:r.has(".table-wrap, .fig-section"),$videoSections:r.has(".video-section"),$audioSections:r.has(".audio-section"),$supplementaryData:o(".widget-"+t+", .supplementary-material"),$commentsSection:o("#ContentTab").find("div.comments")};t=r,s.find('.js-content-filter[data-content-filter="article-content"]').hide(),t.$figuresTablesSections.length||s.find('.js-content-filter[data-content-filter="figures-tables"]').remove(),t.$videoSections.length||s.find('.js-content-filter[data-content-filter="video"]').remove(),t.$audioSections.length||s.find('.js-content-filter[data-content-filter="audio"]').remove(),t.$supplementaryData.length||s.find('.js-content-filter[data-content-filter="supplementary-data"]').remove(),n=r,a=o("#ContentTab").find("div.downloadImagesppt"),i=o(".article-metadata-standalone-panel"),s.children(".article-content-filter").on("click",function(){var e=o(this);e.hide(),e.siblings().show();var t=e.attr("data-content-filter"),e=null;"figures-tables"===t?e=n.$figuresTablesSections:"video"===t?e=n.$videoSections:"audio"===t?e=n.$audioSections:"supplementary-data"===t&&(e=n.$supplementaryData),e&&e.length?(n.$contentTopSections.hide(),n.$contentSections.hide(),n.$supplementaryData.hide(),(t=e)&&t.each&&t.each(function(e,t){!function(e){if(e&&1===e.length&&e.show){e.show();for(var t=e.parent();t&&t.length&&!t.is("#ContentTab");)t.show(),t=t.parent()}}(o(t))}),n.$commentsSection.hide(),t=a,e.filter(".fig-section:not(:has(a[restricted]))").length?t.show():t.hide()):(n.$contentTopSections.show(),n.$contentSections.show(),1<i.length?i.show():i.hide(),n.$supplementaryData.show(),n.$commentsSection.show(),a.hide()),SCM.SiteJS.restrictedImages()})}e.closeDropDownIfChildItemClicked=function(){o("#Toolbar .f-dropdown > li").on("click",function(){o(this).closest(".toolbar-item").trigger("click")})},e.removeTabLinkIfTabIsEmpty=function(e){o(e).find(".tab-trigger").each(function(){var e=o(this),t=e.attr("data-tab");"#ContentTab"!==t&&o(t).find("*").length<20&&(0===(void 0!==(t=o(t).html())?o.trim(t.replace(/(<([^>]+)>)/gi,"")):1).length&&e.parent("li").remove())})},e.hideTabIfDropdownIsEmpty=function(){for(var e=[$pdfDrop,a,i],t=0;t<e.length;t++){var n=e[t];n.children("li").length<1&&n.parent().hide()}s.children("li").length<2&&s.parent().hide()},e.toggleTabContent=function(){o(".tab-trigger").on("click",function(e){e.preventDefault();var t=o(this).attr("data-tab"),e=o(t);e.siblings().removeClass("active"),e.addClass("active"),"#FigureTab"===t&&n.trigger("scroll"),r()})},e.styleToolbarStates=function(){t.on("click",".toolbar-item",function(){var e=o(this);e.addClass("clicked"),e.siblings().removeClass("clicked")}),n.on("click",function(){o(".toolbar-item").each(function(){var e=o(this);e.find("ul").hasClass("open")||e.removeClass("clicked")})})},e.toolbarDropdowns=function(){o(".js-toolbar-dropdown").click(function(e){var t=o(this).next(".f-dropdown"),n=o(".js-toolbar-dropdown").find(".js-pdf-dropdown-arrow-icon");e.stopPropagation(),o(".f-dropdown").not(t).css("display","none"),o(".toolbar-search").removeClass("expanded"),t.slideToggle("fast",function(){o(this).is(":visible")&&o(this).css("display","flex")}),o(document.body).on("click",function(){o(t).css("display","none"),n.hasClass("icon-general_arrow-up")&&(n.removeClass("icon-general_arrow-up"),n.addClass("icon-general_arrow-down"))})})},e.init=function(){(t=o("#Toolbar")).length&&(s=o("#ViewsDrop"),a=o("#ShareDrop"),i=o("#ToolsDrop"),$pdfDrop=o("#PdfDrop"),r(),e.removeTabLinkIfTabIsEmpty(s),e.styleToolbarStates(),e.toggleTabContent(),o("#ContentTab .widget-ArticleFulltext").length?l("ArticleFulltext","ArticleDataSupplements"):o("#ContentTab .widget-BookSectionsText").length?l("BookSectionsText","DataSupplements"):o("#ContentTab .widget-BookToc").length?l("BookToc","DataSupplements"):s.closest(".js-item-views").addClass("hide"),e.hideTabIfDropdownIsEmpty(),e.toolbarDropdowns())}}(SCM.Toolbar=SCM.Toolbar||{},jQuery,$(document));var SCM=SCM||{};SCM.ClientStatsMaster=function(o){function s(e,t,n,a,i,r){this.SourceType=e,this.ActionType=t,this.ActionDescription=n,this.ActionUrl=a,this.SearchData=i,this.IsTurnaway=r}function i(e,t){this.ActionFilterKey=e,this.ActionFilterValue=t}function r(e,t,n){this.SessionID=e,this.ClientID=t,this.SiteID=n}function l(e,t,n,a){this.UserSessionItem=new r("",0,o("#hdnSiteID").val()),this.ActionFilterType=new i(e,t),this.ActionDescription=n,this.ActionURL=a}function a(e,t,n,a,i,r){r=new s(e,t,n,a,i,r).toJson();o.ajax({type:"POST",url:"/Services/UserActionService.svc/TrackUserAction",data:r,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,processData:!0}).fail(function(e,t){window.console&&(console.log("jqXhr.responseText: "+e.responseText),console.log("status: "+t))})}return s.prototype.toJson=function(){return JSON.stringify(this)},l.prototype.toJson=function(){return JSON.stringify(this)},{trackContentTabEvents:function(){var e=o("#Toolbar"),t={"#FigureTab":"FiguresClicked","#TableTab":"TablesClicked","#ContentTab":"ArticleClicked","#SupplementTab":"SupplementClicked","#MultimediaTab":"MultimediaClicked"};e.on("click",".tab-trigger",function(){var e=o(this).attr("data-tab");e in t&&a(22,"View",t[e],window.location.href,"",!1)})},trackShares:function(){var e=o("#ShareDrop"),t={addthis_button_email:"EmailClicked",addthis_button_share:"TwitterClicked",addthis_button_facebook:"FacebookClicked"};e.on("click","a",function(){var e=o(this).attr("class");e in t&&a(22,"Share",t[e],window.location.href,"",!1)})},trackSingleAction:function(e,t,n){e.on("click",function(){a(22,t,n,window.location.href,"",!1)})},trackGdprCookieAcceptance:function(e,t,n){var a;a=e,e=t,t=n,n=window.location.href,n=new l(a,e,t,n).toJson(),o.ajax({type:"POST",url:"/ClientTrackingHandler.ashx",data:n,contentType:"application/json; charset=utf-8",async:!0,processData:!0}).fail(function(e,t){window.console&&(console.log("jqXhr.responseText: "+e.responseText),console.log("status: "+t))})}}}(jQuery),$(window).on("load",function(){SCM.ClientStatsMaster.trackContentTabEvents(),SCM.ClientStatsMaster.trackShares(),SCM.ClientStatsMaster.trackSingleAction($('a[data-reveal-id="getCitation"]'),"Tools","GetCitationClicked"),SCM.ClientStatsMaster.trackSingleAction($("div.toolboxGetAlertsWidget"),"Tools","AlertsClicked"),SCM.ClientStatsMaster.trackSingleAction($("div#getAlertsConfirmation"),"Tools","AlertAdded"),SCM.ClientStatsMaster.trackSingleAction($("#PermissionsLink"),"Tools","GetPermissionsClicked"),SCM.ClientStatsMaster.trackSingleAction($("a.tablelink").filter(":parent"),"ViewLargeImage","ViewLargeImageClicked")});var SCM=SCM||{};SCM.JumpLinks=function(a){var i,n,r=500;return{init:function(){(i=a(".jumplink-list, .jumplink-list-flyout, .list-issue-jumplinks")).length&&(l(),c(),a(document).on("click","a.js-sec-jumplink",function(e){var t;location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname&&(0<(t=a(this).data("scrollto")).indexOf(" ")&&(t=t.split(" ")[0]),t=o(t),s(a("[data-legacyid="+t+"]")))}),a(".pg_Article").length&&a(".jumplink-list-flyout").length&&(a(".js-jumplink-flyout-trigger").on("click",function(e){e.stopPropagation(),a(".jumplink-list-flyout-container").toggleClass("active")}),a(document.body).on("click",function(){a(".jumplink-list-flyout-container").removeClass("active")})),[{titleElementSelector:".authorNotes-section-title",wrapperClass:"author-notes-jumplink",targetId:"authorNotesSectionTitle"},{titleElementSelector:".footNotes-section-title",wrapperClass:"foot-notes-jumplink",targetId:"footNotesSectionTitle"},{titleElementSelector:".coiStatement-section-title",wrapperClass:"coi-statement-jumplink",targetId:"coiStatementSectionTitle"},{titleElementSelector:".supplementary-data-section-title",wrapperClass:"datasupplements-section-jumplink",targetId:"supplementary-data"},{titleElementSelector:".js-comments-title",wrapperClass:"usercomments-section-jumplink",targetId:"usercomments",linkHtmlSelector:".js-comments-jumplink"}].forEach(function(e){var t=a(e.titleElementSelector).first().text().trim(),n=a(e.linkHtmlSelector).first().length?a(e.linkHtmlSelector).first().html():void 0;t&&(e={title:t,targetId:e.targetId,wrapperClass:e.wrapperClass,linkHtml:n},n=e.linkHtml||'<a class="jumplink scrollTo" href = "#'+e.targetId+'">'+e.title+"</a>",n='<li class="section-jump-link head-1 '+e.wrapperClass+'"><div class="section-jump-link__link-wrap">'+n+"</div></li> ",i.append(n))}),function(){var e,n=i.find("li").has(".jumplink");!n.length||(e=a("#ContentTab [scrollto-destination]")).length&&(e=e.map(function(e,t){return n.has('[href="#'+t.getAttribute("scrollto-destination")+'"]').first().get()}),i.children().detach(),i.empty().append(e))}(),function(){var e;i.find("li").length||(e=i.parents(".widget-ArticleJumpLinks")).length&&!e.find(".js-jumplink").length&&e.hide()}(),function(){var t=a(".tab-split-view-comments-pane");t.length&&a(".js-comments-jumplink .js-jumplink").on("click",function(e){e.preventDefault(),t.hasClass("active")||t.click()})}()),function(){var e,t;(n=a(".js-list-book-jumplinks")).length&&(e=n.find(".js-custom-section-jump-link"),t=n.find(".js-section-jump-link"),!e.length&&t.length||(e.each(function(){var e=a(this).data("targetid");a(e).length||a(this).hide()}),t.length||e.not(".hide").length||(e=n.parents(".js-section-jump-link-wrapper")).length&&e.hide(),l(),c()))}()}};function o(e){return e=e&&e.replace(/[.]/g,"\\.")}function s(e){var t,n;e.length&&(a(".pg_articlesplitview").length?(t=e,(n=a(".js-content-splitview")).length?n.animate({scrollTop:t.offset().top+n.scrollTop()-n.offsetParent().offset().top},r):a("html,body").animate({scrollTop:t.offset().top},r)):(e=e,!a(".toolbar-wrap").length||a(".toolbar-stuck").length?a("html,body").animate({scrollTop:e.offset().top-65},r):a("html,body").animate({scrollTop:e.offset().top-130},r)))}function l(){a("body").on("click",'a[href*="#"]:not([href="#"])',function(e){var t;location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname?(e.preventDefault(),t=o(t=a(this).data("scrollto")),(t=a("[data-legacyid="+t+"]")).length?s(t):(t=o(t=this.hash),s(a(t)))):a(this).hasClass("SupplementaryDataLink")&&(e.preventDefault(),window.location=a(this).attr("href"))})}function c(){a(".pg_ChapterStandard").length&&a(window).on("scroll",function(){var n=a(this).scrollTop();a(".book-chapter-body").length&&a("h2").each(function(){var e=a(this).offset().top,t=a(this).data("magellan-destination"),t=a('.section-jump-link a[href="#'+t+'"]');e-150<n&&a(t).length&&(a(".section-jump-link.active").removeClass("active"),a(t).closest(".section-jump-link").addClass("active"))})}),(a(".pg_Article").length||a(".pg_Issue").length||a(".pg_ConferenceVolume").length||a(".pg_proceeding").length)&&a(window).on("scroll",debounce(e,100))}function e(){var n=a(this).scrollTop();a(".articleClientType").each(function(){var e=a(this).offset().top,t=a(this).attr("id"),t=a('.section-jump-link__link-wrap a[href="#'+t+'"]');e-80<n&&(a(t).length&&a(".list-issue-jumplinks li").removeClass("active"),a(t).closest(".section-jump-link").addClass("active"))}),a(".article-body").length&&a("h2").each(function(){var e=a(this).offset().top,t=a(this).attr("id"),t=a('.section-jump-link__link-wrap a[href="#'+t+'"]');e-80<n&&(a(t).length&&a(".jumplink-list li, .jumplink-list-flyout li").removeClass("active"),a(t).closest(".section-jump-link").addClass("active"),a(".active-section").length&&a(".active-section").text(a(".section-jump-link.active a").text()))})}}(jQuery);var SCM=SCM||{};SCM.StickyElements=SCM.StickyElements||{},SCM.StickyElements=function(e){var t,n,a,i,r,o,s,l="",c=window.scrollY||window.pageYOffset,d=!1;return{init:function(){t=e("body"),i=e(".page-column--left"),r=e(".toolbar-wrap"),o=e(".page-column--left, .toolbar-wrap, .sr-filters, .article-browse-mobile-nav"),s=e("section.master-header").height(),t.hasClass("pg_article")&&(l="article",n=e(".article-browse-mobile-nav"));t.hasClass("pg_issue")&&(l="issue",a=e(".issue-browse-mobile-nav"));t.hasClass("pg_solr/searchresults")&&(l="search",$srFilters=e(".sr-filters"));window.addEventListener("scroll",u,!1),h()}};function u(){c=window.scrollY||window.pageYOffset,d||(requestAnimationFrame(h),d=!0)}function h(){d=!1,1023<SCM.SiteJS.getViewportWidth()&&"article"===l&&s-25<=c&&r.addClass("fixed"),s-25<=c?("article"===l&&(i.addClass("fixed"),n.addClass("fixed")),"search"===l&&SCM.SiteJS.getViewportWidth()<=1023&&$srFilters.addClass("fixed")):"article"!==l&&"search"!==l||o.removeClass("fixed"),s+175<=c&&"issue"===l?i.addClass("fixed"):"issue"===l&&i.removeClass("fixed"),s+190<=c&&"issue"===l?a.addClass("fixed"):"issue"===l&&a.removeClass("fixed")}}(jQuery);var SCM=SCM||{};!function(e,r){e.setAccessIcons=function(i){i=i||SCM.AccessIcons;var e=r("[data-resource-id-access]");e.length&&i&&e.each(function(e,t){var n=r(this),a=n.data("resourceIdAccess"),a=SCM.SiteJS.getAccessIcon(a,i);a&&(n=n.find(".js-access-icon-placeholder"),n.removeClass(function(e,t){return(t.match(/icon-availability_.+/g)||[]).join(" ")}),n.removeClass(a.icon).addClass(a.icon),n.attr("title",a.title))})},e.getAccessIcon=function(n,e){var a;return(e=e||SCM.AccessIcons).map(function(e,t){if(e.id===n)return a=e,!1}),a}}(SCM.SiteJS=SCM.SiteJS||{},jQuery);var SCM=SCM||{};!function(e,t){e.registerAnswerLinkClick=function(){t(".js-answer-link").on("click",function(){var e=t(this);e.next(".js-answer-wrap").toggleClass("hide"),e.find(".js-answer-show").toggleClass("hide"),e.find(".js-answer-hide").toggleClass("hide")})}}(SCM.ChapterAnswerSet=SCM.ChapterAnswerSet||{},jQuery);var SCM=SCM||{};!function(t){(SCM.PubHistory=SCM.PubHistory||{}).registerToggle=function(){t(document.body).on("click",".js-history-dropdown-trigger",function(e){e.stopPropagation(),t(".js-history-entries-wrap").toggleClass("expanded")}),t(document.body).on("click",function(e){t(e.target).parents(".js-history-dropdown-wrap").length||t(".js-history-entries-wrap").removeClass("expanded")})}}(jQuery);var SCM=SCM||{};!function(r,m){var o=m("body"),n=(m(".article-browse-mobile-nav"),m(".article-browse-mobile-nav-inner"),m(".search-wrap-filters")),t=!1,a=!1,s=!1,l=(m("#noAccessReveal"),m(".toolbar-wrap"),m(".toolbar-inner-wrap"),"Basic");m("#hfViewOption").val(),r.skipToMainContent=function(){m(".skipnav").on("click",function(){m("#skipNav").focus()})},r.globalNavDropdown=function(){m(".js-dropdown-trigger").on("click",function(e){m("body").addClass("on-canvas");var t=m(this).next(".js-dropdown");e.stopPropagation(),m("div, nav").not(t).removeClass("expanded"),t.toggleClass("expanded"),m(document.body).on("click",function(e){m(".js-dropdown").removeClass("expanded"),m("body").removeClass("on-canvas")})})},r.tabletMenuDropdown=function(){m(".js-tablet-menu-toggle").on("click",function(e){var t=m(this).closest(".tablet-menu-trigger_wrap").next(".tablet-menu");e.stopPropagation(),t.slideToggle("fast")})},r.mobileSiteMenuDropdown=function(){m(".js-mobile-site-menu-toggle").on("click",function(e){var t=m(this).next(".navbar-menu");e.stopPropagation(),t.slideToggle("fast"),m(document.body).on("click",function(e){t.is(":visible")&&m(t).css("display","none")})})},r.checkForJS=function(){m("html").removeClass("no-js")},r.detectIfIE=function(){var e,t,n=(e=window.navigator.userAgent,0<(t=e.indexOf("MSIE"))?parseInt(e.substring(t+5,e.indexOf(".",t))):navigator.userAgent.match(/trident/gi)?11:navigator.userAgent.match(/edge/gi)?13:0);0<n&&n<13?m("html").addClass("IE IE-"+n):12<n&&m("html").addClass("IE IE-Edge")},r.detectIfFirefox=function(){null==window.mozInnerScreenX||m("html").addClass("firefox")},r.closeModals=function(){m(document).on("click",".close-reveal-modal",function(){m(".reveal-modal").removeClass("open"),m("body").removeClass("on-canvas")}),m("body").on("click",function(e){m(e.target).is(".mobile-mask")&&(m(".reveal-modal").removeClass("open"),m("body").removeClass("on-canvas"))})},r.alignModalsVerically=function(){m(".reveal-modal").css("top","25vh")},r.setAllLinksTarget=function(){m('a:not([target="_blank"])').each(function(){var e;(e=this.href)&&(e.startsWith("http")||e.startsWith("/"))&&!e.startsWith("#")&&function(e){if(e.startsWith("/"))return!1;return!new RegExp("/"+window.location.host+"/").test(e)}(this.href)&&(this.target="_blank")})},r.getNewSelectedFilter=function(){var t=n.children("li");t.on("click",function(){var e=m(this);t.removeClass("selected"),e.addClass("selected"),SCM.SiteJS.setSelectedSearchFilter()})},r.initSelfServeNavigation=function(){var e=m('.widget-SelfServeContentNavigationMenu a[href="'+window.location.pathname+'"]');e.addClass("ss-currentPage"),e.parents("ul.selfserve-nav-menu-child-list").addClass("open"),e.parents("ul.selfserve-nav-menu-child-list").siblings("button.selfserve-subnav-toggle").removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")},r.toggleSelfServeNavigation=function(){m(".selfserve-subnav-toggle, .selfserve-parent-toggle").on("click",function(e){var t=m(this),n=m(this).siblings(".selfserve-sublist");e.preventDefault(),t.hasClass("icon-general-arrow-filled-right")?t.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"):t.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"),n.hasClass("open")?n.removeClass("open"):n.addClass("open")})},r.getViewportWidth=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},r.loadAllImagesIfUserIsAboutToUseJumpLinks=function(){m("#LeftNavSticker").hover(function(){m(".lazy").each(function(){var e=m(this);e.attr("src",e.attr("data-original"))})})},r.showAuthorInfo=function(){m(".js-linked-name").on("click",function(e){var t=m(this).siblings(".al-author-info-wrap");e.stopPropagation(),m(".al-author-info-wrap").not(t).removeClass("open"),m(t).toggleClass("open"),m("body").addClass("leftRailModalOpen")})},r.hideAuthorInfo=function(){m(document.body).on("click",function(e){m(e.target).parents(".al-author-info-wrap").length||(m(".al-author-info-wrap").removeClass("open"),m("body").removeClass("leftRailModalOpen"))})},r.showArticleMetadata=function(){m(".js-expand-collapse-metadata").on("click",function(e){m(".js-author-expand-collapse-metadata-wrap").toggleClass("active"),m(".js-metadata-toggle-icon").toggleClass("icon-general-add"),m(".js-metadata-toggle-icon").toggleClass("icon-general_minus")})},r.addAuthorFootnote=function(){m(".al-author-name").each(function(){var e=m(this).find(".info-card-note .xref-fn");e.length&&"*"===e.text()&&(m("<sup/>").append(e.html()).insertAfter(m(this).find(".linked-name")),e.remove()),m(this).find(".info-author-correspondence").length&&m(this).find(".linked-name").append('<i class="icon-corresponding_author"></i>')})},r.showHideDropDown=function(){m(".selectDropdown").on("click",function(e){m(".dropdown").hide().removeClass("open"),e.stopPropagation(),m(this).siblings(".dropdown").slideToggle("300","linear").toggleClass("open")}),m(document).click(function(){m(".dropdown").hide().removeClass("open")})},r.showMoreRelatedContent=function(e,t){m(e).click(function(){var e=m(this);e.closest(".related-section-box, .widget-RelatedBookContent").find(t).toggleClass("show-item"),e.toggleClass("show-less").find("i").toggleClass("icon-show").toggleClass("icon-hide"),e.hasClass("show-less")?e.find("span").text("See Less"):e.find("span").text("See More")})},r.showRelatedBookWidgetIfHasContent=function(){m(".widget-RelatedBookContent").each(function(){var e=m(this);5<e.find("*").length&&e.addClass("show")})},r.showSpinner=function(){m(".pagination, .querybuilder-submit").on("click",function(){m(".preloader-wrap").removeClass("hide").addClass("active")})},r.setSelectedSearchFilter=function(){var e=n.children(".selected").text();m(".selected-text").text(e)},r.initFilterClickEvent=function(){m(".filter-wrap").on("click",function(e){n.hide(),e.stopPropagation(),n.toggle()}),m(document).click(function(){n.hide()})},r.isLoggedIn=function(){return 0<App.LoginUserInfo.isIndividualLoggedIn},r.toggleSearchCover=function(){m(".sf-facet").length&&m(".sf-facet").click(function(){m(document).ajaxStart(function(){m(".info-inner-cover").removeClass("uncovered"),m(".info-inner-cover").addClass("covered")}),m(document).ajaxComplete(function(){m(".info-inner-cover").removeClass("covered"),m(".info-inner-cover").addClass("uncovered")})})},r.calculateResetState=function(e){t=!!e,SCM.SiteJS.resetMobileSiteNav(t)},r.toggleMobileLanguageSubmenu=function(){m(".mobile-header-language").on("click",function(){m(".mobile-language-submenu").slideToggle()})},r.toggleMobileSiteMenuSubnav=function(){m("div.dropdown-menu ul.site-menu li.site-menu-item").on("click",function(){var e=m(this),t=e.children(".mobile-nav-arrow");e.children("ul.site-menu").slideToggle(),t.hasClass("icon-general_arrow-right")?t.removeClass("icon-general_arrow-right").addClass("icon-general_arrow-down"):t.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")})},r.toggleMobileSignInForm=function(){var e=m(".mobile-login"),t=m(".mobile-signin-nav-arrow");m(".mobile-menu-link-wrap").on("click",function(){e.hasClass("open")||(e.addClass("open").slideToggle(),t.hide())}),m(".site-menu .mobile-login-form").on("click",".mobile-login-icon",function(){e.removeClass("open").slideToggle(),t.show()})},r.resetMobileSearchFilters=function(){m(".sf-facets, .sf-facet-list").removeAttr("style"),m(".sf-group-header-icon").removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")},r.resetMobileSiteNav=function(e){m(".header-bottom, .navigation, #MicrositeSearch, .arrow-nav, .arrow-search, .mobile-language-submenu").removeAttr("style"),m(".mobile-search-toggle, .mobile-menu-toggle, .arrow-nav, .arrow-search").removeClass("active"),m("#MicrositeSearch").removeClass("active-tablet"),e&&(s=a=!1)},r.mobileSearchDropdown=function(){m(".js-mobile-search_toggle").click(function(e){m(this);var t=m(this).closest(".mobile-menu-trigger_wrap").next(".js-mobile-search-dropdown");e.stopPropagation(),m("div, nav").not(t).removeClass("expanded"),t.toggleClass("expanded"),t.slideToggle("fast")})},r.toggleResponsiveLeftColumn=function(){m(document.body).removeClass("noscroll"),m(".js-main").on("click",".toggle-left-col__search, .toggle-left-col__article",function(e){e.preventDefault(),m(document.body).addClass("noscroll"),m(".page-column--left").show(),m(document).ajaxComplete(function(){m(document.body).removeClass("noscroll")})}),m(".toggle-left-col__close").on("click",function(e){e.preventDefault(),m(document.body).removeClass("noscroll"),m(".page-column--left").removeAttr("style")})},r.toggleMobileMenu=function(){m(".mobile-menu-toggle").on("click",function(){SCM.SiteJS.calculateResetState(s,a),a=!1===a,SCM.SiteJS.toggleResponsiveMenus(m(".mobile-menu-toggle, .arrow-nav"),a,m(".navigation"))})},r.toggleResponsiveMenus=function(e,t,n){var a=m(".header-bottom");t?(e.addClass("active"),n.show(),a.slideToggle()):(e.removeClass("active"),a.toggle(),n.delay(50).hide())},r.initDatePicker=function(){m(".pg_advancedsearch").length&&(m("#startDateAuthor").length||m("#startDateSemanticSearch").length)&&m("#startDateAuthor, #endDateAuthor, #startDateSemanticSearch, #endDateSemanticSearch").datepicker()},r.showFullAuthorList=function(){var t=m(".meta-authors--etal"),n=m(".meta-authors--remaining");t.on("click",function(e){e.preventDefault(),t.removeClass("is-active"),t.attr("aria-hidden",!0),n.addClass("is-active"),n.attr("aria-hidden",!1)})},r.showImages=function(e){e.find(".contentFigures").each(function(){var e=m(this);0<=e.attr("src").toLowerCase().indexOf("grey.gif")&&e.attr("src",e.attr("data-original"))})},r.openRevealModal=function(e){m(".reveal-modal").removeClass("open");var t=m("#revealModal");t.find("#revealContent").empty().prepend(e.clone()),t.closest(".reveal-modal").addClass("open"),t.length&&SCM.SiteJS.removeDuplicateFootnotes(t),SCM.SiteJS.showImages(t),SCM.SiteJS.restrictedImages()},r.processFigGroup=function(e,t){m(".reveal-modal").removeClass("open");e=m('[reveal-group-id~="'+e+'"]');e.length&&t.length&&(t.children().length||e.length&&e.each(function(){t.append(m(this).clone().removeClass("hide"))}),m("body").addClass("on-canvas"),t.addClass("open"),SCM.SiteJS.showImages(t),SCM.SiteJS.restrictedImages())},r.processNonFigGroup=function(e,t){var n,a=m('#main [content-id~="'+e+'" i]');!e.length||a.length||(n=e.split(" ")).length&&(a=0<(n=r.getAllReferencesInRange(n)).html().length?n:""),m(a).hasClass("video-modal")||m(a).hasClass("audio-modal")?SCM.Utilities.Reveal.open(a):(e=m('.reveal-modal[content-id="'+e+'"]')).length?SCM.Utilities.Reveal.open(e):a.length?SCM.SiteJS.openRevealModal(a):SCM.Utilities.Reveal.open(t)},r.removeDuplicateFootnotes=function(e){var t={},e=e.children("#revealContent").children(".fn");m(e).each(function(){var e=m(this).text();t[e]?m(this).remove():t[e]=!0})},r.revealFigsTablesInModal=function(){var n=m("#NeedSubscription");o.on("click",".xref-fn, .link-reveal, .table-graphic, .caption-title",function(){var e,t=m(this);rightPaneItem=t.hasClass("xref-bibr"),0<m(".pg_articlesplitview").length&&rightPaneItem||(e=t.attr("reveal-id")?t.attr("reveal-id"):t.attr("data-reveal-id")?t.attr("data-reveal-id"):t.attr("data-id"),(t=m('#main div[reveal-group-container-id="'+e+'" i]')).length?SCM.SiteJS.processFigGroup(e,t):SCM.SiteJS.processNonFigGroup(e,n))})},r.getAllReferencesInRange=function(e){var t,n=m("<div/>");return e.forEach(function(e){(t=m('[content-id="'+e+'"]').first()).length||(t=m('[content-id="'+e.toLowerCase()+'"]').first()),n.append(t.children().clone())}),n},r.showUnAuthenticatedSpans=function(){m(document).ready(function(){var e=m('div[data-widgetname="ArticleFulltext"] span#UserHasAccess').attr("data-userHasAccess");e&&e.length&&"false"===e.toLowerCase()&&m('div[data-widgetname="ArticleFulltext"] a[data-reveal-id]').each(function(){m(this).replaceWith(function(){return"<span>"+this.innerHTML+"</span>"})})})},r.siteThemeHeaderDropdowns=function(){m(".mobile-search-toggle").on("click",function(e){e.preventDefault();e=m(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-search-dropdown")}),m(".mobile-account-toggle").on("click",function(e){e.preventDefault();e=m(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-account-dropdown")}),m(".mobile-nav-toggle").on("click",function(e){e.preventDefault();e=m(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-nav-dropdown")})},r.manageMobileDropdowns=function(e,t){m(".dropdown-panel").hasClass("is-active")?e.hasClass("is-active")?(m(t).slideToggle().removeClass("is-active"),e.removeClass("is-active")):(m(".mobile-dropdown-toggle").removeClass("is-active"),m(".dropdown-panel-wrap").children(".is-active").slideToggle().removeClass("is-active"),e.addClass("is-active"),m(t).delay(400).slideToggle().addClass("is-active")):(e.addClass("is-active"),m(t).slideToggle().addClass("is-active"))};var c=!(r.toggleMobileDropdownSubnav=function(){m(".dummy-link, .mobile-nav-dropdown .site-menu-item .mobile-nav-arrow, .mobile-account-dropdown .site-menu-item .mobile-nav-arrow").on("click",function(e){e.preventDefault();var t=m(this),e=t,e=t.hasClass("mobile-nav-arrow")?t:t.siblings(".mobile-nav-arrow");t.siblings(".site-menu-lvl-1").slideToggle(),e.hasClass("icon-general_arrow-down")?e.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-up"):e.removeClass("icon-general_arrow-up").addClass("icon-general_arrow-down")})});function e(){var e=m(".js-fpp-wrap");return e.length&&(e.data("fppReferredEnabled")&&function(e){if(!e)return;var t=m("<a>",{href:document.referrer}).prop("hostname");return t&&0<t.indexOf(e)}(e.data("fppReferredDomain")))}r.loadSignInForm=function(){var t=m(".mobile-account-dropdown ul li ul"),n=m(".dropdown-panel-signin"),a=m("#sign-in-page"),e=SCM.SiteJS.getDefaultReturnUrl();c||(e=(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/SignIn/LoginForm/LoginFormPopup?returnUrl="+encodeURIComponent(e),SCM.Ajax.get(e).expectHtml().then(function(e){n.html(e),t.html(e),a.html(e),SCM.AddReturnUrlToSocietyLinks(),c=!0}).catch(function(e){console.error("Failed to load sign-in form: "+e)}))},r.initSigninForm=function(){var t=m(".mobile-account-dropdown ul li .mobile-account-signin"),n=m(".mobile-account-dropdown ul li i.mobile-nav-arrow"),a=(m(".mobile-account-dropdown ul li ul"),m(".dropdown-panel-signin")),i=m(".dropdown-panel-institution");m(".site-theme-header-menu-item .dropdown-toggle.signin").on("click",function(e){e.preventDefault(),a.hasClass("active")?m(".dropdown-panel-signin").hide().removeClass("active"):m(".dropdown-panel-signin").show().addClass("active"),r.loadSignInForm()}),m(".dropdown-toggle.institution").on("click",function(e){e.preventDefault(),i.hasClass("active")?i.hide().removeClass("active"):i.show().addClass("active")}),m(document).on("mouseup",function(e){var t=m(".dropdown-panel-signin, .dropdown-panel-institution");m(t).is(e.target)||0!==m(t).has(e.target).length||m(t).hide()}),t.on("click",function(e){e.preventDefault(),r.loadSignInForm(),n.hasClass("icon-general_arrow-down")?n.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-up"):n.removeClass("icon-general_arrow-up").addClass("icon-general_arrow-down"),t.hasClass("active")?t.removeClass("active"):t.addClass("active")}),m(document.body).on("click",".signin-form .signin-button",function(e){var t=m(this).closest(".signin-form"),n=t.find(".preloader-wrap");e.preventDefault(),e.stopPropagation(),SCM.SiteJS.Login(t,n)}),m(document).on("keypress",".signin-form input.username, .signin-form input.password",function(e){var t=m(this).closest(".signin-form"),n=t.find(".preloader-wrap");13===(e.keyCode||e.which)&&(e.preventDefault(),SCM.SiteJS.Login(t,n))}),m(document).on("click",".signout-button",function(e){e.preventDefault();var t="/LogoutHandler.ashx",e=e.target.attributes["logout-type"];e&&(t+="?logoutType="+e.value),window.top.location.assign(t)}),m(document).on("click","a.institutional-login-link",function(e){e.preventDefault();var t=m(this).attr("href"),e=t.toLowerCase();0<e.indexOf("returnurl=")||0<=window.top.location.href.toLowerCase().indexOf(e)||(null==(e=m.deparam.querystring().returnUrl)&&(e=window.top.location.href),e&&0<e.length&&(t=m.param.querystring(t,"returnUrl="+encodeURIComponent(e)))),window.top.location.assign(t)}),m(document).on("click","a.shibboleth-signin",function(e){var t=window.top.location,t=t.origin+"/SHIBBOLETH?dest="+encodeURIComponent(t.pathname+t.search),t=m(this).data("target").replace("{0}",encodeURIComponent(t));window.top.location=t})},r.initLoginFormDropdown=function(){m(".signin-form").on("click",'a[data-target="register"]',function(e){e.preventDefault();e=m.deparam.querystring().returnUrl;null==e&&(e=location.pathname+location.search),window.top.location.assign("/my-account/register?returnUrl="+encodeURIComponent(e))})},r.Login=function(t,e){var n=t.find("input.username").val(),a=t.find("input.password").val();0!==n.length&&0!==a.length?(e.removeClass("hide"),m(".error, .no-permission").hide(),SCM.Ajax.post("/LoginHandler.ashx",{user:n,pass:a}).expectText().expect("Username / password incorrect",function(e){return"0"!==e}).expect(function(e){return"1"===e||"2"===e}).then(function(e){"1"===e?SCM.SiteJS.loginReturnBack():"2"===e&&t.find(".no-permission").show()}).catch(function(e){console.error("Login failure: "+e),t.find(".error").show()}).finally(function(){e.addClass("hide")})):t.find(".error").show()},r.loginReturnBack=function(){var e=SCM.SiteJS.getDefaultReturnUrl();/^\/((\w+\/)?sign-in|my-account\/forgot-password|my-account\/reset-password|my-account\/register|institutional-login)/i.test(e)&&(e="/");var t=m("body");(t.hasClass("pg_error")||t.hasClass("pg_error404"))&&(e="/"),"/"===e||null!==(t=e.match(/\/\/([^/]+\.)?([^./]+\.[^./]+)/i))&&t[2].toLowerCase()!==window.top.location.hostname.match(/(.*\.)?([^.]+\.[^.]+)/i)[2].toLowerCase()&&(e="/"),window.top.location.assign(e)},r.getDefaultReturnUrl=function(){var e=m.deparam.querystring(!0).returnUrl;return null!=(e=e&&decodeURIComponent(e))&&0!==e.length||(e=m.deparam.querystring().redirectUrl),null!=e&&0!==e.length||(e=SCM.SiteJS.getCanonicalUrl()),null!=e&&0!==e.length||(e=window.top.location.pathname+window.top.location.search),e},r.getCanonicalUrl=function(){var e=m("link[rel='canonical']").attr("href");return null==e||0===e.length?"":e},r.contactUsSubmit=function(){m(".widget-contact-us #btnSubmit").on("click",function(){var i=m(".widget-contact-us"),e=i.find("#FirstName").val(),t=i.find("#LastName").val(),n=i.find("#EmailAddress").val(),a=i.find("#Subject").val(),r=i.find("#IsLibrarian").prop("checked"),o=i.find("#IsMember").prop("checked"),s=i.find("#Reason").val(),l=i.find("#Journal").val(),c=i.find("#Comment").val(),d=i.find("#g-recaptcha-response").val(),u=i.find("#CustomerNumber").val(),h=i.find("#AccessMethod").val(),p=i.find("#OperatingSystem").val(),f=i.find("#BugDescription").val(),f=JSON.stringify({FirstName:e,LastName:t,EmailAddress:n,Subject:a,IsLibrarian:r,Reason:s,Journal:l,Comment:c,CaptchaResponse:d,IsMember:o,CustomerNumber:u,AccessMethod:h,OperatingSystem:p,BugDescription:f});m.ajax({type:"POST",url:"/Common/ContactUsForm",data:f,success:function(e){var t,n,a;e.Success?(t=i.find(".message-success"),n=m("<div/>"),m.each(e.Messages,function(e,t){n.append(t)}),i.find(".widget-contact-us-form").hide(),t.html(n.html()).show()):void 0!==e.Messages&&e.Messages.length&&(a=m("<ul></ul>"),m.each(e.Messages,function(e,t){a.append("<li>"+t+"</li>")}),i.find(".error-message").html(a).show())},contentType:"application/json"})})},r.alertLinks=function(){function a(e){return e.parent().hasClass("alertType-MarketingLink")}function i(e){return e.data("additionalurl")}m("body").on("click",".userAlert a",function(e){var t,n=m(this);e.preventDefault(),SCM.SiteJS.isLoggedIn(n)?a(n)?(t=n,window.location=i(t)):SCM.SiteJS.showSignUpAlertInfo(n):(t=SCM.SiteJS.getDefaultReturnUrl(),t=a(n)?i(n):function(e,t){e=e.data("alerttype");void 0!==e&&(t=t+"#trigger-alerttype="+e);return t}(n,t),window.location="/sign-in?returnUrl="+encodeURIComponent(t))})},r.showSignUpAlertInfo=function(n){m.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Toolbox/AlertsSignUp/AlertsSignUpPopup",cache:!1,data:{alertType:n.data("alerttype"),resourceId:n.data("alertresourceid"),resourceType:n.data("alertresourcetype"),email:n.data("alertuseremail"),resourceName:n.data("alertresourcename")},dataType:"html",success:function(e){m(".userAlertSignUp").html(e);var t=m(".userAlertSignUpModal");SCM.Utilities.Reveal.open(t),m(".addUserAlert").on("click",function(){var e=!!m(this).data("hasmultipleschedules"),t=SCM.SiteJS.buildAlertSignUpData(n,e);SCM.SiteJS.addSignUpAlert(t,e)}),m(".userAlertClose").on("click",function(){SCM.Utilities.Reveal.close(t)})}})},r.buildAlertSignUpData=function(e,t){var n={};return n.alertType=e.data("alerttype"),n.resourceId=e.data("alertresourceid"),n.resourceType=e.data("alertresourcetype"),n.email=e.data("alertuseremail"),n.resourceName=e.data("alertresourcename"),e.data("scheduleid")&&(n.scheduleId=e.data("scheduleid")),t&&(n.scheduleId=m(".js-new-useralert-select").val()),n},r.addSignUpAlert=function(e,t){t=t?"/Toolbox/AddAlertsSignUpWithSchedule/AddAlertsSignUpPopup":"/Toolbox/AddAlertsSignUp/AddAlertsSignUpPopup";m.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+t,cache:!1,data:e,dataType:"html",success:function(e){m(".userAlertSignUp").html(e);var t=m(".userAlertSignUpModal");SCM.Utilities.Reveal.open(t),m(".userAlertClose").on("click",function(){SCM.Utilities.Reveal.close(t)})}})},r.triggerAlertModalOnRedirect=function(){var e=m.bbq.getState("trigger-alerttype");void 0!==e&&(m('.userAlert a[data-userloggedin="True"][data-alerttype='+e+"]").click(),m.bbq.removeState("trigger-alerttype"))},r.triggerSaveSearchModelOnRedirect=function(){"1"===m.bbq.getState("triggerSaveSearch")&&(m(".lnkSaveSolrSearch").click(),m.bbq.removeState("triggerSaveSearch"))},r.initSearchResultsSort=function(){var e,t,n;m(".widget-SolrSearch").length&&(e=m(".sort-order-select-option"),t=m(".sort-order-select"),n=m(".preloader-wrap"),t.on("change",function(){var e=m(this).val();SCM.SearchResults.doSolrSearch({queryString:e,source:"searchresults"})}),e.on("click",function(){m(this).find("option[value]").length&&n.removeClass("hide"),sessionStorage.detailsState=l}))},r.initSearchResultsPagination=function(){m(".widget-SolrSearch").length&&m(document.body).on("click",".al-pageNumber,.sr-nav-previous,.sr-nav-next",function(){var e;m(this).hasClass("currentPage")||(m(".preloader-wrap").removeClass("hide"),e=m(this).attr("data-url"),SCM.SearchResults.doSolrSearch({queryString:e}))})},r.restrictedImages=function(){m("a.fig-link[restricted]").each(function(){var e=m(this).parent("div.graphic-wrap"),t=m(e).children(".copy-right-statement");e.attr("restricted",""),e.off("contextmenu").on("contextmenu",function(){return m(t).toggle(),!1}),m(this).click(function(){return m(t).toggle(),!1}),m(t).click(function(){return m(t).toggle(),!1})})},r.registerArticleListNewAndPopularCombinedMode=function(){m(".articleListNewAndPopular-mode").each(function(){var a=m(this);a.on("click",function(e){e.preventDefault(),m(".articleListNewAndPopular-mode").removeClass("active"),a.addClass("active");var t=a.data("mode"),n=m(".articleListNewAndPopular-ContentView-"+t),e=a.data("instancename");n.hasClass("hasContent")||(SCM.SiteJS.getArticleListNewAndPopularContent(t,n,e),n.addClass("hasContent")),m('section[class*="articleListNewAndPopular-ContentView-"]').hide(),n.removeClass("hide"),n.show()})})},r.getArticleListNewAndPopularContent=function(e,t,n){m.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/PlatformArticle/ArticleListNewAndPopularContent/"+n,cache:!1,data:{mode:e},dataType:"html",success:function(e){t.html(e)}})},r.moveSubmitCommentLink=function(){var e=m(".submitCommentPlaceHolder"),t=m(".widget-UserComment");e.append(t)},r.addUserCommentJumpLink=function(){var e,t=m(".content-nav");t.length&&(e=m(".comments-jumplink"),t.append(e))},r.moveCompetingInterestsSection=function(){m(".references-title").length?m(".coi-statement-section-wrapper").insertBefore(".references-title"):m(".backreferences-title").length?m(".coi-statement-section-wrapper").insertBefore(".backreferences-title"):m(".acknowledgements-title").length?m(".coi-statement-section-wrapper").insertAfter(".acknowledgements-title"):m(".backacknowledgements-title").length&&m(".coi-statement-section-wrapper").insertAfter(".backacknowledgements-title")},r.toggleSearchResultsDetails=function(){var t=m("#switch-container"),n=m("#switch-post"),a=m(".sri-expandedView");"Expanded"===(l=sessionStorage.detailsState||("undefined"!=typeof clientViewOption&&""!==clientViewOption?clientViewOption:m("#hfViewOption").val()))?(t.removeClass("off").addClass("on"),n.removeClass("off").addClass("on"),a.removeClass("hide")):"Basic"===l&&a.addClass("hide"),m(".pagination").on("click",function(){sessionStorage.detailsState=l}),t.off("click").on("click",function(e){e.stopPropagation(),l="Expanded"===l?"Basic":"Expanded",t.toggleClass("on off"),n.toggleClass("on off"),a.hasClass("hide")?a.removeClass("hide"):a.addClass("hide")})},r.adjustRelatedTagsDisplay=function(){m(".article-metadata-panel:not(:last)").remove();var e=m(".article-metadata-panel").last(),t=[m(".kwd-group"),m(".related-topic-tags"),m(".article-metadata-taxonomies"),m(".article-metadata-tocSections")];for(0===e.length&&(e=m(".article-metadata-standalone-panel")),i=0;i<t.length;i++)t[i].length&&e.append(t[i]);e.html()&&e.show()},r.showPdfOnlyLink=function(){m(".PdfOnlyLink").length&&m(".toolbar-item.item-pdf").length&&m(".toolbar-item.item-pdf").children().clone().appendTo(".PdfOnlyLink")},r.ariaToggleTable=function(t){var n=m(t+"-button"),a=n.children(".collapse-icon");n.on("click",function(e){e.preventDefault(),"true"===n.attr("aria-expanded")?n.attr("aria-expanded","false"):n.attr("aria-expanded","true"),a.hasClass("icon-general-arrow-filled-down")?a.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"):a.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"),m(t).toggleClass("hide"),"false"===m(t).attr("aria-hidden")?m(t).attr("aria-hidden","true"):m(t).attr("aria-hidden","false")})},r.initAriaControls=function(){m("[id^=collapsible-table-]").each(function(e){SCM.SiteJS.ariaToggleTable("#collapsible-table-"+e)})},r.abstractMathJax=function(){m(".abstract-response-placeholder").length&&MathJax.Hub&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,".abstract-response-placeholder"])},r.initializeArticlePdfLinks=function(){var e=m("#ArticleList h5.item-title");function i(e){e.off("click")}null!==e&&e.each(function(e,t){var n=m(this),a=n.parent().find(".article-pdfLink");null!==a&&(function(e){e=e.data("resourceIdAccess");if(SCM.AccessIcons&&e){e=SCM.SiteJS.getAccessIcon(e,SCM.AccessIcons);return e&&"icon-availability_cart"!==e.icon}return!1}(n)||SCM.SiteJS.isLoggedIn()?function(e){i(e);var t=App.SiteURL+"HTTPHandlers/ArticlePdfHandler.ashx",n=e.data("journal"),a=e.data("pdf-id");null!==a&&null!==n&&e.on("click",function(e){e.preventDefault(),window.open(t+"?journal="+n+"&multimediaId="+a,"_blank")})}:function(e){i(e);var t=SCM.SiteJS.getDefaultReturnUrl();e.on("click",function(e){e.preventDefault(),window.location="/sign-in?returnUrl="+encodeURIComponent(t)})})(a)})},r.triggerFppOnRedirect=function(){e()&&m(".firstPagePreviewImage").click()},r.articleUserComments=function(){var r=m(".comment-form__modal .preloader-wrap"),o=m(".content-form__response--error");m("#comment-modal-opener").click(function(e){e.preventDefault(),"True"!==SCM.UserCommentView.isUserLoggedIn?(e=SCM.UserCommentView.divId,SCM.Utilities.Reveal.open(m("#"+e))):(resetCommentForm(),SCM.Utilities.Reveal.open(m("#divCommentModal")))}),m("#divCommentModal .btnUserCommentSubmit").click(function(e){e.preventDefault(),validateCommentForm()&&(r.removeClass("hide"),submitCommentValues())}),m("#divCommentModal .btnModalCancel, #divCommentModal .btnCommentModalExit, .comment-form__close").click(function(e){e.preventDefault(),SCM.Utilities.Reveal.close(m("#divCommentModal"))}),m('input[name="NoConflicts"]').change(function(){m(this).is(":checked")?m(".disclosureBox").show():m(".disclosureBox").hide()}),validateCommentForm=function(){var e=!1;resetCommentFormValidation(),m.validity.setup({outputMode:"label"}),m.validity.start(),m("#divCommentModal .required").require();var t=m.validity.end(),n=m("#divUserCommentForm").find("textarea#Comment"),a=n.val(),n=parseInt(n.attr("maxlength"));return 0<n&&a.length>n&&(a=a.substring(0,n)),!(e="true"===SCM.UserCommentView.bShowDisclosure&&m('input[name="NoConflicts"]').is(":checked")&&""===m('textarea[name="Disclosure"]').val()?(m("#divCommentModal .lbldisclosure.errors").show(),!1):t.valid)||(t=m("#divUserCommentForm input#termsAndConditions")).length&&!t.is(":checked")&&(m("#divUserCommentForm .lblTermsAndConditions.errors").show(),e=!1),e},resetCommentForm=function(){m("#divUserCommentForm").show();var e=m("#divCommentModal");e.find("input, textarea").val(""),e.find("#displayAlert, div.captchaAlert").hide(),m('input[name="NoConflicts"]').prop("checked",!1),m('input[name="termsAndConditions"]').prop("checked",!1),m(".disclosureBox").hide(),m("#divCommentModal .btnCommentModalExit").hide(),m("#recaptcha_reload").trigger("click");e=e.find("#Author");e.attr("value",e.attr("dataauthorvalue")),resetCommentFormValidation()},resetCommentFormValidation=function(){var e=m("#divCommentModal");e.find(".error").not(".lbldisclosure.errors").remove(),e.find(".lbldisclosure.errors").hide(),m("#divUserCommentForm .lblTermsAndConditions.errors").hide(),o.text("")},submitCommentValues=function(){var t=m("#divUserCommentForm"),e=SCM.UserCommentView.resourceType,n=SCM.UserCommentView.resourceId,a="",i="";"true"===SCM.UserCommentView.showAffiliations&&(a=t.find("input#AffInstitution").val()),"true"===SCM.UserCommentView.bShowDisclosure&&(i=t.find("textarea#Disclosure").val()),m.ajax({type:"POST",url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Content/SubmitUserComment",data:{author:t.find("input#Author").val(),affInstitutions:a,disclosure:i,title:t.find("input#Title").val(),comment:t.find("textarea#Comment").val(),resourceType:e,resourceId:n,recaptchaChallege:m("#recaptcha_challenge_field").val(),recaptchaResponse:m("#recaptcha_response_field").val()},success:function(e){r.addClass("hide"),!0===e.Success?(t.hide(),m("#divCommentModal #displayAlert").show(),m("#divCommentModal .btnCommentModalExit").show(),"true"===SCM.UserCommentView.isNotModerated.toLowerCase()&&location.reload()):(r.addClass("hide"),m("div.captchaAlert").show())},error:function(e){r.addClass("hide"),o.html("Comments not saved. Please Try Again.")}})}},r.conferenceVolumeSelector=function(){var e=m(".master-main");e.on("change",".js-volume-browse-select, .js-volume-browse-conference-select",function(){window.location.href=m(this).val()}),e.on("change",".js-volume-browse-year-select",function(){var e=m(this).val();getLatestConferenceVolumeByYear(e,!1)}),e.on("change",".js-volume-browse-decade-select",function(){var e=m(this).val();getLatestConferenceVolumeByYear(e,!0)}),getLatestConferenceVolumeByYear=function(e,t){var n="//"+m("#hfSiteURL").val()+"/ConferenceVolume/ConferenceVolumeLatestByYear";m.ajax({url:n,type:"GET",data:{year:e,isDecade:t}}).done(function(e){e&&e.RedirectUrl&&0<e.RedirectUrl.length?window.location=e.RedirectUrl:window.console&&console.log("ConferenceVolumeLatestByYear returned no data.")}).fail(function(e,t,n){window.console&&(console.log("error: "+e.responseText),console.log("status: "+t))})}},r.modalManager=function(){for(var e in modalArray={".js-open-saveSearch-modal":".solrSearchSaveModel",".js-add-edit-trigger":"#journalAddEditDiv",'.js-open-alert-modal[data-userloggedin="True"]':".userAlertSignUpModal",'[data-reveal-id="addArticleUpdateAlert"]':"#AddAlert",'[data-reveal-id="emailUsernameModal"]':"#emailUserName",".firstPagePreviewImage":"#divFirstPagePreview",'[data-reveal-id="getCitations"]':"#getCitations"},addOnClickBehavior=function(t,n){m(document.body).on("click",t,function(){var e=m(t).data("userloggedin");".js-open-saveSearch-modal"===t&&e||".js-open-saveSearch-modal"===t&&"false"===e.toLowerCase()||(m(n).closest(".reveal-modal").addClass("open"),m(document.body).addClass("on-canvas"))})},modalArray)addOnClickBehavior(e,modalArray[e])},r.stickySidebar=function(){m(".can-stick").length&&m(window).on("scroll",function(){var e;899<m(window).width()?m(this).scrollTop()<m(".page-column--left").offset().top-65?m(".info-inner-wrap").removeClass("menu-stuck").addClass("menu-not-stuck"):m(".info-inner-wrap").removeClass("menu-not-stuck").addClass("menu-stuck"):m(".info-inner-wrap").removeClass("menu-not-stuck").removeClass("menu-stuck"),m(".menu-stuck").length?(e=m(".info-inner-wrap").height(),m(window).height()<e&&m(".info-inner-wrap").addClass("im-too-tall")):m(".info-inner-wrap").removeClass("im-too-tall")})},r.ckbSelectAll=function(){m(document.body).on("click",".js-ckbCheckAll",function(){var e=m(this),n=e.prop("checked");e.parents(".js-chkbParent").siblings().find('input[type="checkbox"]').each(function(e,t){t=m(t);t.prop("checked")!==n&&t.prop("checked",n).trigger("change")})})},r.unStickSidebar=function(){899<m(window).width()&&(m.fn.is_on_screen=function(){var e=m(window),t={top:e.scrollTop(),left:e.scrollLeft()};t.right=t.left+e.width(),t.bottom=t.top+e.height();e=this.offset();return e.right=e.left+this.outerWidth(),e.bottom=e.top+this.outerHeight(),!(t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)},m(window).on("scroll",function(){var e=m(".info-inner-wrap").height(),t=m(".footer_wrap").offset().top-65-m(window).scrollTop();0<m(".footer_wrap").length&&(m(".footer_wrap").is_on_screen()?(t<e&&m(".info-inner-wrap").addClass("menu-bottomed-out"),e<t&&m(".info-inner-wrap").removeClass("menu-bottomed-out")):m(".info-inner-wrap").removeClass("menu-bottomed-out"))}))},r.stickyToolbar=function(){m(".page-column--left").length&&m(".toolbar-wrap").length&&m(window).on("scroll",function(){899<m(window).width()&&(m(this).scrollTop()<m(".page-column--left").offset().top-65?(m(".toolbar-wrap").removeClass("toolbar-stuck"),m(".site-theme-header").find(".navbar-search-container").removeClass("hide")):(m(".toolbar-wrap").addClass("toolbar-stuck"),m(".site-theme-header").find(".navbar-search-container").addClass("hide")))})},r.checkForEmptyArticleLeftNav=function(){var e,t,n;m(".pg_Article").length&&(e=m(".pg_Article .info-widget-wrap > div"),t=m(".pg_Article .info-widget-wrap").closest(".info-inner-wrap"),n=m(".article-browse-top.article-browse-mobile-nav"),0<e.length&&(t.removeClass("empty"),n.removeClass("empty")))},r.mobileNav=function(){var t=m(".myaccount-tabs-inner-wrap"),n=m(".mobile-nav-icon");m(document).on("click",".myaccount-mobile-nav",function(e){e.stopPropagation(),t.toggle(),n.hasClass("icon-general-arrow-filled-down")?n.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-up"):n.removeClass("icon-general-arrow-filled-up").addClass("icon-general-arrow-filled-down")}),m(document).click(function(){t.hide().removeAttr("style")})},r.toggleSupplementalTablesAndFigures=function(){function n(e){var t=e.find(".js-expand-view"),e=e.find(".js-collapse-view");t.hasClass("supplemental-material-collapsed")?(t.removeClass("supplemental-material-collapsed"),e.addClass("supplemental-material-collapsed")):(t.addClass("supplemental-material-collapsed"),e.removeClass("supplemental-material-collapsed"))}function a(e){e.hasClass("supplemental-material-collapsed")?e.removeClass("supplemental-material-collapsed"):e.addClass("supplemental-material-collapsed")}m(".js-supplemental-figure-toggle").on("click",function(e){e.preventDefault();var t=m(e.currentTarget),e=t.attr("data-id");a(m(".js-supplemental-figure-graphic-wrap[data-id='"+e+"']").first()),n(t)}),m(".js-supplemental-table-toggle").on("click",function(e){e.preventDefault();var t=m(e.currentTarget),e=t.attr("data-id");a(m('.js-supplemental-table-graphic-wrap[data-id="'+e+'"]')),n(t)})},r.init=function(){function a(e){return e&&"[XSLTSectionID]"!==e}var e;r.checkForJS(),r.detectIfIE(),r.detectIfFirefox(),r.skipToMainContent(),r.globalNavDropdown(),r.tabletMenuDropdown(),r.mobileSiteMenuDropdown(),SCM.Logging.init(),SCM.JqueryMigrateLogger.init(),r.articleUserComments(),r.initAriaControls(),r.initFilterClickEvent(),r.initSearchResultsSort(),r.initSearchResultsPagination(),SCM.Utilities.LazyLoad.init(),r.showAuthorInfo(),r.hideAuthorInfo(),r.showArticleMetadata(),SCM.PubHistory.registerToggle(),r.showFullAuthorList(),r.addAuthorFootnote(),r.showHideDropDown(),r.showRelatedBookWidgetIfHasContent(),r.showMoreRelatedContent(".grw-viewmorelink",".grw-hide-me"),r.showMoreRelatedContent(".mrw-viewmorelink",".mrw-hide-me"),r.showSpinner(),r.toggleMobileLanguageSubmenu(),r.toggleMobileMenu(),SCM.SiteJS.toggleMobileSignInForm(),r.toggleMobileDropdownSubnav(),r.toggleMobileSiteMenuSubnav(),r.mobileSearchDropdown(),r.toggleResponsiveLeftColumn(),r.restrictedImages(),r.moveSubmitCommentLink(),r.moveCompetingInterestsSection(),r.addUserCommentJumpLink(),r.alertLinks(),r.registerArticleListNewAndPopularCombinedMode(),r.siteThemeHeaderDropdowns(),r.initSigninForm(),r.initSelfServeNavigation(),r.toggleSelfServeNavigation(),r.setAllLinksTarget(),r.showPdfOnlyLink(),r.contactUsSubmit(),SCM.gdprCookieBanner.init(),r.alignModalsVerically(),r.conferenceVolumeSelector(),m(".issue-featured-image a, .featured-img-wrapper a, .js-issue-graphical-abstract a").on("click",function(e){var t,n,a;e&&e.preventDefault&&(e.preventDefault(),t=(a=m(e.currentTarget)).parent().html().trim(),e=(n=m("#revealModal")).find("#revealContent"),a=a.attr("href").trim(),n.length&&e.length&&a&&t&&(e.empty().prepend(t),e.find("img").attr("src",a),e.find(".js-graphical-abstract-caption").removeClass("js-modal-only"),o.addClass("on-canvas"),n.addClass("open")))}),(e=m("body.pg_article, body.pg_articlesplitview")).length&&(e.on("mouseover",".table-wrap a.jumplink-placeholder",function(e){e=m(e.currentTarget);a(e.data("sectionid"))&&e.removeClass("jumplink-placeholder")}),e.on("click",".table-wrap a",function(e){var t=m(e.currentTarget),n=t.data("sectionid");a(n)&&(e.preventDefault(),e="/view-large/"+n,t.parent(".fig-graphic").length&&(e="/view-large/figure/"+n+"/"+t.attr("id")),window.open(e,"_blank"))})),r.stickySidebar(),r.unStickSidebar(),r.stickyToolbar(),r.ckbSelectAll(),r.mobileNav(),r.toggleSupplementalTablesAndFigures()},r.windowLoadInit=function(){r.initDatePicker(),r.revealFigsTablesInModal(),r.setSelectedSearchFilter(),r.getNewSelectedFilter(),r.loadAllImagesIfUserIsAboutToUseJumpLinks(),r.showUnAuthenticatedSpans(),r.toggleSearchResultsDetails(),r.toggleSearchCover(),r.modalManager(),r.triggerAlertModalOnRedirect(),r.triggerFppOnRedirect(),r.closeModals(),r.checkForEmptyArticleLeftNav()},r.initArticleTopInfoAccessOptions=function(){var e=window.location.pathname.substring(0,window.location.pathname.indexOf("/",2))+"/sign-in?returnUrl="+encodeURIComponent(window.location.pathname+window.location.search);m(".article-top-info-user-restricted-options").find(".article-top-info-sign-in").attr("href",e)}}(SCM.SiteJS=SCM.SiteJS||{},jQuery,SCM.ArticleAccessIcons),function(a){var t,n=a(".page-column--left");function i(){SCM.SiteJS.getViewportWidth()<=1023?n.addClass("mobile"):n.removeClass("mobile")}$currentHeaderHeight=a("section.master-header").height(),a(window).on("resize",function(e){clearTimeout(t),t=setTimeout(function(){i(),1023<=SCM.SiteJS.getViewportWidth()&&a(".dropdown-panel, .site-menu").removeAttr("style"),a(document.body).removeClass("noscroll"),n.hide(),a(".responsive-issue-nav").hide(),a(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style")},10)}),a(window).on("load",function(){SCM.SiteJS.windowLoadInit(),SCM.SiteJS.adjustRelatedTagsDisplay()}),a(function(){i(),SCM.SiteJS.init(),SCM.Toolbar.init(),SCM.PDFAccess.init(),SCM.SiteJS.setAccessIcons(),SCM.FormWidget.formSubmit(),SCM.FormWidget.getMaxCharacters(),SCM.JumpLinks.init(),SCM.AddReturnUrlToSocietyLinks(),0<a(".widget-ArticleFulltext").length&&SCM.ArticleFulltext.init(),SCM.ArticleLinks.init(),SCM.SiteJS.triggerSaveSearchModelOnRedirect(),a("body").hasClass("pg_articlesplitview")&&SCM.SplitScreen.init(),a("body").hasClass("pg_brightcove")&&SCM.Utilities.Brightcove.init(),a(".widget-ShibbolethSignin").length&&SCM.MyAccount.initShibboleth(),SCM.SubjectBrowse.init(),SCM.JwPlayer&&SCM.JwPlayer.init&&SCM.JwPlayer.init(),SCM.CompactAddToCartButton&&SCM.CompactAddToCartButton.init&&SCM.CompactAddToCartButton.init(),SCM.Utilities&&SCM.Utilities.Reveal&&SCM.Utilities.Reveal.init(),SCM.ToolboxGetCitations&&SCM.ToolboxGetCitations.init&&SCM.ToolboxGetCitations.init(),SCM.Store&&SCM.Store.init&&SCM.Store.init(),SCM.StripePayment&&SCM.StripePayment.init&&SCM.StripePayment.init(),SCM.Modals&&SCM.Modals.init&&SCM.Modals.init(),SCM.PersonalizedContent&&SCM.PersonalizedContent.init&&SCM.PersonalizedContent.init()}),a(document).ajaxStart(function(){a("body").css("cursor","wait")}).ajaxComplete(function(e,t,n){SCM.SiteJS.initSearchResultsSort(),SCM.SolrSearch.ajaxComplete(),SCM.SiteJS.setAccessIcons(),SCM.SiteJS.setAllLinksTarget(),a("body").css("cursor","default"),SCM.SiteJS.abstractMathJax(),SCM.Utilities.LazyLoad.init(),SCM.SiteJS.alignModalsVerically()})}(jQuery);var SCM=SCM||{};!function(e,o){e.setActiveJumplink=function(){o(".section-jump-link").on("click",function(){o(".section-jump-link").removeClass("active"),o(this).closest(".section-jump-link").addClass("active")})},e.toggleNestedJumplinks=function(){o(".section-jump-link .list-toggle, .section-jump-link .mobile-list-toggle").on("click",function(e){e.preventDefault();var t=o(this),n=t.parents(".section-jump-link__link-wrap").siblings("ul.section-jump-link__sublist"),a="icon-general-arrow-filled-right",i="icon-general-arrow-filled-down",r="icon-general_arrow-right",e="icon-general_arrow-down";t.hasClass("list-toggle")&&(t.hasClass(a)?t.removeClass(a).addClass(i):t.removeClass(i).addClass(a)),t.hasClass("mobile-list-toggle")&&(t.hasClass(r)?t.removeClass(r).addClass(e):t.removeClass(e).addClass(r)),"false"===t.attr("aria-expanded")?t.attr("aria-expanded","true"):t.attr("aria-expanded","false"),n.slideToggle(),"false"===n.attr("aria-hidden")?n.attr("aria-hidden","true"):n.attr("aria-hidden","false")})},e.filterTopicTerms=function(){o(".issue-topic__input").keyup(function(){o(".issue-topic__term").hide();for(var e=o(this).val(),t=[e.charAt(0).toUpperCase()+e.substr(1),e.toLowerCase()],n=0;n<t.length;n++)o(".issue-topic__term:contains('"+t[n]+"')").show();null!==e&&""!==e||o(".issue-topic__term").show()})},e.updateIssueBrowseOnChange=function(){o(".issue-browse-select").on("change",function(){window.location.href=o(this).val()})}}(SCM.Issues=SCM.Issues||{},jQuery),jQuery(document).ready(function(e){SCM.Issues.filterTopicTerms(),SCM.Issues.toggleNestedJumplinks(),SCM.Issues.updateIssueBrowseOnChange()});var SCM=SCM||{};!function(ns,$){var baseSiteUrl=$("#hfSiteURL");ns.initMyAccount=function(){var t,n=$(".myaccount-tabs-inner-wrap");$(".mobile-nav-icon");$(window).on("scroll",function(e){clearTimeout(t),t=setTimeout(function(){n.removeAttr("style")},50)}),$(window).on("resize",function(e){clearTimeout(t),t=setTimeout(function(){n.removeAttr("style")},50)});var e=location.pathname,a=e.indexOf("/","/my-account/".length);0<a&&(e=e.substring(0,a)),$(".myaccount-tabs-inner-wrap").find("li").has('a[href="'+e+'"]').addClass("is-active"),$(document).on("click","#myaccount-tabs-content #updatePersonalDetailsBtn",function(){var t=$("#myaccount-tabs-content");t.find(".success-message").html("").hide(),t.find(".error-message").html("").hide();var e=t.find("#Title").val(),n=t.find("#FirstName").val(),a=t.find("#LastName").val(),i=t.find("#Phone").val(),r=t.find("#CountryList").val(),o=/[<>]/;if(o.test(e)||o.test(n)||o.test(a)||o.test(i)){o=t.find("#err-message-angle-brackets").html();return t.find(".error-message").html(o).show(),void $("html, body").animate({scrollTop:t.offset().top},10)}$.post("/MyAccount/UpdateAccount",{title:e,firstName:n,lastName:a,phone:i,country:r},function(e){e.Success?($("#header-account-info-user-fullname").html(n+" "+a),t.find(".success-message").html(e.Html).show()):(t.find(".error-message").html(e.Html).show(),$("html, body").animate({scrollTop:t.offset().top},10))})});var c=$("#change-password").find(".error-message").html();$(document).on("click","#changePasswordBtn",function(){var t=$("#change-password"),n=t.find(".success-message");n.hide();var a=t.find(".error-message");a.html(c).hide();var e={},i=t.find("#currentPassword").val(),r=!1;""===i&&(e.currentPassword=$("label[for=currentPassword]").text().replace("*",""),r=!0);var o=t.find("#newPassword").val();""===o&&(e.newPassword=$("label[for=newPassword]").text().replace("*",""),r=!0);var s=t.find("#confirmNewPassword").val();if(""===s&&(e.confirmNewPassword=$("label[for=confirmNewPassword]").text().replace("*",""),r=!0),r){for(var l in e)a.append("<p> * "+e[l]+"</p>").show();$("html, body").animate({scrollTop:t.offset().top},10)}else a.html(""),$.post("/MyAccount/ChangePassword",{currentPassword:i,newPassword:o,confirmNewPassword:s},function(e){"1"==e[0]?(n.show(),$.post("/LOGIN",{user:e[1],pass:o,dest:"/HTTPHandlers/SAMs/LoginHandler.ashx"}).done(function(e){"1"!==e&&(location.href="/sign-in")})):(a.html(e[1]).show(),$("html, body").animate({scrollTop:t.offset().top},10))})}),$(document).on("click","#changeEmailBtn",function(){var a=$("#change-email-address"),i=a.find(".success-message"),r=a.find(".error-message"),e=a.find("#newEmailAddress").val(),t=a.find("#confirmNewEmailAddress").val(),n=a.find("#currentPassword").val(),o={},s=!1;if(r.html(""),""===e&&(o.newEmailAddress=$("label[for=newEmailAddress]").text().replace("*",""),s=!0),""===t&&(o.confirmNewEmailAddress=$("label[for=confirmNewEmailAddress]").text().replace("*",""),s=!0),""===n&&(o.password=$("label[for=currentPassword]").text().replace("*",""),s=!0),s){for(var l in r.append("Please complete the following required fields:"),o)r.append("<p> * "+o[l]+"</p>");return r.show(),void $("html, body").animate({scrollTop:a.offset().top},10)}$.post("/UserDashboard/RequestEmailAddressChange",{newEmailAddress:e,confirmNewEmailAddress:t,password:n},function(e){if(null!=e)if(e.Success)a.children(".change-email-address-form").hide(),i.show();else{for(var t=0,n=e.Messages.length;t<n;t++)r.append("<p> * "+e.Messages[t]+"</p>");r.show(),$("html, body").animate({scrollTop:a.offset().top},10)}})}),ns.initMyEditableProfile()},ns.initMyEditableProfile=function(){$(".btn-edit-userprofile").click(function(){ns.editUserProfile()})},ns.editUserProfile=function(){$.get("/Content/EditUserProfile/editUserProfile","",function(e){var t=$("#myaccount-tabs-content");null!=e&&e.length&&(t.html(e).show(),ns.initUserProfileEvents())})},ns.initUserProfileEvents=function(){$(".btn-userprofile-update").click(function(){ns.updateUserProfile()}),$(".btn-userprofile-cancel").click(function(){ns.cancelUserProfile()}),$(".userprofile-countries").change(function(){var e=$(this).find(":selected").val();ns.getUserProfileStates(e)}),SCM.MyAccount.initTestPassword()},ns.updateUserProfile=function(){var userProfile={FirstName:$("#userprofile-firstname").val(),LastName:$("#userprofile-lastname").val(),UserName:$("#userprofile-username").val(),Password:$("#Password").val(),ConfirmPassword:$("#ConfirmPassword").val(),Organization:$("#userprofile-organization").val(),HomePhone:$("#userprofile-homephone").val(),WorkPhone:$("#userprofile-workphone").val(),MobilePhone:$("#userprofile-mobilephone").val(),Suffix:$("#userprofile-suffix").val(),Address:$("#userprofile-address").val(),Address2:$("#userprofile-address2").val(),City:$("#userprofile-city").val(),PostalCode:$("#userprofile-postalcode").val(),StateId:$(".userprofile-states :selected").val(),CountryId:$(".userprofile-countries :selected").val(),Title:$("#userprofile-title").val(),EmailAddress:$("#userprofile-emailaddress").val()};$.ajax({type:"POST",url:"/Content/UpdateUserProfile/updateUserProfile",data:JSON.stringify(userProfile),contentType:"application/json",success:function(e){var n,t=$("#myaccount-tabs-content");null==e.Success&&e.length?(t.html(e).show(),ns.initMyEditableProfile()):(t.find(".error-message").html(e.Html),null!=e.Messages&&e.Messages.length&&(n=$("<ul></ul>"),$.each(e.Messages,function(e,t){n.append("<li>"+t+"</li>")}),(t=t.find(".error-message")).append(n),t.show()))},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})},ns.cancelUserProfile=function(){$.get("/Content/MyProfile/myProfile","",function(e){var t=$("#myaccount-tabs-content");null!=e&&e.length&&(t.html(e).show(),ns.initMyEditableProfile())})},ns.getUserProfileStates=function(e){$.get("/Content/UserProfileGetStates/myProfileGetStates",{countryId:e},function(e){var t=$(".userprofile-states");if(t.empty(),null!=e&&e.length){for(var n in e){var a=$("<option/>").attr("value",e[n].StateId).text(e[n].StateName);t.append(a)}t.removeClass("hide"),t.closest(".dataRow").removeClass("hide")}else t.removeClass("hide").addClass("hide"),t.closest(".dataRow").addClass("hide")})},ns.initSavedSearches=function(){$(".solrSearchSaveWidget table.tablesorter").tablesorter({theme:"default",delayInit:!0,ignoreCase:!0,headers:{4:{sorter:!1}},sortList:[[0,0]]}),$(".solrSearchSaveWidget .save-search-delete").click(function(){SCM.MyAccount.deleteSaveSearch($(this))}),$(".solrSearchSaveWidget .ddlSearchAlertFrequencyMyAccount").change(function(){SCM.MyAccount.changeUserAlert($(this))}),$(".solrSearchSaveWidget .save-search-rename-rename").click(function(){var e=$(this).closest("td"),t=e.find(".save-search-name-link");t.hide(),e.find(".save-search-input").val(t.text()).css("display","inline-block").focus(),e.find(".save-search-rename-cancel").show(),e.find(".save-search-rename-save").show(),$(this).hide()}),$(".solrSearchSaveWidget .save-search-rename-cancel").click(function(){var e=$(this).closest("td");e.find(".save-search-name-link").show(),e.find(".save-search-input").hide(),e.find(".save-search-rename-rename").show(),e.find(".save-search-rename-save").hide(),$(this).hide()}),$(".solrSearchSaveWidget .save-search-rename-save").click(function(){var e=$(this),t=e.closest("td"),n=t.find(".save-search-input"),a=e.closest("tr").data("usersearchid"),e=n.val();e.length&&(SCM.MyAccount.renameSaveSearch(e,a),n.hide(),t.find(".save-search-name-link").text(e).show(),t.find(".save-search-rename-rename").show(),t.find(".save-search-rename-cancel").hide(),$(this).hide())}),$(".solrSearchSaveWidget .save-search-input").on("keypress",function(e){var t=$(this).closest("td"),n=$(this).val();13===(e.keyCode||e.which)&&(e.preventDefault(),n.length&&(e=t.closest("tr").data("usersearchid"),SCM.MyAccount.renameSaveSearch(n,e),$(this).hide(),t.find(".save-search-name-link").text(n).show(),t.find(".save-search-rename-rename").show(),t.find(".save-search-rename-save").hide(),t.find(".save-search-rename-cancel").hide()))})},ns.deleteSaveSearch=function(delElem){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/DeleteSolrSearchInfo",parentElem=delElem.closest("tr"),id=parentElem.data("usersearchid"),userAlertId=parentElem.data("useralertid");$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{userSearchId:id,userAlertId:userAlertId},success:function(e){e.Success&&parentElem.remove()},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})},ns.changeUserAlert=function(upElem){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/UpdateUserAlert",parentElem=upElem.closest("tr"),id=parentElem.data("usersearchid"),userAlertId=parentElem.data("useralertid"),scheduleId=upElem.val();$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{userSearchId:id,userAlertId:userAlertId,scheduleId:scheduleId},success:function(e){e.Success&&parentElem.data("useralertid",e.ReturnId)},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})},ns.renameSaveSearch=function(searchName,userSearchId){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/RenameSolrSearchInfo";$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{searchName:searchName,userSearchId:userSearchId},success:function(e){},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})},ns.initRegister=function(e){var m=$(".widget-RegisterUser");null!=e&&0<e.length&&m.find(".error-message").html(e).show(),m.on("click","#showPassword",function(){m.find("#Password, #ConfirmPassword").each(function(){var e=$(this).clone();e.attr("type","text"),e.attr("autocomplete","off"),e.attr("value",$(this).val()),$(this).after(e),$(this).remove()}),$(this).hide(),$(this).siblings("#hidePassword").show()}),m.on("click","#hidePassword",function(){m.find("#Password, #ConfirmPassword").each(function(){var e=$(this).clone();e.attr("type","password"),e.removeAttr("autocomplete"),e.attr("value",$(this).val()),$(this).after(e),$(this).remove()}),$(this).hide(),$(this).siblings("#showPassword").show()}),$(document).ready(function(){ns.loadCountryStates($(".widget-RegisterUser"))}),m.on("change","#CountryList",function(){ns.loadCountryStates(m)}),m.on("click","#registerBtn",function(){m.find(".error-message").html().hide;var e=m.find("#UserName").val(),t=m.find("#EmailAddress").val(),n=m.find("#Password").val(),a=m.find("#ConfirmPassword").val(),i=m.find("#Title").val(),r=m.find("#FirstName").val(),o=m.find("#LastName").val(),s=m.find("#MembershipNumber").val(),l=m.find("#VendorId").val(),c=m.find("#Address").val(),d=m.find("#City").val(),u=m.find("#StateList").val(),h=m.find("#CountryList").val(),p=m.find("#ZipCode").val(),f=m.find("#Telephone").val(),f=JSON.stringify({UserName:e,EmailAddress:t,Password:n,ConfirmPassword:a,Title:i,FirstName:r,Lastname:o,MembershipNumber:s,VendorId:l,Address:c,City:d,State:u,Country:h,ZipCode:p,PhoneNumber:f});$.ajax({type:"POST",url:"/UserDashboard/RegisterNewUser",data:f,success:function(e){var n;e.Success?SCM.SiteJS.loginReturnBack():null!=e.Messages&&e.Messages.length&&(n=$("<ul></ul>"),$.each(e.Messages,function(e,t){n.append("<li>"+t+"</li>")}),m.find(".error-message").html(n).show())},contentType:"application/json"})}),SCM.MyAccount.initTestPassword()},ns.initTestPassword=function(){var t=$(".register-form-wrap, .editable-userprofile-info"),n=/[A-Z]/,a=/[0-9]/,i="",r=t.find(".icon-case"),o=t.find(".password-confirm-icon"),s=t.find(".password-input-icon"),l=t.find(".icon-length"),c=t.find(".icon-number"),d=t.find(".password-check-wrap"),u=!1;t.on("keyup","#Password",function(){var e=$(this).val();i=e,u?d.hide():d.show(),10<=e.length?SCM.MyAccount.showValidPasswordCriteria(l):SCM.MyAccount.showInvalidPasswordCriteria(l),n.test(e)?SCM.MyAccount.showValidPasswordCriteria(r):SCM.MyAccount.showInvalidPasswordCriteria(r),a.test(e)?SCM.MyAccount.showValidPasswordCriteria(c):SCM.MyAccount.showInvalidPasswordCriteria(c),l.hasClass("green")&&r.hasClass("green")&&c.hasClass("green")?(u=!0,d.fadeOut(1500),s.hide(),e===t.find("#ConfirmPassword").val()&&(o.hide(),t.find("#registerBtn").addClass("btn-green"),t.find(".register-button-overlay").hide())):(u=!1,d.show(),SCM.MyAccount.lockRegistrationButton(),s.show()),""!==e&&null!==e||(d.hide(),s.hide())}),t.on("keyup","#ConfirmPassword",function(){var e=$(this).val();i===e?(o.hide(),u&&(t.find("#registerBtn").addClass("btn-green"),t.find(".register-button-overlay").hide())):(""===e||null===e?o.hide():o.show(),SCM.MyAccount.lockRegistrationButton())}),$(document).on("click",function(){d.hide()})},ns.loadCountryStates=function(formContainer){var countryId=formContainer.find("#CountryList").val(),stateList=formContainer.find("#StateList"),countryData;stateList.empty().prop("disabled",!0),null!=countryId&&countryId.length&&(countryData={countryId:countryId},$.ajax({url:"/UserDashboard/RegisterGetCountryStates",data:countryData,success:function(e){null!=e&&e.length&&($.each(e,function(e,t){stateList.append($('<option value="'+t.StateId+'">'+t.StateName+"</option>"))}),stateList.prop("disabled",!1))},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}}))},ns.lockRegistrationButton=function(){$(".register-form-wrap").find("#registerBtn").removeClass("btn-green"),$(".register-form-wrap").find(".register-button-overlay").show()},ns.showValidPasswordCriteria=function(e){e.removeClass("icon-general-close red").addClass("icon-general-check green"),e.siblings(".password-check-label").addClass("fade")},ns.showInvalidPasswordCriteria=function(e){e.removeClass("icon-general-check green").addClass("icon-general-close red"),e.siblings(".password-check-label").removeClass("fade")},ns.initForgotPassword=function(){var s=$("#forgot-password").find(".error-message").html();$("#forgotPasswordBtn").on("click",function(){var n=$("#forgot-password"),a=n.find(".success-message"),i=n.find(".error-message"),e="";a.html("").hide(),i.html(s).hide();var r=n.find("#contactEmail").val(),o=n.find("#hfCaptchaEnabledForForgotPassword").val(),t={email:r};"1"===o&&(t.captchaChallenge="not empty",t.captchaResponse=grecaptcha.getResponse()),0===t.email.length&&(e+="<p> * "+$("label[for=contactEmail]").text().replace("*","")+"</p>"),"1"===o&&0===t.captchaResponse.length&&(e+="<p> * Captcha</p>"),0===e.length?$.post("/UserDashboard/ForgotPassword",t,function(e){var t;null==e||""==e?(t=n.find(".success-message-template").html().replace("{0}",r),a.html(t).show()):(i.html(e).show(),$("html, body").animate({scrollTop:n.offset().top},10)),"1"===o&&$("#recaptcha_reload").trigger("click")},"html"):(i.append(e).show(),$("html, body").animate({scrollTop:n.offset().top},10))})},ns.initResetPassword=function(){$("#changePasswordBtn").on("click",function(){var n=$("#change-password"),a=n.find(".success-message"),i=n.find(".error-message"),e=n.find(".default"),t=$.deparam.querystring().t,r=n.find("#newPassword").val(),o=n.find("#confirmNewPassword").val();e.removeClass("default"),$.post("/UserDashboard/ResetPassword",{token:t,newPassword:r,confirmNewPassword:o},function(e){var t;null==e||""==e?((t=$.deparam.querystring().returnUrl)&&window.location.assign(t),a.show(),i.hide()):(a.hide(),i.html(e).show(),$("html, body").animate({scrollTop:n.offset().top},10))},"html")})},ns.countSubjectChoices=function(){$("#communication-preferences-subject-choices").find(".topics-selected-wrap").each(function(){var e=$(this).closest("li").find("input[type=checkbox]"),t=e.filter(":checked");$(this).find(".totalCount").html(e.length),$(this).find(".checkedTotal").html(t.length),$(this).show()})},ns.changeUserTypeSubjects=function(t){var e=$("#communication-preferences");$("#userTypeSubjectHeader").hide();var n=e.find("#userTypes").val();"3"===n&&$("#userTypeSubjectHeader").show(),e.find("ul#userTypeSubjects > li").each(function(){var e=$(this).find("input[type=checkbox]");$(this).attr("data-classification-id")===n?($(this).show(),t&&e.prop("checked",e.data("checked"))):($(this).hide(),t&&e.prop("checked",!1))})},ns.initShibboleth=function(){$("#FederationDropdown").on("change",function(){var federationID=$(this).val();""!=federationID&&0<federationID&&$.ajax({url:"/UserDashboard/GetInstitutionsForFederation",type:"POST",dataType:"json",data:{FederationID:federationID},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}}).done(function(e){var n=$("#InstitutionDropdown");n.find("option:gt(0)").remove(),$.each(e,function(e,t){n.append('<option value="'+t.ShibbolethID+'">'+t.InstitutionName+"</option>")})})}),$("#shibbolethSelectBtn").on("click",function(){var shibbolethID=$("#InstitutionDropdown").val();""!=shibbolethID?$.ajax({url:"/UserDashboard/RedirectToShibboleth",type:"POST",dataType:"json",data:{ShibbolethID:shibbolethID},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}}).done(function(e){var t=$.deparam.querystring().returnUrl;t&&(document.cookie="returnUrl="+encodeURIComponent(t)),window.location.assign(e)}):$("#shibboleth-error").html("Please select an institution")})},ns.checkOpenAthens=function(){0<=window.location.search.indexOf("openathens=")&&$('#FederationDropdown option:contains("OpenAthens Federation")').attr("selected","selected").change()}}(SCM.MyAccount=SCM.MyAccount||{},jQuery),$(document).ready(function(){$(document).on("click",".myaccount-tabs-inner-wrap div",function(){$(".tabbed-content-overlay").show()}),$("#myaccount-tabs-content").on("DOMSubtreeModified",function(){$(".tabbed-content-overlay").hide()}),$("#institutionalLogoURL").keyup(function(){$(".logoPreview").attr("src",$(this).val()),$(".logoPreview").error(function(){$(this).attr("src","/Images/grey.gif")})}),SCM.MyAccount.checkOpenAthens()});var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},function(ns,$,bc){function handleClickEvent(){var $this=$(this),articleId=$this.data("articleid"),isLayAbstract="True"===$this.data("is-lay-abstract"),$abstractLocation=getAbstractLocation(articleId,isLayAbstract),$abstractLinks=$("#abstract-"+articleId+"-links"),ajaxUrl=getAjaxUrl($this,isLayAbstract);$abstractLocation.closest(".js-abstract-parent").toggleClass("abstractExpanded");var isAbstractAlreadyFetchedFromServer="True"===$this.data("tried-to-fetch-abstract");isAbstractAlreadyFetchedFromServer||(toggleSpinner($abstractLocation),$.get(ajaxUrl,{articleId:articleId,layAbstract:isLayAbstract}).done(function(e){$abstractLocation.html(e.Html),$abstractLocation.append($abstractLinks.html()),handleClickEventForTabs(),bc&&bc.init&&bc.init()}).fail(function(xmlHttpRequest,textStatus,errorThrown){var err;toggleSpinner($abstractLocation),window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}),$this.data("tried-to-fetch-abstract","True")),$abstractLocation.toggleClass("hide");var $thisAbstractIcon=$this.find(".js-abstract-toggle-icon"),toggleIconClass=$thisAbstractIcon.data("icon-class"),downArrow=toggleIconClass+"-down",upArrow=toggleIconClass+"-up";$thisAbstractIcon.toggleClass(downArrow),$thisAbstractIcon.toggleClass(upArrow)}function getAbstractLocation(e,t){return $(t?".js-layabstract#abstract-"+e:"#abstract-"+e)}function getAjaxUrl(e,t){var n="",a=getBaseSiteUrl();return a&&(n+="//"+a),t?n+="/PlatformArticle/ArticleLayAbstractAjax":"extract"===e.data("abstract-type")?n+="/PlatformArticle/ArticleAbstractOrExtractAjax":n+="/PlatformArticle/ArticleAbstractAjax",n}function getBaseSiteUrl(){var e=$("#hfSiteURL");return e.length?e.val():null}function handleClickEventForTabs(){$(".js-tabs").parents(".js-abstract-response-placeholder").addClass("removePad"),$(document).on("click",".js-abstract-tab-link",function(e){var t=$(e.target),n=t.closest(".js-abstract-response-placeholder"),a=t.closest(".js-abstract-tab-link-wrap"),e=n.find(".js-tabs-content .js-abstract-tab-content-wrap"),t=a.index();switchTabLinks(n,a),switchTabContent(e,t)})}function switchTabLinks(e,t){e.find(".js-abstract-tab-link-wrap").removeClass("is-active"),t.addClass("is-active")}function switchTabContent(e,t){e.removeClass("is-active"),e.eq(t).addClass("is-active")}function toggleSpinner(e){e.find(".js-spinner").toggleClass("hide")}ns.initAbstractClickEvent=function(){$(".master-main").on("click",".js-show-abstract",handleClickEvent)}}(SCM.ArticleAbstract=SCM.ArticleAbstract||{},jQuery,SCM.Utilities.Brightcove),jQuery(document).ready(function(){SCM.ArticleAbstract.initAbstractClickEvent()});var SCM=SCM||{};SCM.SearchResults={},SCM.SearchResults.defaults={controller:"Solr",action:"SolrSearch",instanceName:"SearchResults",baseSiteUrl:"",updateTargetSelector:".content-main_content",onHashChange:function(){}},function(e,d){function u(t,n){t.on("keydown",function(e){if(13===e.which&&isYearOnly(t.val()))return updateYearOnlyToFullDate(t,n),e.preventDefault(),e.stopImmediatePropagation(),!1}).datepicker()}function a(e,t,n){e.find(".sf-facet").length>t&&(e.find(".sf-facet:gt("+(t-1)+")").hide(),e.find(".facetShowMoreTax").length||e.parents(".sf-facet").length||e.append('<div><a href="javascript:;" class="'+n+'">Show more</a></div>'))}function i(e,t,n){e.closest(n).find(".sf-facet:gt("+(t-1)+"):visible").length?(e.closest(n).find(".sf-facet:gt("+(t-1)+"):visible").animate({height:"toggle"},400),e.text("Show more")):(e.closest(n).find(".sf-facet").not(":visible").animate({height:"toggle"},400),e.text("Show less")),event.preventDefault()}function o(){0<=window.location.search.indexOf("&cqb=")&&(d("#btnReturnAdvancedSearch").removeClass("hide"),d(".querybuilder-wrap").addClass("hide"));var e=d("#queryBuilderSubmit").data("currentUrl");d("#btnReturnAdvancedSearch").click(function(){window.location.href=location.protocol+"//"+d("#hfSiteURL").val()+"/advanced-search?"+e})}function t(e){e.hasClass("icon-general-arrow-filled-right")?e.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"):e.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right")}function s(){d(".taxonomy-parent-arrow").on("click",function(){var e=d(this);e.parents(".taxonomy-label-wrap").siblings(".taxonomy-child-list").slideToggle(),t(e)}),d(".js-taxonomy-umbrella-toggle").on("click",function(){var e=d(this);d(".taxonomy-tree-wrap").slideToggle(),$icon=e.find(".taxonomy-umbrella-arrow"),t($icon)})}e.AddShowMoreLinks=function(){var t,n,e=d("#js-hf-facet-toggle-limit").val();t=e=e||12,d(".collapsible-facet .sf-facet-list").each(function(){a(d(this),t,"facetShowMore")}),d(".facetShowMore").off("click"),d(".facetShowMore").on("click",function(e){i(d(this),t,".sf-facet-list")}),n=e,d(".taxonomy-tree-wrap").each(function(){a(d(this),n,"facetShowMoreTax")}),d(".facetShowMoreTax").off("click"),d(".facetShowMoreTax").on("click",function(e){i(d(this),n,".taxonomy-tree-wrap")}),d(document).on("click",".js-sri-journal-description-container a",function(e){e.preventDefault(),d(this).closest(".js-sri-journal-description-container").find(".js-sri-journal-description").toggleClass("hide")})},SCM.SearchResults.AddShowMoreLinks(),o(),s();var l,h={},p=window.location.search.substring(1);window.onpopstate=function(e){e.state&&e.state.queryString&&SCM.SearchResults.doSolrSearch(e.state)},function(){var e=d(SCM.SearchResults.defaults.updateTargetSelector);h[p]={results:e.html()},window.history.replaceState({queryString:p},null,null);var t=d("#fromDate"),n=d("#ToDate");d("#fromDate").datepicker(),d("#ToDate").datepicker();var a=!0;function i(e){var t=/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/.exec(e);if(null!=t){var n=t[2],a=t[1]-1;return 2==(e=t[3]).length&&(e="20"+e),(t=new Date(e,a,n)).getDate()==n&&t.getMonth()==a&&t.getFullYear()==e}}function r(e){return(e=/^(\d{4})$/.exec(e))&&-1<e[1]}function o(e,t){var n=e.val(),a=null,i=null,i=t?a="01":(a="12","31");return e.val(a+"/"+i+"/"+n),e.val()}function s(e){var t=(r=/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/.exec(e))[1],n=r[2],a=r[3],i=n,e=t,r=a;return 2==a.length&&(r="20"+a),1==n.length&&(i="0"+n),1==t.length&&(e="0"+t),e+"/"+i+"/"+r}function l(e){return"string"==typeof e?"true"==e.toLowerCase():!!e}Date.prototype.today=function(){return(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)+"/"+(this.getDate()<10?"0":"")+this.getDate()+"/"+this.getFullYear()},e.on("click",".chkSelect",function(e){SCM.SearchResults.doSolrSearch({queryString:d(this).data("redirectUrl"),source:"searchresults"})}),e.on("click","a.close",function(e){var t=d(this).attr("data-url");null!=t&&"#"!=t&&""!=t&&(e.preventDefault(),SCM.SearchResults.doSolrSearch({queryString:t,source:"searchresults"})),u(d("#fromDate"),!0),u(d("#ToDate"),!1)}),e.on("click",".rbShowFacet",function(e){e.preventDefault(),"False"==d(this).attr("previous-status")&&(e=d(this).attr("data-url"),SCM.SearchResults.doSolrSearch({queryString:e,source:"searchresults"}))}),e.on("click","#solrSearchBtn",function(e){var t=d("#txtSearch").val();null==t||""==t?alert("Please enter a term to perform search"):(t=encodeURIComponent(t),SCM.SearchResults.doSolrSearch({queryString:"q="+t}))}),e.on("click","#btnRangeSearch",function(e){var t=d("#fromDate").val();r(t)&&(t=o(d("#fromDate"),!0));var n=d(".date-range-input-radio[value=single]").is(":checked")?t:d("#ToDate").val();""!==n&&r(n)&&(n=o(d("#ToDate"),!1)),i(t)&&i(n)?(t=s(t),n=s(n),new Date(n)<new Date(t)?alert("End Date must be greater than Start Date"):(n=d(this).attr("data-url").replace("queryText",t+" TO "+n),SCM.SearchResults.doSolrSearch({queryString:n,source:"searchresults"}))):alert("Please enter valid dates")});var c=function(){var e,t={UserEmail:d("#UserEmail").val(),ResourceTitle:d("#ResourceTitle").val(),AlertType:d("#AlertType").val(),CurrentUserEmail:d("#CurrentUserEmail").val(),IsUserAlreadySubscribed:l(d("#IsUserAlreadySubscribed").val()),SuccessfulUpdate:d("#SuccessfulUpdate").val(),ResourceId:d("#ResourceId").val(),ResourceType:d("#ResourceType").val(),SearchTerm:d("#SearchTerm").val(),SearchUrl:d("#SearchUrl").val(),CurrentAlertContextSiteId:d("#CurrentAlertContextSiteId").val(),ShowSaveSearchToUnauthenticatedUser:l(d("#ShowSaveSearchToUnauthenticatedUser").val()),UserIsLoggedIn:l(d("#UserIsLoggedIn").val())};null!=t.IsUserAlreadySubscribed&&t.IsUserAlreadySubscribed?(e=d("#Config_SearchAlertMyAccoutUrl").val(),window.location.href=e):t.ShowSaveSearchToUnauthenticatedUser&&!t.UserIsLoggedIn?(ShowSignInForSearchAlertSignUp(),a=!0):d.post("/Toolbox/ToolboxGetAlertsUpdateMessage",t,function(e){a=!0,alert("Alert Saved Sucessfully. Visit My Account page to manage your email alerts"),d("#divSearchAlerts").html(e),d("#divSearchAlerts a").on("click",function(e){e.preventDefault(),c()})})};e.on("click","#divSearchAlerts a",function(e){e.preventDefault(),a&&(a=!1,c())}),u(t,!0),u(n,!1)}(),SCM.SearchResults=d.extend(SCM.SearchResults,(l=jQuery,{doSolrSearch:function(t){function n(e){e.getBoundingClientRect().top<0&&l("html, body").animate({scrollTop:e.offsetTop},1e3)}function a(e){null===window.history.state?window.history.replaceState(e,null,window.location.pathname+"?"+e.queryString):window.history.state.queryString!=e.queryString&&window.history.pushState(e,null,window.location.pathname+"?"+e.queryString)}var i=l.extend(SCM.SearchResults.defaults,t),r=l(i.updateTargetSelector);if(h[t.queryString])return r.html(h[t.queryString].results).show(),SCM.SolrSearch.ajaxComplete(),n(r[0]),s(),a(t),o(),App.SiteJS.mobileContentNav(),void l("body").removeClass("on-canvas");var e=l.deparam.querystring().page;e&&1!==parseInt(e)&&(t.queryString=t.queryString.replace("page="+e,"page=1"));e="/"+i.controller+"/"+i.action+"/"+i.instanceName;void 0!==i.baseSiteUrl&&""!==i.baseSiteUrl&&(e="//"+i.baseSiteUrl+e),e+="?"+t.queryString,"155"===l("#hdnSiteID").val()&&window.location.href.indexOf("/map-results?")<0?window.location.href="?"+t.queryString:l.ajax({url:e,success:function(e){r.html(e),n(r[0]),h[t.queryString]={results:e,updateTargetSelector:i.updateTargetSelector},u(l("#fromDate"),!0),u(l("#ToDate"),!1),App.SiteJS.mobileContentNav(),l("body").removeClass("on-canvas"),"undefined"!=typeof clientViewOption&&""!==clientViewOption&&(e=l(".sri-expandedView"),"Expanded"===clientViewOption?e.show():e.hide()),s(),a(t),o(),t.hasOwnProperty("source")&&0<window.location.pathname.indexOf("map-results")&&"heatmap"!==t.source&&SCM.SearchMap.searchUpdated(),SCM.JournalCitationFilter&&SCM.JournalCitationFilter.init(),SCM.SearchResults.AddShowMoreLinks()},error:function(e){console.log(e)}})}}))}(SCM.SearchResults=SCM.SearchResults||{},jQuery);var App=App||{};!function(o,c){var e=window.location.protocol+"//"+window.location.host,t=c("#hfSolrAutoSuggestMinimumCharactersLength").val();function r(e,t){return function(){t.apply(e,arguments)}}function n(e,t,n,a,i){this.searchInputControlId=document.querySelector("[data-autosuggest-id='"+e+"']"),this.searchInputHintControlId=document.querySelector("[data-autosuggest-id='"+t+"']"),this.autoCompleteResultsControlId=document.querySelector("[data-autosuggest-id='"+n+"']"),this.isMicrosite=a,null!==i?(this.siteFilterDropDownSelectID=document.querySelector("[data-autosuggest-id='"+i+"']"),this.siteFilterDropDownSelectID&&this.siteFilterDropDownSelectID.addEventListener("change",r(this,this.filterSuggestions),!1)):this.siteFilterDropDownSelectID=!1,null!==this.searchInputControlId&&(this.searchInputControlId.addEventListener("keydown",r(this,this.interceptKeys),!1),this.searchInputControlId.addEventListener("input",debounce(r(this,this.evaluateTerms),250),!1),c(this.searchInputControlId).on("blur",r(this,this.hideResultsList)),c(this.searchInputControlId).on("focus",r(this,this.showResultsList)))}(n.prototype={solrUrl:"/solr/SolrAutoSuggest",baseURL:e,inputTerms:!1,termsArray:!1,baseTerms:!1,terms:!1,results:[],selectedResult:-1,contentID:!1,isSearching:!1,lookupCache:{}}).filterSuggestions=function(){this.selectedResult=-1,this.inputTerms.length>=t&&this.getSuggestions()},n.prototype.evaluateTerms=function(){if(this.resetSelection(),this.inputTerms=this.searchInputControlId.value.toLowerCase(),0===this.inputTerms.length)return this.isSearching=!1,void this.resetAutoComplete();this.inputTerms.length>=t&&!this.isSearching&&this.getSuggestions(),(this.terms.length<=1||this.searchInputControlId.value!==this.inputTerms)&&this.clearHint()},n.prototype.getJournalURL=function(e,t,n){return"f_JournalDisplayName="+encodeURIComponent(e.trim())+t+(n?"&"+n:"")},n.prototype.getLearningURL=function(e,t){return t?t+e:"hd=learning"+e+"&f_HasCME=true"},n.prototype.getSearchParams=function(){var e="",t=this.getSiteId();return 0<t&&(e=(e.length?"&":"")+"fl_SiteID="+t),this.siteFilterDropDownSelectID?e:"allJournals=1&SearchSourceType=24"},n.prototype.getSiteId=function(){var e=0;return this.siteFilterDropDownSelectID&&(e=parseInt(c(this.siteFilterDropDownSelectID).children("option:selected").data("siteid"))),e},n.prototype.lookupFromCache=function(e){var r=this;return r.lookupCache[e]||(function(e){for(var t=Object.getOwnPropertyNames(r.lookupCache),n=0;n<t.length;n++){var a=t[n],i=r.lookupCache[a];if(!(0!==e.indexOf(a)||i&&i.length))return!0}return!1}(e)?(r.lookupCache[e]=[],[]):null)},n.prototype.getSuggestions=function(){var t=this,e=t.lookupFromCache(t.inputTerms);e?e.length?this.formatSuggestions(e):t.resetAutoComplete():(e=t.getSiteId(),t.isSearching=!0,c.ajax({url:t.solrUrl,data:0<e?{searchTerm:t.inputTerms,siteID:e}:{searchTerm:t.inputTerms},success:function(e){t.isSearching=!1;e=t.parseSuggestionData(e);e&&e.length?(t.lookupCache[t.inputTerms]=e,t.formatSuggestions(e)):(t.lookupCache[t.inputTerms]=[],t.resetAutoComplete())},error:function(){t.isSearching=!1},cache:!0}))},n.prototype.parseSuggestionData=function(e){if(!e)return[];for(var t=[],n=0;n<o.autoSuggestFields.length;n++){var a=e[o.autoSuggestFields[n]];if(a&&a.length)for(var i=0;i<a.length;i++){var r=a[i];0!==n&&-1!==t.indexOf(r)||t.push(r)}}return 1<t.length&&t.sort(),t},n.prototype.formatSuggestions=function(e){var t,n=e;this.results=[],this.siteFilterDropDownSelectID&&(t=c("#"+this.siteFilterDropDownSelectID.id+" option:selected").text());var a=c(".cs-placeholder").text(),i="",r=c(this.siteFilterDropDownSelectID).find("option:selected").val();if(0<n.length)if(this.inputTerms&&-1!==n[0].Key.indexOf(this.inputTerms)){for(var o,s,l=0;l<n.length;l+=1)s=r?{value:n[l].Key,url:r.replace("{searchQuery}",n[l].Key),position:"sr"+this.autoCompleteResultsControlId.id+(l+1)}:(o=this.baseURL,i="Learning"===t||t!==a&&"Learning"===a?"/learning/searchresults?q=":"/search-results?q=",s=this.getSearchParams(),{value:n[l].Key,url:o+i+encodeURIComponent(n[l].Key)+(s.length?"&"+s:""),position:"sr"+this.autoCompleteResultsControlId.id+(l+1)}),this.results.push(s);this.setHint(n[0].Key),this.appendResults()}else this.inputTerms||this.getSuggestions();else this.resetAutoComplete()},n.prototype.setHint=function(e){this.searchInputControlId.value===this.inputTerms&&(this.searchInputHintControlId.value=e)},n.prototype.clearHint=function(){this.searchInputHintControlId.value=""},n.prototype.appendResults=function(){var e="";"term-list"!==this.autoCompleteResultsControlId.className&&(this.autoCompleteResultsControlId.className="term-list");for(var t=0;t<this.results.length;t++){var n=this.results[t];e+='<li><a href="'+n.url+'" id="'+n.position+'">'+this.results[t].value+"</a></li>"}this.autoCompleteResultsControlId.innerHTML=e},n.prototype.hideResultsList=function(e){var t=this;setTimeout(function(){t.autoCompleteResultsControlId.className="term-list term-list--hidden"},200)},n.prototype.showResultsList=function(){this.autoCompleteResultsControlId.className="term-list"},n.prototype.resetResultsList=function(e){this.autoCompleteResultsControlId.innerHTML="",this.hideResultsList()},n.prototype.resetSelection=function(){var e=-1!==this.selectedResult&&this.results[this.selectedResult].position;e&&c("#"+e).removeClass("active"),this.selectedResult=-1},n.prototype.resetAutoComplete=function(){this.results=[],this.resetResultsList(),this.clearHint()},n.prototype.completeTerms=function(){var e=this.searchInputControlId.selectionStart,t=this.searchInputControlId.selectionEnd;return!!(e===t&&t===this.inputTerms.length&&this.results&&0<this.results.length)&&(this.searchInputControlId.value=this.results[0].value,this.evaluateTerms(),!0)},n.prototype.navigateResults=function(e){var t,n=this.selectedResult+e;oldResultId=-1!==this.selectedResult&&this.results[this.selectedResult].position,n<this.results.length&&-1<n?(t=this.results[n].position,oldResultId&&c("#"+oldResultId).removeClass("active"),c("#"+t).addClass("active"),this.selectedResult+=e):!oldResultId&&0<this.results.length?(t=this.results[this.results.length-1].position,c("#"+t).addClass("active"),this.selectedResult=this.results.length-1):this.resetSelection()},n.prototype.keyFunctions=function(e,t){39===t&&this.completeTerms()&&e.preventDefault(),38===t&&(e.preventDefault(),this.navigateResults(-1)),40===t&&(e.preventDefault(),this.navigateResults(1)),13===t&&-1<this.selectedResult&&(e.preventDefault(),e=c("#"+this.autoCompleteResultsControlId.id+" .active").attr("href"),this.searchInputControlId.value=c("#"+this.autoCompleteResultsControlId.id+" .active").text(),this.searchInputHintControlId.value=c("#"+this.autoCompleteResultsControlId.id+" .active").text(),window.location=e)},n.prototype.interceptKeys=function(e){this.searchInputControlId.value.toLowerCase().length<=255&&this.keyFunctions(e,e.keyCode)},o.init=function(e){o.autoSuggestFields=e,c(".search-term-autosuggest").each(function(){var e=c(this);new n(e.data("autosuggest-id"),e.data("autosuggest-hint"),e.data("autosuggest-results"),!1,e.data("searchfilter"))})}}(App.SearchAutoComplete=App.SearchAutoComplete||{},(SCM.JSUtility,jQuery));var SCM=SCM||{};!function(SolrSearch,$,undefined){var bodyVar=$("body"),hfParentSiteName=$("#hfParentSiteName"),queryText="",baseSiteURL=$("#hfSiteURL");void 0!==baseSiteURL&&""!==baseSiteURL.val()&&(SCM.SearchResults.defaults.baseSiteUrl=baseSiteURL.val());var testSearchInput=function(e){if(""===hfParentSiteName.val())return""===$.trim(e)||null===e||"Search"===e?(alert("Please enter a term to search: "),!1):e?(doSolrSearch(e),!0):(alert("SCM.SolrSearch.testSearchInput() fail"),!1);doSolrSearch(e)},testKeypress=function(e,t){13===e.keyCode&&(e.preventDefault(),testSearchInput(t))};function doSolrSearch(e,t){var n=t;n||(t="q"),queryText=encodeURIComponent(e);var a=$("#hfQuickSearchUrl").val(),e="";a&&!n?(e=a.replace("{searchQuery}",queryText),window.location=e):(e="search-results?page=1&"+t+"="+queryText+"&SearchSourceType=1",(t=$("#hfSiteURL")).length&&(e="//"+t.val()+"/"+e),window.location.href=e)}function initDateRangeToggle(){$(".date-range-input-radio").on("click",function(){"single"===$(this).attr("value")?($(".date-input-to").hide(),$(".date-label-from span").text("Search on this date")):($(".date-input-to").show(),$(".date-label-from span").text("From"))})}var saveSolrSearchInfo=function(solrSearchSaveModel){var txtSolrSearchName=$(".txtSolrSearchName");if(""===$.trim(txtSolrSearchName.val())||null===txtSolrSearchName.val())return alert("Please enter a name"),!1;var ddlSearchAlertFrequency=$("#ddlSearchAlertFrequency"),redirectUrl=$("#hdnSearchSaveRedirectUrl"),currentUrl=window.location.href,data=JSON.stringify({searchName:txtSolrSearchName.val(),url:currentUrl,scheduleId:ddlSearchAlertFrequency.val(),redirectUrl:redirectUrl.val()}),ajaxUrl=(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Solr/SaveSolrSearchInfo";$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:data,contentType:"application/json; charset=utf-8",success:function(e){e.RedirectUrl&&e.RedirectUrl.length?window.location=e.RedirectUrl:(alert(e.Html),$(solrSearchSaveModel).closest(".reveal-modal").removeClass("open"),$("body").removeClass("on-canvas"))},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})};function buildSaveSearchUiEvent(){var e=$(".lnkSaveSolrSearch"),n=$(".solrSearchSaveModel"),t=$(".btnSolrSearchSave"),a=$(".txtSolrSearchName");e.off("click").on("click",function(){var e,t=$(this).attr("data-userloggedin");t!==undefined&&"false"===t.toLowerCase()?(e=$("#hdnSearchSaveRedirectUrl"),t=window.location.href,window.location=e.val()+"?returnUrl="+encodeURIComponent(t+"#triggerSaveSearch=1")):(n.addClass("open"),$("body").addClass("on-canvas"))}),t.off("click").on("click",function(){saveSolrSearchInfo(n)}),a.off("keypress").on("keypress",function(e){13===(e.keyCode||e.which)&&saveSolrSearchInfo(n)})}function restrictedImagesSearch(){$("div.sri-figure[restricted]").each(function(){$(this).off("contextmenu").on("contextmenu",function(){return!1})})}function updateMapResultsButtons(){0<window.location.pathname.indexOf("map-results")&&($("#btnViewResultsInSearch").removeClass("hide"),$("#btnViewResultsInMapResults").addClass("hide"))}function bindUiEvents(){var e=$(".master-header").find(".microsite-search-icon"),t=$(".master-header").find(".microsite-search-term"),n=$(".master-header").find(".mobile-microsite-search-icon"),a=$(".master-header").find(".mobile-microsite-search-term"),i=$(".toolbar-search").find(".microsite-search-icon"),r=$(".toolbar-search").find(".microsite-search-term"),o=$("#UmbrellaSearchIcon"),s=$("#UmbrellaHomeSearchIcon"),l=$("#UmbrellaSearchTerm"),c=$("#UmbrellaHomeSearchTerm"),d=$(".kwd-part"),u=$("#hfQuickSearchUrl"),h=$(".navbar-search-filter-mobile"),p=$(".navbar-search-filter-site");o.on("click",function(){testSearchInput(l.val())}),s.on("click",function(){testSearchInput(c.val())}),e.on("click",function(){testSearchInput(t.val())}),n.on("click",function(){testSearchInput(a.val())}),i.on("click",function(){testSearchInput(r.val())}),$(".searchLi .icon-search").on("click",function(){testSearchInput(t.val())}),d.on("click",function(){testSearchInput($(this).attr("data-keyword"))}),l.on("keypress",function(e){testKeypress(e,l.val())}),c.on("keypress",function(e){testKeypress(e,c.val())}),t.on("keypress",function(e){testKeypress(e,t.val())}),a.on("keypress",function(e){testKeypress(e,a.val())}),r.on("keypress",function(e){testKeypress(e,r.val())}),h.on("change",function(e){u.val($(this).val()),normalizeSelectedIndices($(this).prop("selectedIndex"))}),p.on("change",function(e){u.val($(this).val()),normalizeSelectedIndices($(this).prop("selectedIndex"))}),$(".master-main").on("click",".showAbstractLink",function(){$(this).closest(".sri-abstract-link").toggleClass("expanded"),$(this).closest(".sri-abstract-link").find(".abstract-response-placeholder").toggleClass("hide")})}function normalizeSelectedIndices(n){$(".navbar-search-filter-mobile, .navbar-search-filter-site").each(function(e,t){$(this).prop("selectedIndex",n)})}$("body").on("click","#btnViewResultsInMapResults",function(){var e=location.search.substring(1);""!==SCM.SearchResults.defaults.baseSiteUrl&&(location.href="//"+baseSiteURL.val()+"/map-results?"+e)}),$("body").on("click","#btnViewResultsInSearch",function(){var e=location.search.substring(1);""!==SCM.SearchResults.defaults.baseSiteUrl&&(location.href="//"+baseSiteURL.val()+"/search-results?"+e)}),$("body").on("click",".taxonomy-label",function(){var e,t,n,a,i=$("#TaxonomyCurrentDataUrl").val();i=decodeURIComponent(i),""!==$(this).attr("data-parentid")&&(a=$(".taxonomy-node").attr("data-id"),e=$(this).parent(".taxonomy-label-wrap").attr("data-id"),-1!==(n=i.indexOf("tax"))?(-1<(n=(t=i.substring(n)).indexOf("&"))&&(t=t.substring(0,n)),null!==t&&""!==t&&(-1<t.indexOf("="+a)?i=i.replace(t,"tax="+e):-1===$.inArray(e,decodeURIComponent(t.slice(4)).split(","))&&(a=t+","+e,i=i.replace(t,a)))):i+="&tax="+e,SCM.SearchResults.doSolrSearch({queryString:i,source:"searchresults"}))}),SolrSearch.init=function(){bindUiEvents(),buildSaveSearchUiEvent(),initDateRangeToggle(),restrictedImagesSearch(),$(".js-main").on("click",".collapsible-facet .sf-group-header",function(){var e,t;$(window).outerWidth()<1024&&(t=(e=$(this)).children(".sf-group-header-icon"),e.siblings("fieldset").children(".sf-facets, .sf-facet-list").slideToggle(),e.siblings(".taxonomy-node").slideToggle(),t.hasClass("icon-general_arrow-right")?t.removeClass("icon-general_arrow-right").addClass("icon-general_arrow-down"):t.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right"))}),SCM.QueryBuilder.configure(),0<$(SCM.SearchResults.defaults.updateTargetSelector).length?SCM.QueryBuilder.defaults.runSearch=function(e){SCM.SearchResults.doSolrSearch({queryString:e,source:"searchresults"})}:($(".querybuilder-submit").attr("value","Search"),$(".querybuilder-title").text("Modify your search"),SCM.QueryBuilder.defaults.runSearch=function(e){var t=$("#hfSiteURL").val();-1===e.indexOf("q=")&&(e="q="+e),window.location=window.location.protocol+"//"+t+"/search-results?"+e}),$(".sort-dropdown-option:selected").addClass("selected"),bodyVar.on("click",".sriTopiclink",function(e){doSolrSearch((queryText=$(this).text()).replace(",",""),"f_SemanticFilterTopics"),e.preventDefault()}),bodyVar.on("click","#topicResultsWire",function(e){var t=(t=location.search).substring(0,t.indexOf("&fd_JournalID"));window.location.href="solr/topicresults.aspx"+t})},SolrSearch.ajaxComplete=function(){buildSaveSearchUiEvent(),initDateRangeToggle(),restrictedImagesSearch(),SCM.QueryBuilder.configure(),updateMapResultsButtons(),SCM.SiteJS.initSearchResultsSort()},SCM.SolrSearch.init()}(SCM.SolrSearch=SCM.SolrSearch||{},jQuery);var SCM=SCM||{};!function(ns,$,undefined){ns.loginInstitutionalUser=function(){var instLoginForm=$(".js-inst-login-form");$.ajax({type:"POST",url:"/SignIn/LoginInstitutionalUser",data:{username:instLoginForm.find("input.js-username").val(),password:instLoginForm.find("input.js-password").val()}}).done(function(e){0<e.length?instLoginForm.find(".js-error").removeClass("hide"):(e=$.deparam.querystring().returnUrl)?window.location.assign(decodeURIComponent(e)):window.location.reload()}).fail(function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))})},ns.loginInstitutionalUserClick=function(){$(".js-inst-login-form").find(".js-signin-button").on("click",function(){ns.loginInstitutionalUser()}),$(".js-inst-login-form").on("keypress",function(e){13==e.which&&ns.loginInstitutionalUser()})},$(function(){ns.init()}),ns.init=function(){ns.loginInstitutionalUserClick()}}(SCM.InstitutionLogin=SCM.InstitutionLogin||{},jQuery);var SCM=SCM||{};function GetReturnUrl(){var e,t=window.location.href;return 0<t.indexOf("?")&&(e=window.location.search.split("&"),t=t.substring(0,t.indexOf("?")),!e.length||(e=e.filter(function(e){return"login"!==e.split("=")[0].replace("?","")})).length&&(t+=e.join("&")),t+=window.location.hash),t}SCM.Utilities=SCM.Utilities||{},SCM.AddReturnUrlToSocietyLinks=function(){var t=GetReturnUrl(),t=encodeURIComponent(t),e=$("#hfPlaceholderReturnUrlValue"),n=e.length?e.val():null;$(".society-links-logo, .society-links-url").each(function(){var e;n&&n.length&&(e=$(this)).attr("href",e.attr("href").replace(n,t))})};var SCM=SCM||{};!function(e,l){e.getDocWidth=function(){return self.innerWidth||(document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0)},e.rightPanelHeight=function(){-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&setTimeout(function(){var e;l(".panels").length&&(e=l(window).height()-l(".panels").offset().top,l(".panels").css("height",e),l(".dynamic-widget-inner-wrap").addClass("panel-scroll"))},5e3)},e.hasTabContent=function(e){var n=!0,e=e.find(".widget-dynamic-inner-wrap");return e&&e.length&&(n=!1,e.each(function(e,t){t=l(t).html();if(t&&t.length&&!/^\s*$/.test(t))return!(n=!0)})),n},e.checkInView=function(e,t){var n=l(".article"),a=n.height(),i=(n.scrollTop(),l(e).offset().top+n.offset().top+a/2),e=i+l(e).height(),a=0<=e&&i<=a,t=(e<0&&0<i||0<i&&i<=n.height())&&t;return a||t},e.init=function(){l("body.pg_ArticleSplitView, body.pg_articlesplitview, body.pg_Chapter, body.pg_chapter").removeClass("pg_ArticleSplitView").addClass("pg_article pg_articlesplitview"),e.rightPanelHeight();var t=e.getDocWidth()<1024,o=l("body.pg_articlesplitview .tab"),n=l("body.pg_articlesplitview .panels > .dynamic-widget-inner-wrap"),a=l("body.pg_articlesplitview .panels"),i=l("body.pg_articlesplitview .article");l(".tabs").prepend('<a class="tab tab-FullTextCss"><i class="tab__icon icon-full-text icon-splitview_read"><span class="tab__icon-text">Full Text</span></i><div class="tab__text">Full Text</div></a>');var s=l(".tab-FullTextCss");l(".ref-list [data-content-id]").each(function(){var e=l(this).data("contentId");l(this).attr("data-id",e)}),l("body.pg_articlesplitview .widget-instance-SitePageFooter, body.pg_articlesplitview .site-theme-footer").appendTo(".article"),o.each(function(e){l(this).attr({"data-tab":e,role:"tab","aria-selected":"false"})});var r={};n.each(function(e){l(this).attr({role:"tabpanel","aria-hidden":"false"}),l(this).find("div[content-id]").each(function(){r[l(this).attr("content-id")]=e})}),l(".figure-table-wrapper .table-wrap-title").each(function(){l(this).attr("data-id",this.id)}),o.on("click",function(){t&&i.hide(),a.show(),o.add(s).removeClass("active").attr("aria-selected","false"),l(this).addClass("active").attr("aria-selected","true"),n.hide().attr("aria-hidden","true");var e=l(this).attr("data-tab");return n.eq(e).show().attr("aria-hidden","false"),!1}),l(".pg_articlesplitview").length&&(l("body.pg_articlesplitview .article a[reveal-id]:not(.xref-corresp):not(.split-view-modal)").on("click",function(){var e=l(this).attr("reveal-id").split(" ")[0],t=l(".panels").find('div[data-id="'+e+'"],div[content-id~="'+e+'"i]'),n=l(t).closest(".dynamic-widget-inner-wrap").attr("data-display-order"),e=l(t).closest(".aside").find(".tabs").find('.tab[data-tab="'+n+'"]');if(n)return l(e).click(),l(t).length&&(n=l('.dynamic-widget-inner-wrap[data-display-order="'+n+'"]')).delay(100).animate({scrollTop:n.scrollTop()+t.position().top-10},250),!1}),l(document).on("click","body.pg_articlesplitview a.xref-bibr[data-modal-source-id], body.pg_Chapter a.xref-bibr[reveal-id]",function(){var e,t=l(".ReferencesCss, .split-view-references-pane").parents(".dynamic-widget-inner-wrap"),n=l(".tab-ReferencesCss, .tab-split-view-references-pane"),a=l(this).data("modalSourceId").toLowerCase(),i=l(".aside .ref-list").find("div[data-id='"+a+"']");i.length||((e=a.split(" ")).length&&(a=e[0]),i=l(".aside .ref-list").find("div[data-id='"+a+"']"));t=t.attr("data-display-order");n.hasClass("active")||n.click();t=l('.dynamic-widget-inner-wrap[data-display-order="'+t+'"]');i.length&&t.delay(100).animate({scrollTop:t.scrollTop()+i.position().top-10},250)}),l("body.pg_articlesplitview .article .xref-fn a:not(split-view-modal)").on("click",function(e){var t=l(".tab-ReferencesCss, .tab-split-view-references-pane");t.length&&!t.hasClass("active")&&t.click()}),l("#revealModal.reveal-modal").addClass("fn-modal"),l(".article").scroll(function(){var r=l(".article").scrollTop(),o=l(".article .book-chapter-body");l("#ContentTab h2").each(function(e,t){var n,a,i=l(this).offset().top;o.length?(n=l(this).data("magellan-destination"),a=l('.section-jump-link a[href="#'+n+'"]'),i<300&&i<r&&l(a).length&&(l(".section-jump-link.active").removeClass("active"),l(a).closest(".section-jump-link").addClass("active"))):(n=l(this).attr("id"),a=l('.section-jump-link__link-wrap a[href="#'+n+'"]'),i<300&&i<r&&l(a).length&&(l(".jumplink-list li").removeClass("active"),l(a).closest(".section-jump-link").addClass("active")))})}),l('a.scrollTo[href*="#"]:not([href="#"])').on("click",function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=(e=l(this.hash)).length?e:l("[name="+this.hash.slice(1)+"]"),t=l(".article");if(e.length)return t.delay(100).animate({scrollTop:t.scrollTop()+e.position().top-10},250),!1}})),s.on("click",function(e){o.removeClass("active"),l(this).addClass("active"),a.hide(),i.show()}),l(window).on("resize",function(){!1===(t=e.getDocWidth()<1024)?(i.show(),0===l(".tab.active").not(".tab-FullTextCss").length&&l(".tab:visible").first().trigger("click")):0<l(".tab.active").not(".tab-FullTextCss").length&&l(".tab.active").trigger("click")}),l(function(){var r=0<l("#articlefulltext_figshare").length;n.each(function(e){var t=l(this).find(".widget-dynamic-inner-wrap"),n=t.html(),a=o.eq(e),i=a.is("[class*=supplement]");!n||0===n.length||/^\s*$/.test(n)?r&&i?(l(this).hide(),a.hasClass("js-hascontent")||a.hide()):(l(this).remove(),a.remove()):SCM.SplitScreen.hasTabContent(t)||r&&i||(l(this).remove(),o.eq(e).remove())}),!0===t?(a.hide(),l(s).addClass("active")):l(".tab:visible").first().trigger("click"),l(".linked-name").on("click",function(){l(this).parent(".al-author-name").position().left+300>l(".article").width()&&l(this).next(".al-author-info-wrap").addClass("al-author-info-wrap--right")}),l(".pg_Chapter").find(".tabs, .panels").css("display","inline-flex"),l('.pg_Chapter .tab[data-tab="1"]').addClass("active"),l('.pg_Chapter .panels .dynamic-widget-inner-wrap[data-display-order="1"]').show()})}}(SCM.SplitScreen=SCM.SplitScreen||{},jQuery),function(e){e.init=function(){}}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery);var SCM=SCM||{};function getQueryStringValue(e,t){var n=t+"=",t=e.indexOf(n);return-1===t?null:(t+=n.length,0<=e.indexOf("&",t)?(n=e.indexOf("&",t),e.substring(t,n)):e.substring(t))}function isDefined(e){return void 0!==e&&void 0!==e&&null!=e&&""!==e}function jsonToQueryString(t){return Object.keys(t).filter(function(e){return isDefined(e)}).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}SCM.JournalCitationFilter=function(d){var u="f_JournalDisplayName",h="rg_IssuePublicationDate",p="f_Volume",f="f_IssueNo",m="f_StartPage",e=null,t=null,n=null,a=null,i=null,g=null,v=null,y=null,C=null,b=null,S=null,w=null,k=null,M=null,r=null,o=null,x=null,D=null,A=null,T=null,_=null,j=null,I=null,$=null,F=null,R=null;function s(){var e=document.getElementById("hfJournalCitationFilterLoaded");return!(!e||!e.value)}function l(e,t){return t=t||"",(document.getElementById(e)||{}).value||t}function c(){o.classList.remove("collapsed"),-1!==r.className.indexOf("icon-general-arrow-filled-right")&&(r.classList.remove("icon-general-arrow-filled-right"),r.classList.add("icon-general-arrow-filled-down"))}return{init:function(){s()&&(e=getQueryStringValue(location.search,u),t=getQueryStringValue(location.search,h),n=getQueryStringValue(location.search,p),a=getQueryStringValue(location.search,f),i=getQueryStringValue(location.search,m),g=document.getElementById("SelectedJournal"),v=document.getElementById("Citation_IssuePublicationDate"),y=document.getElementById("Citation_Volume"),C=document.getElementById("Citation_IssueNo"),b=document.getElementById("Citation_StartPage"),S=isDefined(v)?v.getAttribute("pattern"):null,w=isDefined(y)?y.getAttribute("pattern"):null,k=isDefined(C)?C.getAttribute("pattern"):null,M=isDefined(b)?b.getAttribute("pattern"):null,r=document.getElementsByClassName("js-journal-citation-filter-toggle")[0],o=document.getElementsByClassName("journal-citation-filter-input-wrap")[0],x=l("Config_PlaceholderTextJournal"),D=l("Config_PlaceholderTextYear"),A=l("Config_PlaceholderTextVolume"),T=l("Config_PlaceholderTextIssueNo"),_=l("Config_PlaceholderTextStartPage"),j=l("Config_ValidationMessageJournal"),I=l("Config_ValidationMessageYear"),$=l("Config_ValidationMessageVolume"),F=l("Config_ValidationMessageIssueNo"),R=l("Config_ValidationMessageStartPage"),!0===function(){if(isDefined(e)&&isDefined(g)||isDefined(t)&&isDefined(v)||isDefined(n)&&isDefined(y)||isDefined(a)&&isDefined(C)||isDefined(i)&&isDefined(b))return v.value=function(e){if(!isDefined(e))return"";var t=decodeURIComponent(e).split("TO").map(function(e){return e.replace("+","")});return e=0<t.length?t[0]:e,new Date(e).getUTCFullYear()}(t),y.value=n,C.value=a,b.value=i,!0;return!1}()&&c())},applyFilter:function(e,t){var n,a,i,r,o;if(!(c=(n=isDefined(g)&&0<g.options.length&&isDefined(g.options[g.selectedIndex])?g.options[g.selectedIndex].textContent:"",a=isDefined(v)?v.value:"",i=isDefined(y)?y.value:"",r=isDefined(C)?C.value:"",o=isDefined(b)?b.value:"",l={},c="",n===x&&""!==n?c=j+"\n":""!==n&&(l[u]=d.trim(n)),a!==D&&""!==a&&(n=new RegExp(S),isNaN(a)||!n.test(a)?c+=I+"\n":(a="01/01/"+a+" TO 12/31/"+a,l[h]=a)),i!==A&&""!==i&&(new RegExp(w).test(i)?l[p]=i:c+=$+"\n"),r!==T&&""!==r&&(new RegExp(k).test(r)?l[f]=r:c+=F+"\n"),o!==_&&""!==o&&(new RegExp(M).test(o)?l[m]=o:c+=R+"\n"),0<c.length?(alert(c),!1):l)))return!1;var s,l=jsonToQueryString(c),e=(c=(c=e).split("&"),s=[u,h,p,f,m,"page"],(c=c.filter(function(e){e=e.split("=")[0];return s.indexOf(e)<0})).push("page=1"),queryString=c.join("&").trim(),queryString),c="";t&&(c=t.split("&").filter(function(e){e=e.split("=")[0];return"dateFilterType"===e||"noDateTypes"===e}).join("&").trim()),e&&(l+="&"+e),c&&(l+="&"+c);c={queryString:l};return void 0!==(l=d("#hfSiteURL"))&&""!==l.val()&&(SCM.SearchResults.defaults.baseSiteUrl=l.val()),SCM.SearchResults.doSolrSearch(c),!1},toggleWidget:function(){-1!==o.className.indexOf("collapsed")?c():(o.classList.add("collapsed"),-1!==r.className.indexOf("icon-general-arrow-filled-down")&&(r.classList.remove("icon-general-arrow-filled-down"),r.classList.add("icon-general-arrow-filled-right")))},journalCitationFilterLoaded:s}}(jQuery),$(document).ready(function(){function t(){var e=$(".js-journal-citation-filter-update").data("searchUri"),t=window.location.search;t.length&&(t=t.substring(1)),SCM.JournalCitationFilter.applyFilter(e,t)}function n(){$(document).ajaxStart(function(){$(".info-inner-cover").removeClass("uncovered"),$(".info-inner-cover").addClass("covered")}),$(document).ajaxComplete(function(){$(".info-inner-cover").removeClass("covered"),$(".info-inner-cover").addClass("uncovered")})}SCM.JournalCitationFilter.journalCitationFilterLoaded()&&(SCM.JournalCitationFilter.init(),$(document).on("click",".js-journal-citation-filter-update",function(){$(this).addClass("fade"),n(),t()}),$(document).on("keyup",".js-advanced-citation-filter-field",function(e){13===e.keyCode&&(e.preventDefault(),$(".js-journal-citation-filter-update").addClass("fade"),n(),t())}),$(document).on("click",".js-journal-citation-filter-toggle",function(){SCM.JournalCitationFilter.toggleWidget()}),$(document).on("keyup change",".js-advanced-citation-filter-field",function(){$(".js-journal-citation-filter-update").removeClass("fade")}))});var SCM=SCM||{};!function(r,a){var i="";r.getGdprCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var i=n[a].trim();if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""},r.createGdprCookie=function(e,t,n){var a=r.getCookieName(),n=n?((i=new Date).setTime(i.getTime()+24*n*60*60*1e3),"; expires="+i.toGMTString()):"",i=a+"="+encodeURIComponent(t)+n+"; samesite=lax; secure; path=/",t=r.getCookieDomain(),n=null;t&&(document.cookie=i+";domain="+t,n=r.getGdprCookie(a)),t&&n||(document.cookie=i)},r.getCookieName=function(){if(i)return i;var e=a("#hdnClientIdGdpr").val(),t=r.getCookieDomain(),n="GDPR_";return e&&(n=n+e+"_"),t&&(n+=t),n},r.getCookieDomain=function(){return a("#hdnDomainGdpr").val()},r.hideGdprBanner=function(){var e,t=a(".gdpr-cookie-wrapper");navigator.cookieEnabled?(e=r.getCookieName(),r.getGdprCookie(e)&&t.hide()):t.hide()},r.gdprAcceptLinkClick=function(){a(".js-gdpr-cookie-acceptLink, .js-gdpr-cookie-close").on("click",function(e){r.createGdprCookie("GDPR_",!0,365),r.hideGdprBanner(),SCM.ClientStatsMaster&&SCM.ClientStatsMaster.trackGdprCookieAcceptance&&SCM.ClientStatsMaster.trackGdprCookieAcceptance("1050","0","Cookie Acceptance")})},r.init=function(e){e&&(i=e),a(".gdpr-cookie-wrapper").show(),r.gdprAcceptLinkClick(),r.hideGdprBanner()}}(SCM.gdprCookieBanner=SCM.gdprCookieBanner||{},jQuery);var SCM=SCM||{};!function(n,a){var t;a("#sendEmailModal").length&&(t=a("#sendEmailModal")[0].outerHTML),n.htmlEscape=function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},n.htmlUnescape=function(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")},n.readModelValues=function(){return{ExplanatoryTextWithTitle:a("#ExplanatoryTextWithTitle").val(),SenderName:a("#SenderName").val(),SenderEmail:a("#SenderEmail").val(),CopySender:a("#CopySender").is(":checked"),RecipientEmail1:a("#RecipientEmail1").val(),RecipientEmail2:a("#RecipientEmail2").val(),RecipientEmail3:a("#RecipientEmail3").val(),RecipientEmail4:a("#RecipientEmail4").val(),RecipientEmail5:a("#RecipientEmail5").val(),Subject:a("#Subject").val(),OptionalMessage:a("#OptionalMessage").val(),SuccessfulSend:a("#SuccessfulSend").val(),SendersAccountId:a("#SendersAccountId").val(),ClientShortName:a("#ClientShortName").val(),ResourceTitle:a("#ResourceTitle").val(),BookId:a("#BookId").val(),ThankYouName:a("#ThankYouName").val(),ResourceId:a("#ResourceId").val(),ResourceType:a("#ResourceType").val(),FailedRecipients:a("#FailedRecipients").val(),LinkExpirationTime:a("#LinkExpirationTime").val(),HasAccess:a("#HasAccess").val()}},n.sendEmailClickEvents=function(){a("#revealSendEmail").click(function(e){e.preventDefault();e="#SuccessfulSend";a(e.length)&&"True"===a(e).val()&&0<t.length&&(a("#sendEmailModal").replaceWith(t),a("#tseform").removeData("validator"),a("#tseform").removeData("unobtrusiveValidation"),a.validator.unobtrusive.parse(a("#tseform")));e="#sendEmailModal";a(e).length&&(a("body").addClass("on-canvas"),a(e).addClass("open"))}),a(document).on("click",".tse-submit",function(e){e.preventDefault();var t=!0,e=a("#tseform");0<e.length&&(t=e.valid()),t&&(a("#SenderName").val(n.htmlEscape(a("#SenderName").val())),a("#OptionalMessage").val(n.htmlEscape(a("#OptionalMessage").val())),t=n.readModelValues(),a("#sendEmailModal").addClass("on-canvas"),a.post("/Toolbox/ToolboxSendEmailModal/ToolboxSendEmailModel",t,function(e){a("#sendEmailModal").replaceWith(e)}).always(function(){a("#sendEmailModal").addClass("open"),a("#sendEmailModal").removeClass("on-canvas")}))})}}(SCM.ToolboxSendEmail=SCM.ToolboxSendEmail||{},jQuery,$(document)),jQuery(document).ready(function(e){SCM.ToolboxSendEmail.sendEmailClickEvents()});var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LocalStorage=SCM.Utilities.LocalStorage||{},SCM.SharedWidgets=SCM.SharedWidgets||{},SCM.SharedWidgets.UserPersonalization=function(){var i="SharedWidgets.UserPersonalization";return{AddToLocalStorage:function(e,t){var n=$(e),e=r(),a=(e=e||{Items:[]}).Items;n.each(function(){var e=$(this).attr(t),e=JSON.parse(e);a.push(e)}),e.Items=function(e,t){t=e.length-t;0<t&&e.splice(0,t);return e}(a,200),SCM.Utilities.LocalStorage.setItem(i,e)},GetFromLocalStorage:r};function r(){return SCM.Utilities.LocalStorage.getItem(i)}}();var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LocalStorage=function(){"use strict";var a=window.localStorage;return{getItem:function(e,t){e=(t=t||a).getItem("SCM."+e);return JSON.parse(e)},setItem:function(e,t,n){(n=n||a).setItem("SCM."+e,JSON.stringify(t))},removeItem:function(e,t){(t=t||a).removeItem("SCM."+e)}}}(),SCM=SCM||{},SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LazyLoad=function(){var i="lazyLoadInit";return{init:function(e){try{var t="img."+(e=e||"lazy")+":not(."+i+")",t=[].slice.call(document.querySelectorAll(t));if(!t.length)return;("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype?function(e,n){var t=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(r(e=e.target),e.classList.remove(n),t.unobserve(e))})},{rootMargin:"200px 0px 200px 0px"});e.forEach(function(e){t.observe(e),e.classList.add(i)})}:function(e,n){var t=!1,a=function(){!1===t&&(t=!0,setTimeout(function(){e.forEach(function(t){t.getBoundingClientRect().top<=window.innerHeight&&0<=t.getBoundingClientRect().bottom&&"none"!==getComputedStyle(t).display&&(r(t),t.classList.remove(n),0===(e=e.filter(function(e){return e!==t})).length&&(document.removeEventListener("scroll",a),window.removeEventListener("resize",a),window.removeEventListener("orientationchange",a)))}),t=!1},200))};document.addEventListener("scroll",a),window.addEventListener("resize",a),window.addEventListener("orientationchange",a),e.forEach(function(e){e.classList.add(i)})})(t,e)}catch(e){console.error("Exception during SCM.Utilities.LazyLoad.init()",e)}}};function r(e){e.src=e.dataset.src||e.dataset.original,e.dataset.srcset&&(e.srcset=e.dataset.srcset)}}(),SCM=SCM||{},SCM.Utilities=SCM.Utilities||{},SCM.Utilities.Reveal=function(n){var t="data-reveal-id",a="reveal-modal",i="close-reveal-modal",r="open",o="on-canvas",s=n(document.body);return{init:function(e){!function(e){e&&"object"==typeof e&&(e.targetIdAttr&&(t=e.targetIdAttr),e.modalClass&&(a=e.modalClass),e.closeTriggerClass&&(i=e.closeTriggerClass),e.modalOpenClass&&(r=e.modalOpenClass),e.bodyOpenClass&&(o=e.bodyOpenClass))}(e);e="*["+t+"]";s.on("click",e,function(e){e=e.currentTarget,e=n(e).attr(t),(e=n("#"+e)).length&&l(e)});e="."+i;s.on("click",e,function(e){e=e.currentTarget,(e=n(e).closest("."+a)).length&&c(e)})},open:l,close:c,toggle:function(e){("string"==typeof e||e instanceof Element)&&(e=n(e));e.each(function(e,t){t=n(t);(t.hasClass(r)?c:l)(t)})}};function l(e,t){("string"==typeof e||e instanceof Element)&&(e=n(e)),e.addClass(r),t&&o&&s.addClass(o)}function c(e){("string"==typeof e||e instanceof Element)&&(e=n(e)),e.removeClass(r),o&&s.removeClass(o)}}(jQuery);var SCM=SCM||{};SCM.Focus=function(a){var i='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), select:not([disabled]), input:not([disabled]):not([type="hidden"])';return{trap:function(e){var t=a(e).first();!function(e){var t=a(document.activeElement).first();e.data("lastFocusedElement",t)}(t);e=function(e){return e.find(i)}(t);(function(a){t.on("keydown.SCM.Focus",function(e){var t,n;!e||"Tab"!==e.key&&"Tab"!==e.code||(e.shiftKey?(n=e,t=(t=a).filter(":visible"),document.activeElement===t.first()[0]&&(t.last().trigger("focus"),n&&n.preventDefault&&n.preventDefault())):(n=e,e=(e=a).filter(":visible"),document.activeElement===e.last()[0]&&(e.first().trigger("focus"),n&&n.preventDefault&&n.preventDefault())))})})(e),e.filter(":visible").first().trigger("focus")},release:function(e){e=a(e).first();e.off("keydown.SCM.Focus"),function(e){(e=function e(t){t=a(t).first();if(t.is("body"))return t;if(t.is(i)&&t.is(":visible"))return t;var n=t.siblings(i).filter(":visible");if(n.length)return n.first();return e(t.parent())}(e.data("lastFocusedElement")))&&e.length&&e.first().trigger("focus")}(e)}}}(jQuery);var SCM=SCM||{};SCM.Modals=function(a){var n,i,r,o="data-modal-source-id",s="data-modal-source-url",l="data-content-id",c="content-id";return{init:function(){r=a(document.body),n=a("#globalModalContainer"),i=a("#globalModalContent"),r.on("click","*["+o+"], *["+s+"]",e),r.on("click",".js-close-modal",t),r.on("click",".js-modal-overlay",t),r.on("keyup",function(e){"escape"===e.code.toLowerCase()&&t()})}};function e(e){var t,n=a(e.currentTarget);t=n,a(".pg_ArticleSplitView, .pg_articlesplitview").length&&t.hasClass("xref-bibr")||(e&&e.preventDefault&&e.preventDefault(),(e=(e=n.data(u(o)))&&e.trim().toLowerCase())?(e=e)&&"string"==typeof e&&(e=e.split(" ").map(function(e){return"*["+l+'="'+e+'"], *['+c+'="'+e+'"]'}).join(", "))&&(i.empty(),d(a(e))):(n=(n=n.data(u(s)))&&n.trim(),(n=n)&&SCM.Ajax.get(n).expectHtml().then(function(e){d(e)}).catch(function(e){console.error("Failed to display AJAX modal content.  ",e)})))}function d(e){var t;e&&e.trim&&(e=e.trim()),e?(t=e)&&t.jquery?d(e.get().map(function(e){return e.outerHTML}).join("\n")):"string"==typeof e?(i.html(e),i.children().removeClass("modal-only-content"),r.addClass("modal-open"),n.addClass("open"),SCM.Focus.trap(n)):console.error("Request to show modal with unsupported content type: "+typeof e):console.error("Request to show modal with no content")}function t(){n.removeClass("open"),r.removeClass("modal-open"),SCM.Focus.release(n)}function u(e){return e.replace(/^data-/,"").replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}}(jQuery);var SCM=SCM||{};SCM.SharedWidgets=SCM.SharedWidgets||{},SCM.SharedWidgets.UserPersonalization=SCM.SharedWidgets.UserPersonalization||{},SCM.SharedWidgets.AsyncWidgetLoader=function(){return{LoadWidget:loadWidget};function loadWidget(elementClass,elementAttrUrl,elementAttrParams,requestType){var domItems=$(elementClass);domItems.each(function(){var domObj=$(this),dataUrl=domObj.attr(elementAttrUrl),dataParams=domObj.attr(elementAttrParams),params=buildParameters(dataParams);$.ajax({url:dataUrl,data:params,type:requestType,success:function(e){domObj.parent().replaceWith(e),"object"==typeof SCM.EventEmitter&&SCM.EventEmitter.publish(elementClass+"_LOADED")},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}})})}function buildParameters(e){var t=JSON.parse(e),n=t.parameters,e=t.dynamicParameters;return void 0!==e&&void 0!==e.localParams&&"[REPLACE_WITH_LOCAL]"===e.localParams&&(t=SCM.SharedWidgets.UserPersonalization.GetFromLocalStorage(),e.localParams=t,n.Items=JSON.stringify(t)),n}}(),jQuery(document).ready(function(e){SCM.SharedWidgets.AsyncWidgetLoader.LoadWidget(".SCM-SharedWidgets-AsyncWidgetLoader","data-url","data-params","POST")});var App=App||{};!function(e,a){e.Init=function(){a(".js-open-update-alerts-modal").off("click"),a(".js-delete-alert").off("click"),a(".js-update-alerts").off("click"),a(".js-alert-select").off("change"),a(".js-new-alert-select").off("change"),a(".js-open-update-alerts-modal").on("click",App.MyAlerts.OpenModal),a(".js-delete-alert").on("click",App.MyAlerts.DeleteAlert),a(".js-update-alerts").on("click",App.MyAlerts.UpdateAlerts),a(".js-new-alert-select").on("change",App.MyAlerts.UpdateScheduleIdAttribute),a(".js-alert-select").on("change",App.MyAlerts.UpdateAlertSchedule)},e.OpenModal=function(){var e=a("#"+a(this).data("reveal-id"));e&&(a(e).addClass("open"),a(".reveal-modal").css("top","25vh"),a("body").addClass("on-canvas"))},e.CloseModal=function(){a(this).closest(".reveal-modal").removeClass("open"),a("body").removeClass("on-canvas")},e.BuildAlertItem=function(e){var t={};return t.SiteId=e.data("siteid"),t.AlertType=e.data("alerttypeid"),t.ResourceId=e.data("resourceid"),t.ResourceTypeId=e.data("resourcetypeid"),t.IsSubscribed=!!e.prop("checked"),t.ScheduleId=e.data("scheduleid"),t.AlertGroupNumber=e.data("groupnumber"),t},e.UpdateScheduleIdAttribute=function(){var e=a(this);e.prev('input[type="checkbox"]').attr("data-scheduleid",e.val())},e.UpdateAlertSchedule=function(){var e={};e.SiteId=a(this).data("siteid"),e.AlertType=a(this).data("alerttypeid"),e.ResourceId=a(this).data("resourceid"),e.ResourceTypeId=a(this).data("resourcetypeid"),e.IsSubscribed=!0,e.ScheduleId=a(this).val();e=[e];App.MyAlerts.PostUpdate(e,a(this))},e.DeleteAlert=function(){var e=[App.MyAlerts.BuildAlertItem(a(this))];App.MyAlerts.PostUpdate(e,a(this))},e.UpdateAlerts=function(){var e=a(this),t=e.closest("#"+a(this).data("modalid")).find('input[type="checkbox"]'),n=[];t.each(function(){var e=App.MyAlerts.BuildAlertItem(a(this));n.push(e)}),App.MyAlerts.PostUpdate(n,e)},e.PostUpdate=function(e,t){var a;(function n(e){return r(e).then(function(e){var t=a.splice(0,i);return t.length?n(t):e})})((a=e).splice(0,i)).then(function(e){t.closest(".js-alert-details").find(".close-reveal-modal").click(),t.closest(".js-alert-details").html(e),App.MyAlerts.Init()}).catch(function(e){alert("Unable to update your alerts, please contact customer service"),console.error(e)})};var i=100;function r(e){return a.ajax({type:"POST",url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Content/MyAlerts",cache:!1,data:JSON.stringify(e),contentType:"application/json"}).promise().then(function(e){return e||Promise.reject("Invalid response")})}jQuery(function(){App.MyAlerts.Init()})}(App.MyAlerts=App.MyAlerts||{},jQuery);var SCM=SCM||{},App=App||{};!function(a,i,r){var o="instOpenUrlKey_";a.replaceOpenUrlPlaceHolders=function(e,t){null!==t&&""!==t&&e.each(function(){var e=i(this).attr("data-targetId"),e=t.replace("{openUrlTargetId}",e);i(this).html(e),i(this).parent().show()})},a.getAndReplaceOpenUrlPlaceHolders=function(n){i.ajax({type:"POST",url:"/ThirdParty/InstitutionOpenUrlTemplate",dataType:"json",success:function(e){var t;null!==e&&"undefined"!==e&&(t="",1==e.DisplayOpenUrlLink&&(t=null!==e.LinkImageSource&&""!==e.LinkImageSource?" <a target='_blank' href='"+e.TargetUrl+"'><img src='"+e.LinkImageSource+"'/></a> ":" <a target='_blank' href='"+e.TargetUrl+"'> "+e.LinkImageText+" </a> "),a.replaceOpenUrlPlaceHolders(n,t),null!==r&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo&&void 0!==window.App.LoginUserInfo.currentSessionId&&r.setItem(o+window.App.LoginUserInfo.currentSessionId,t,window.sessionStorage))},error:function(e){}})},a.checkAndReplaceOpenUrlPlaceHolders=function(){var e,t;void 0!==window.App.LoginUserInfo&&0<window.App.LoginUserInfo.isInstLoggedIn&&(null!=(e=i('span[class="inst-open-url-holders"]'))&&0<e.length&&(null!==r&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo.currentSessionId&&null!==(t=r.getItem(o+window.App.LoginUserInfo.currentSessionId,window.sessionStorage))?a.replaceOpenUrlPlaceHolders(e,t):a.getAndReplaceOpenUrlPlaceHolders(e)))},a.init=function(){a.checkAndReplaceOpenUrlPlaceHolders()},a.init()}(SCM.InstitutionOpenUrl=SCM.InstitutionOpenUrl||{},jQuery,SCM.Utilities.LocalStorage);var SCM=SCM||{};SCM.RedeemCode=function(t){var n,a,i,r;return{init:o};function o(){return!!(a=t("#js-redeem-code-button")).length&&(n=t("#js-redeem-code-input"),i=t("#js-redeem-code-modal"),r=t("#js-redeem-code-messages"),a.off("click"),a.on("click",e),!0)}function e(){var e=t.trim(n.val());e&&(a.off("click"),t("body").addClass("on-canvas"),t.ajax({type:"POST",url:"/UserDashboard/RedeemCode",cache:!1,data:JSON.stringify({productCode:e}),contentType:"application/json"}).done(function(e){e?(r.html(e.Messages[0]),i.length&&t(i).addClass("open")):alert("Unable to process your request, please contact customer service"),o()}).fail(function(){alert("Unable to process your request, please contact customer service")}))}}(jQuery),jQuery(function(){SCM.RedeemCode.init()});var SCM=SCM||{};SCM.IssueCovers=function(t){var n,a,i,r,e=".js-cover-image-click";return{init:function(){if(t(e).length)return n=t(".js-cover-view-large"),a=t(".js-cover-view-large-img"),i=t(".js-cover-view-large-caption-wrap"),r=t(".js-cover-view-large-caption-text"),t(".widget-IssueCoverBrowse").on("click",e,o),!0;return!1}};function o(){var e=t(this);a.attr("src",""),a.attr("src",e.attr("data-src")),e.attr("data-caption").length?(i.removeClass("hide"),r.html(e.attr("data-caption"))):i.addClass("hide"),t("body").addClass("on-canvas"),n.addClass("open")}}(jQuery),jQuery(function(){SCM.IssueCovers.init()});var SCM=SCM||{};SCM.FormWidget=function(o){return{formSubmit:function(){0<o(".widget-DynamicForm").length&&o(".js-widget-dynamic-form").on("submit",function(e){e.preventDefault();var i=o(".js-widget-dynamic-form-container"),r=o(".js-widget-dynamic-form"),t=r.serialize(),n=i.find("#g-recaptcha-response").val(),e=o("#FormInstanceName").val(),t={CaptchaResponse:n,Responses:t};return o.ajax({type:"POST",url:"/Common/DynamicFormSubmit/"+e,data:JSON.stringify(t),contentType:"application/json"}).done(function(e){var t,n,a;e.Success?(t=r.find(".message-success"),n=o("<div/>"),o.each(e.Messages,function(e,t){n.append(t)}),i.addClass("hide"),t.html(n.html()).show()):void 0!==e.Messages&&e.Messages.length&&(a=o("<ul></ul>"),o.each(e.Messages,function(e,t){a.append("<li>"+t+"</li>")}),r.find(".js-error-message").html(a).removeClass("hide"))}),!1})},getMaxCharacters:function(){o(".js-form-textarea").on("keyup",function(){var e,t,n=o(this).data("maxLength");o(this).parent().find(".js-remaining-characters").text((e=o(this),t=n,n=o(e).val().length,t<n?(o(e).val(o(e).val().substring(0,t)),0):(t-n).toString()))})}}}(jQuery);var SCM=SCM||{};SCM.Pagination=function(a){return{init:function(){a(".js-pagination-click").length&&a("body").on("click",".js-pagination-click",function(){var e=a(this),t=e.data("click-handler").split(".");window[t[0]][t[1]][t[2]](e)})},performAjaxPagination:function(e,t){{var n;t.data("elem-to-replace")?(n=a(t.data("elem-to-replace")))?a.ajax(e).done(function(e){n.html(e)}).fail(function(e,t,n){window.console&&(console.log("error: "+e.responseText),console.log("status: "+t))}):alert("Unable to find an element to respond to ajax response."):alert("The elem-to-replace data attribute was not populated.  You must populate this in the Widget's view to pass back the call to performAjaxPagination")}},updateBrowseHistory:function(e,t){var n={pagination:t};history.pushState&&(null!==history.state&&history.state.pagination||history.replaceState({pagination:document.URL},null,document.URL),history.pushState(n,null,t))},enableBrowserHistoryNavigation:function(){window.addEventListener("popstate",function(e){e.state&&history.state.pagination&&(window.location=e.state.pagination)})},trimEndUntilRegexMatches:function(e,t){for(;!e.match(t);)if(0===(e=e.substr(0,e.length-1)).length)return alert("SCM.Pagination.trimEndUntilRegexMatches: The entire string was trimmed, this likely indicates a problem with your regex pattern.  Note:  This method expects a regular expression literal (see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)"),"";return e},scrollToTop:function(){a(window).scrollTop(0)}}}(jQuery),jQuery(function(){SCM.Pagination.init()});var SCM=SCM||{};SCM.ArticlesByType=function(t){var n,a,i;return{init:function(){{var e;t(".widget-ArticlesByTypeList").length&&(e=t(".js-ArticlesByTypeList"),n=SCM.Pagination.trimEndUntilRegexMatches(document.URL.valueOf(),"[a-zA-Z]$"),a=e.data("journal-id"),i=e.data("article-type-id"),SCM.Pagination.enableBrowserHistoryNavigation())}},handlePaginationClick:function(e){SCM.Pagination.updateBrowseHistory(n,n);var t={type:"POST",url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Article/ArticlesByTypeList/"+e.data("parent-instance"),cache:!1,data:{journalId:a,page:e.data("clicked-page"),articleClientType:i}};SCM.Pagination.performAjaxPagination(t,e)}}}(jQuery),jQuery(function(){SCM.ArticlesByType.init()});var SCM=SCM||{};SCM.CitedByPagination=function(e){var n,a;return{init:function(){e(".widget-CrossRefCitedBy").length&&(n=SCM.Pagination.trimEndUntilRegexMatches(document.URL.valueOf(),/[a-zA-Z]\/\d+$/),a=n.match(/[a-zA-Z]\/(\d+)$/)[1],SCM.Pagination.enableBrowserHistoryNavigation())},handlePaginationClick:function(e){SCM.Pagination.updateBrowseHistory(n,n+"/"+e.data("clicked-page"));var t={type:"POST",url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/ThirdParty/CrossRefCitedBy/"+e.data("parent-instance"),cache:!1,data:{selectedPage:e.data("clicked-page"),articleId:a}};SCM.Pagination.performAjaxPagination(t,e)}}}(jQuery),jQuery(function(){SCM.CitedByPagination.init()});var SCM=SCM||{};SCM.MyInstitutionalTokens=function(e){var n;return{init:function(){e(".widget-MyInstitutionalTokens").length&&(n=SCM.Pagination.trimEndUntilRegexMatches(document.URL.valueOf(),"[a-zA-Z]$"),SCM.Pagination.enableBrowserHistoryNavigation())},handlePaginationClick:function(e){SCM.Pagination.updateBrowseHistory(n,n);var t={type:"POST",url:"/UserDashboard/MyInstitutionalTokens/"+e.data("parent-instance"),cache:!1,data:{selectedPage:e.data("clicked-page")}};SCM.Pagination.performAjaxPagination(t,e)}}}(jQuery),jQuery(function(){SCM.MyInstitutionalTokens.init()});var SCM=SCM||{};SCM.CompactAddToCartButton=function(n){var i;return{init:function(){if(!n(".js-addToCartButton").length&&!n(".js-bulk-cart-add").length)return;i=SCM.CompactAddToCartButton.DataService,function(){var e=n("#main");e.on("click",".js-addToCartButton",function(){var t,e=n(this);t=e.data("resourceId"),e=e.data("resourceTypeId"),i.addResourceToCart(t,e).then(function(e){o(e),l(t),c()}).catch(function(e){console.error("Failed to add resource to cart.",e)})}),e.on("click","#js-add-to-cart-success-modal .js-close-modal",function(){n("#js-add-to-cart-success-modal").removeClass("open")}),e.on("change",".js-checkBoxClass",t),e.on("click",".js-bulk-cart-add",h),e.on("click",".js-bulk-cart-add-issue",f),e.ajaxComplete(m)}(),a(),r()}};function a(){n(".js-addToCartButton").each(function(){var e=n(this);"True"!==e.data("userRestricted")&&s(e.data("resourceId"))?e.data("userRestricted","False"):e.data("userRestricted","True"),"False"===e.data("userRestricted")&&e.hide()})}function r(){i.getResourceIdsAlreadyInCart().then(function(t){n(".js-addToCartButton").each(function(){var e=n(this);t.includes(e.data("resourceId"))&&(e.data("inUserCart","true"),e.addClass("disabled"))})}).catch(function(e){console.error("Failed to get resourceIds in cart.",e)})}function o(e){n(".items-in-cart").length&&e.length&&!isNaN(parseInt(e))&&n(".items-in-cart").text(e)}function s(e){var t;return e&&(SCM.AccessAttributes?(t=e,!SCM.AccessAttributes.filter(function(e){return e.id===t}).map(function(e){return e.availableforpurchase}).shift()):"True"!==n("input.js-checkBoxClass[data-resource-id="+e+"]").data("availableForPurchase"))}function l(e){n(".js-addToCartButton[data-resource-id="+e+"]").attr("data-in-user-cart","true"),n(".js-addToCartButton[data-resource-id="+e+"]").addClass("disabled")}function c(){n("#js-add-to-cart-success-modal").addClass("open")}function t(e){e=n(e.currentTarget).closest("section");e.find(".js-bulk-cart-add").prop("disabled",!d(e));e=n(".section-container");n(".js-bulk-cart-add-issue").prop("disabled",!d(e))}function d(e){return u(e).length}function u(e){return e.find(".js-checkBoxClass:checked").map(function(e,t){return{id:n(t).data("resourceId"),typeId:n(t).data("resourceTypeId")}}).get()}function h(e){p(u(n(e.currentTarget).closest("section")))}function p(a){Array.isArray(a)&&a.length&&i.getResourceIdsAlreadyInCart().then(function(t){var n,e=a.filter(function(e){return!s(e.id)&&!t.includes(e.id)});e.length?(n=e,SCM.CompactAddToCartButton.DataService.addResourcesToCart(n).then(function(e){o(e),n.forEach(function(e){l(e.id)}),c()}).catch(function(e){console.error("Failed to add all resources to cart.",e)})):alert("No selected resources are available for purchase.")}).catch(function(e){console.error("Failed to get resourceIds in cart.",e)})}function f(e){p(u(n(".section-container")))}function m(e,t,n){n.url&&n.url.toLowerCase().includes("searchresults")&&(a(),r())}}(jQuery),SCM.CompactAddToCartButton.DataService=function(n){return{addResourceToCart:function(e,t){return n.ajax({type:"POST",url:"/Store/AddProductToCartAjax/addtocartbutton",data:{resourceId:e,resourceTypeId:t},cache:!1}).promise().then(function(e){return e.Success?!Array.isArray(e.Messages)||e.Messages.length<1||!e.Messages[0].length?Promise.reject("Action did not return expected response"):e.Messages[0]:Promise.reject("Action returned non-success status")})},addResourcesToCart:function(e){e={resources:e.map(function(e){return{Id:e.id,Type:e.typeId}})};return n.ajax({type:"POST",url:"/Store/AddProductsToCartAjax/addtocartbutton",data:e,cache:!1}).promise().then(function(e){return e.Success?!Array.isArray(e.Messages)||e.Messages.length<1||!e.Messages[0].length?Promise.reject("Action did not return expected response"):e.Messages[0]:Promise.reject("Action returned non-success status")})},getResourceIdsAlreadyInCart:function(){return n.ajax({type:"POST",url:"/Store/GetArticleResourcesInCartAjax/addtocartbutton",cache:!1}).promise().then(function(e){return e.Success?Array.isArray(e.Messages)&&e.Messages.length?e.Messages[0].split(",").map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)}):Promise.reject("Action did not return expected response"):Promise.reject("Action return non-success status")})}}}(jQuery),SCM=SCM||{},SCM.Store=function(t){var e,a,n="/store/currency/{currencyCode}";return{init:function(){if(e=t(".js-cart-view"),a=t(".js-order-summary"),!e.length&&!a.length)return;e.find(".js-currency-selector").on("change",function(e){e=t(e.currentTarget).val();e&&(window.location.href=n.replace("{currencyCode}",e))}),a.find(".js-vat-country-select").on("change",function(e){e=t(e.currentTarget).val();SCM.Store.DataService.updateVatCountry(e).then(function(e){var t=a.find(".js-vat-number-wrap");e&&e.ShowVatNumber?t.removeClass("hidden"):t.addClass("hidden")}).catch(function(e){console.error("Failed to update VAT country: "+e),a.find(".js-vat-message").html("Failed to update VAT Country").removeClass("success").addClass("error")})}),a.find(".js-apply-vat-number").on("click",function(e){var t,n=a.find(".js-vat-number").val().trim();n&&(t=a.find(".js-vat-message"),SCM.Store.DataService.updateVatNumber(n).then(function(e){t.html("VAT Number validated").removeClass("error").addClass("success")}).catch(function(e){console.error("Failed to update VAT number: "+e),a.find(".js-vat-message").html("Failed to validate VAT Number").removeClass("success").addClass("error")}))})}}}(jQuery),SCM.Store.DataService=function(t){return{updateVatCountry:function(e){return t.post("/store/UpdateCartVatCountry/Ajax",{countryCode:e}).promise().then(function(e){if(e&&e.Success)return e.Data;e=e&&e.Messages&&e.Messages.length&&e.Messages[0].length?e.Messages[0]:"An unknown error occurred";return Promise.reject(e)})},updateVatNumber:function(e){return t.post("/store/UpdateVatNumber/Ajax",{vatNumber:e}).promise().then(function(e){if(e&&e.Success)return!0;e=e&&e.Messages&&e.Messages.length&&e.Messages[0].length?e.Messages[0]:"An unknown error occurred";return Promise.reject(e)})}}}(jQuery);var SCM=SCM||{};SCM.Ajax=function(o){var e={get:function(e,t){return new a(e,"GET",t)},post:function(e,t){return new a(e,"POST",t)},ajax:function(e,t,n){return new a(e,t,n)},objectToFormData:r};var i={Text:"text",Html:"html",Json:"json",Xml:"xml",ActionResultModel:{Full:"actionResultModelFull",FullEnsureSuccess:"actionResultModelFullEnsureSuccess",Success:"actionResultModelSuccess",Html:"actionResultModelHtml",RedirectUrl:"actionResultModelRedirectUrl",ReturnId:"actionResultModelReturnId",Data:"actionResultModelData"}};function a(e,t,n,a){this._url=e,this._method=t||"GET",this._data=n,this._dataType=a||i.Text,this._internalPromise=null}function t(e){this._ajaxResult=e,this._expectedComponent=i.ActionResultModel.Full,this._internalPromise=null}function s(e,t,n){e=new Error(e);return e.name="AjaxError",e.userFriendlyMessage=t,e.actionResultModel=n,Object.setPrototypeOf(e,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(e,s),e}function n(e,t,n,a){if("function"==typeof window.fetch)return function(e,t,n,a){"GET"===t&&n&&(e=function(e,t){"object"==typeof t&&(t=function(t){return Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")}(t));t&&t.length&&["?","&"].includes(t[0])&&(t=t.substring(1));return e.includes("?")?e+"&"+t:e+"?"+t}(e,n),n=void 0);return fetch(e,{mode:"no-cors",method:t,body:r(n)}).then(function(e){if(!e.ok)throw new s("Bad response from server: "+e.status+": "+e.statusText,"Bad response from server");return a===i.Json?e.json():e.text()}).catch(function(e){throw new s("Request failed: "+e,"Request failed")})}(e,t,n,a);if("function"==typeof o&&o()&&o().jquery)return function(e,t,n,i){var r={url:e,method:t,type:t,data:n,dataType:i};!function(e){return e instanceof FormData&&Array.from(e).filter(function(e){return 1<e.length&&e[1]instanceof File}).length}(n)||(r.contentType=!1,r.processData=!1);return new Promise(function(t,a){o.ajax(r).done(function(e){t(e)}).fail(function(e,t,n){a(new s("parsererror"===t?"Failed to parse response as "+i:n,"Request failed"))})})}(e,t,n,a);throw new Error("No supported AJAX implementations found.")}function r(e){if(e){if(e instanceof FormData||"object"!=typeof e)return e;var t=new FormData;return function n(a,i,r){a=a||new FormData;if(Array.isArray(i))for(var e=0;e<i.length;e++){var t=r+"["+e+"]";n(a,i[e],t)}else c(i)?a.append(r,i.toISOString()):!l(i)||d(i)||u(i)?a.append(r,i):Object.keys(i).forEach(function(e){var t=r?r+"["+e+"]":e;n(a,i[e],t)})}(t,e),t}}function l(e){return e===Object(e)}function c(e){return e instanceof Date}function d(e){return e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.slice}function u(e){return d(e)&&"string"==typeof e.name&&("object"==typeof e.lastModifiedDate||"number"==typeof e.lastModified)}function h(e,t){e=e.then(function(e){if(!e||void 0===e.Success)throw new s("Response does not appear to be an ActionResultModel","Unexpected response from server");return e});if(t===i.ActionResultModel.Full)return e;e=e.then(function(e){if(e.Success)return e;var t,n="Unspecified error";throw(t=e)&&t.Messages&&t.Messages.length?n=e.Messages[0]:(t=e)&&t.ValidationErrors&&t.ValidationErrors.length&&t.ValidationErrors[0].Errors&&t.ValidationErrors[0].Errors.length?n=e.ValidationErrors[0].Errors[0]:e.Html&&(n=e.Html),new s(n,"Request was not successful",e)});return t===i.ActionResultModel.FullEnsureSuccess?e:t===i.ActionResultModel.Success?e.then(function(){return!0}):t===i.ActionResultModel.Html?e.then(function(e){if("string"!=typeof e.Html)throw new s("No HTML was provided in the response","Unexpected response from server",e);return e.Html}):t===i.ActionResultModel.RedirectUrl?e.then(function(e){if("string"!=typeof e.RedirectUrl)throw new s("No RedirectUrl was provided in the response","Unexpected response from server",e);return e.RedirectUrl}):t===i.ActionResultModel.ReturnId?e.then(function(e){if("string"!=typeof e.ReturnId)throw new s("No ReturnId was provided in the response","Unexpected response from server",e);return e.ReturnId}):t===i.ActionResultModel.Data?e.then(function(e){if(void 0===e.Data||null===e.Data||"object"!=typeof e.Data)throw new s("No Data object was provided in the response","Unexpected response from server",e);return e.Data}):e}return a.prototype.then=function(e,t){return this._internalPromise=(this._internalPromise||n(this._url,this._method,this._data,this._dataType)).then(e,t),this},a.prototype.catch=function(e){return this._internalPromise=(this._internalPromise||n(this._url,this._method,this._data,this._dataType)).catch(e),this},a.prototype.finally=function(e){return this._internalPromise=(this._internalPromise||n(this._url,this._method,this._data,this._dataType)).finally(e),this},a.prototype.expectJson=function(){return this._dataType=i.Json,this.then(function(e){return e})},a.prototype.expectHtml=function(){return this._dataType=i.Html,this.then(function(e){return e})},a.prototype.expectText=function(){return this._dataType=i.Text,this.then(function(e){return e})},a.prototype.expectXml=function(){return this._dataType=i.Xml,this.then(function(e){return e})},a.prototype.expect=function(t,n){return"function"==typeof t&&(n=t,t=null),this.then(function(e){if(!n(e))throw new s(t||"Unexpected result from server");return e})},a.prototype.expectActionResultModel=function(){return this._dataType=i.Json,new t(this)},t.prototype.then=function(e,t){return this._internalPromise=(this._internalPromise||h(this._ajaxResult,this._expectedComponent)).then(e,t),this},t.prototype.catch=function(e){return this.intrnalPromise=(this._internalPromise||h(this._ajaxResult,this._expectedComponent)).catch(e),this},t.prototype.finally=function(e){return this._internalPromise=(this._internalPromise||h(this._ajaxResult,this._expectedComponent)).finally(e),this},t.prototype.ensureSuccess=function(){return this._expectedComponent=i.ActionResultModel.FullEnsureSuccess,this},t.prototype.expectSuccess=function(){return this._expectedComponent=i.ActionResultModel.Success,this},t.prototype.expectHtml=function(){return this._expectedComponent=i.ActionResultModel.Html,this},t.prototype.expectRedirectUrl=function(){return this._expectedComponent=i.ActionResultModel.RedirectUrl,this},t.prototype.expectReturnId=function(){return this._expectedComponent=i.ActionResultModel.ReturnId,this},t.prototype.expectData=function(){return this._expectedComponent=i.ActionResultModel.Data,this},s.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(s,Error):s.__proto__=Error,e}(window.jQuery||{}),"object"==typeof module&&module.exports&&(module.exports=SCM.Ajax);var SCM=SCM||{};SCM.Retry=function(){var e={policy:function(){return new t},wait:function(e){return(new t).handleResult(function(){return!0}).waitAndRetry(1,e).execute(function(){}).catch(function(){})}};var a=function(e){return 50};function t(){this._exceptionPredicates=[],this._resultPredicates=[],this._retryCount=0,this._onRetry=null,this._waitTimeCalculator=a}function p(e){e=new Error(e);return e.name="RetryError",Object.setPrototypeOf(e,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(e,p),e}return t.prototype.handleException=function(e){if(void 0===e)this._exceptionPredicates.push(function(){return!0});else{if("function"!=typeof e)throw new p("exceptionPredicate must be a function");this._exceptionPredicates.push(e)}return this},t.prototype.handleResult=function(e){if("function"!=typeof e)throw new p("resultPredicate must be a function");return this._resultPredicates.push(e),this},t.prototype.untilResultIs=function(t){return this._resultPredicates.push(function(e){return e!=t}),this},t.prototype.retry=function(e,t){return void 0===e&&(e=1),"function"==typeof e&&(t=e,e=1),this._retryCount=e,"function"==typeof t&&(this._onRetry=t),this},t.prototype.waitAndRetry=function(e,t,n){if("number"!=typeof e)throw new p("retryCount must be specified as an integer");return this._retryCount=e,void 0!==t&&(this._waitTimeCalculator=function(t,e){if("number"==typeof t)return function(e){return t};if(Array.isArray(t)&&t.length===e){if(t.length!==e)throw new p("Wait time array length must match retryCount");return function(e){return t[e-1]}}return"function"!=typeof t?a:t}(t,e)),"function"==typeof n&&(this._onRetry=n),this},t.prototype.execute=function(s){var l=this._resultPredicates,c=this._exceptionPredicates,d=this._onRetry,u=this._waitTimeCalculator,h=this._retryCount;return new Promise(function(e,n){var a=0;function i(){try{var e=s();(t=e)&&"function"==typeof t.then&&"function"==typeof t.catch?e.then(function(e){r(e)}).catch(function(e){o(e)}):r(e)}catch(e){o(e)}var t}function r(t){l.some(function(e){return e(t)})?a<h?(a++,"function"==typeof d&&d(t,a),setTimeout(i,u(a))):n(new p("retryCount exceeded")):e(t)}function o(t){a<h&&c.some(function(e){return e(t)})?(a++,"function"==typeof d&&d(t,a),setTimeout(i,u(a))):n(t)}i()})},p.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(p,Error):p.__proto__=Error,e}(),SCM.wait=SCM.wait||SCM.Retry.wait,"object"==typeof module&&module.exports&&(module.exports=SCM.Retry);var SCM=SCM||{};SCM.SubjectBrowse=function(t){return{init:function(){t("body").hasClass("pg_Index")&&t("#main").on("click",".js-expand-children-subjects",function(){var e=t(this).closest(".parent-subject");e.hasClass("collapsed")?e.removeClass("collapsed"):e.addClass("collapsed")})}}}(jQuery),SCM=SCM||{},SCM.SharedWidgets=SCM.SharedWidgets||{},function(e,t){e.init=function(){SCM.SharedWidgets.UserPersonalization.AddToLocalStorage(".SCM-SharedWidgets-LocalStorage-UserContentAccessWrite","data-values")},t(function(){e.init()})}(SCM.PersonalizedContent=SCM.PersonalizedContent||{},jQuery);var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},function(e,n){function t(e){var t;e.length&&(e.each(function(){var e=n(this);e.attr("data-video-id",encodeURIComponent(e.attr("data-video-id")).replace("ref%3A","ref:"))}),t=e.data("player"),t="//players.brightcove.net/"+e.data("account")+"/"+t+"_default/index.min.js",n.getScript(t,function(){}))}e.init=function(){t(n(".brightcove-wrapper video.video-js")),t(n(".brightcove-wrapper-audio video.video-js"))}}(SCM.Utilities.Brightcove=SCM.Utilities.Brightcove||{},jQuery);var ArtMetric={fullVersion:function($dest,routeUrl){var baseSiteUrl;$dest.find(".widget-ArticleLevelMetrics").length<1&&(baseSiteUrl=$("#hfSiteURL"),void 0!==baseSiteUrl&&void 0!==baseSiteUrl.val()&&""!=baseSiteUrl&&(routeUrl="//"+baseSiteUrl.val()+routeUrl),$.ajax({url:routeUrl,datatype:"HTML",success:function(e){$dest.prepend(e),setTimeout(function(){void 0!==window.ChartistData&&ArtMetric.createChart(".ct-chart",window.ChartistData.data,{lineSmooth:!1,showArea:!0,low:0},[["screen and (max-width: 1024px)",{axisX:{labelInterpolationFnc:function(e){return e.slice(0,3)}}}],["screen and (min-width: 1px)",{axisX:{labelInterpolationFnc:function(e){return e}}}]])},200),$(".artmet-dimensions").length&&window.__dimensions_embed&&window.__dimensions_embed.addBadges&&window.__dimensions_embed.addBadges()},error:function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}}))},limitLabels:function(){var e=$(".ct-horizontal.ct-label"),t=e.length,n=Math.ceil(t/8),a=1;e.not(":eq(0)").each(function(){a%n!=0&&$(this).hide(),a++})},createChart:function(e,t,n,a){var a=new Chartist.Line(e,t,n,a),i=0;a.on("created",function(){i=0,ArtMetric.limitLabels()}),a.on("draw",function(e){"line"!==e.type&&"point"!==e.type&&"area"!==e.type||i++,"line"===e.type?e.element.animate({opacity:{begin:25*i+150,dur:250,from:0,to:1}}):"point"===e.type?e.element.animate({x1:{begin:25*i,dur:250,from:e.x-10,to:e.x,easing:"easeOutQuart"},x2:{begin:25*i,dur:250,from:e.x-10,to:e.x,easing:"easeOutQuart"},opacity:{begin:25*i,dur:250,from:0,to:1,easing:"easeOutQuart"}}):"area"===e.type&&e.element.animate({opacity:{begin:25*i+250,dur:300,from:0,to:1}})})},triggerModal:function(e,t){t="/ThirdParty/ArticleLevelMetricsDetails?articleId="+t+"&showDimensionsBadge="+($(".artmet-dimensions").length?"true":"false");ArtMetric.fullVersion(e,t);e=$(".artmet-modal"),t=$("body");e.css({display:"block",opacity:1}),t.addClass("metrics-modal-open")},closeModal:function(){var e=$(".artmet-modal"),t=$("body");e.attr("style",""),t.removeClass("metrics-modal-open")},eventsToClose:function(){$(".artmet-close-modal").click(function(){ArtMetric.closeModal()}),$(".artmet-modal").click(function(){$(event.target).closest(".artmet-modal-contents").length||ArtMetric.closeModal()})}};$(document).ready(function(){$(".artmet-modal-trigger, .artmet-condensed-stats .artmet-views").click(function(){var e=$(".artmet-modal-trigger").attr("data-article-id");ArtMetric.triggerModal($(".artmet-modal-contents"),e)}),ArtMetric.eventsToClose()});var SCM=SCM||{};function insertArticleLinksIntoReferences(){var a,t,e=$("#js-hfArticleLinksReferencesDoiRegex").val();e&&(a=new RegExp(e,"g"),!(t=$(".ref-list").children("div").map(function(e,t){var n=$(t).html().match(a);return n&&n.length?{elem:t,doi:n[0]}:null}).filter(function(e,t){return!!t&&!!t.elem&&!!t.doi})).length||(e=t.map(function(e,t){return t.doi}).get().filter(function(e,t,n){return n.indexOf(e)===t}))&&e.length&&$.post("/Article/ArticleUrlsByDoi",{dois:e.toString()}).promise().then(function(a){if(!a||!a.Success){var e=$.Deferred();return e.reject(a.Messages&&a.Messages.length?a.Messages[0]:"Unknown error"),e}t.each(function(e,t){var n;t.elem&&t.doi&&a.Result[t.doi]&&(n=$(t.elem).find(".js-ref-link").first(),t=$("<div>").addClass("article-ref-link js-ref-link").html($("<a>").attr("href",a.Result[t.doi]).html("Article")),n.before(t))})}).then(null,function(e){console.error("Unable to look up resource URLs for DOIs"),console.error(e)}))}!function(e,t,n,a){var i=t("#ArticleFullTextWrap"),r=!1;i&&i.attr("data-userHasAccess")&&(r="true"===i.attr("data-userHasAccess").toLowerCase()),e.replaceContentLinks=function(){r||i.find("a[data-reveal-id]").each(function(){t(this).replaceWith(function(){return"<span>"+this.innerHTML+"</span>"})})},e.init=function(){e.replaceContentLinks(),a&&a.init(),n&&n.init()},insertArticleLinksIntoReferences()}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery,SCM.InstitutionOpenUrl,SCM.Utilities.Brightcove);var SCM=SCM||{};!function(e,o){e.init=function(){var e=o(".widget-ArticleLinks");e.length&&e.each(function(){var e=o(this),t=e.find(".js-view-more-div"),n=e.find(".js-view-less-div"),a=e.find(".js-view-more-div > .js-view-more-a"),i=e.find(".js-view-less-div > .js-view-less-a"),r=e.find(".cc-row.js-more");a.length&&a.on("click",function(e){r.removeClass("hide"),n.removeClass("hide"),t.addClass("hide")}),i.length&&i.on("click",function(e){r.addClass("hide"),n.addClass("hide"),t.removeClass("hide")})})}}(SCM.ArticleLinks=SCM.ArticleLinks||{},jQuery);var SCM=SCM||{};!function(pbby,$,undefined){pbby.clickEvents=function(){$(".master-main").on("click",".js-bby-decade",function(){if($(this).hasClass("selected"))return!0;$(".js-bby-decade").removeClass("selected"),$(this).toggleClass("selected"),$(".js-bby-years").addClass("hide");var e=$(".js-bby-decadeYears").find('[data-decade="'+$(this).data("decade")+'"]');e.length&&e.removeClass("hide"),$(".js-bby-year").removeClass("selected");e=e.children(".js-bby-year").last();e.length&&e.trigger("click")}),$(".master-main").on("click",".js-bby-year",function(){if($(this).hasClass("selected"))return!0;$(".js-bby-year").removeClass("selected"),$(this).toggleClass("selected");var e=$(this).data("year");pbby.getConferencesByYear(e)}),$(".master-main").on("click",".js-conference-list-item",function(){var e=$(this).closest(".js-conference-list-resources-item").attr("data-conferenceId"),t=$('.js-conference-volume-list[data-conferenceId="'+e+'"]');0==t.html().trim().length&&pbby.getVolumeListByConferenceId(e),$(this).find("i").toggleClass("icon-general-add icon-general_minus"),t.toggleClass("hide")})},pbby.getConferencesByYear=function(year){var $conferenceListLocation=$(".js-bby-conferenceList"),baseSiteUrl=$("#hfSiteURL"),ajaxUrl="//"+baseSiteUrl.val()+"/Proceeding/ConferenceListByYear";$.ajax({url:ajaxUrl,type:"GET",data:{year:year}}).done(function(e){e.length?$conferenceListLocation.html(e):window.console&&console.log("getConferenceByYear returned no data.")}).fail(function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))})},pbby.getVolumeListByConferenceId=function(conferenceId){var volumeListLocationId=$('.js-conference-volume-list[data-conferenceId="'+conferenceId+'"]'),baseSiteUrl=$("#hfSiteURL"),ajaxUrl="//"+baseSiteUrl.val()+"/Proceeding/ConferenceVolumeListResources";$.ajax({url:ajaxUrl,type:"GET",data:{conferenceId:conferenceId}}).done(function(e){e.length?$(volumeListLocationId).html(e):window.console&&console.log("getConferenceByYear returned no data.")}).fail(function(xmlHttpRequest,textStatus,errorThrown){var err;window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))})},pbby.init=function(){pbby.clickEvents()}}(SCM.Proceedingsbby=SCM.Proceedingsbby||{},jQuery),jQuery(function(e){SCM.Proceedingsbby.init()});var SCM=SCM||{},AdButler=AdButler||{};AdButler.ads=AdButler.ads||[],function(s,l){s.HandleMobile=function(e,t){},s.SetupAd=function(t,n,a,i,e){var r=window.abkw||"";AdButler.ads.push({handler:function(e){AdButler.register(i,t,n[0],a,e)},opt:{place:a,keywords:r,domain:"servedbyadbutler.com",click:"CLICK_MACRO_PLACEHOLDER"}}),AdButler.addEventListener("adbutlerOnLoad",s.showAdvertisementText)},s.Init=function(){var o=SCM.SplitScreen&&SCM.SplitScreen.getDocWidth()<767;return l(".hfAdBlockInfo[data-adprovider-typeid=2]").each(function(e,t){var n=l(t),a=n.data("targetname"),i=n.data("slotname"),r=n.data("sizes"),t=n.data("divid"),n=n.data("enabled-on-mobile");if(o&&"False"==n)return!1;i&&r&&t&&s.SetupAd(i,r,t,a,n)}),!0},s.showAdvertisementText=function(){l(".js-adblock-advertisement-text").each(function(){var e=l(this).siblings(".js-adblock");e&&e.is(":visible")&&1<e.find("*").length&&l(this).removeClass("hide")})},l(function(){s.Init()})}(SCM.AdButlerAds=SCM.AdButlerAds||{},jQuery);var SCM=SCM||{};!function(ns,$){ns.initChapterAbstractClickEvent=function(){$(".master-main").on("click",".js-showChapterAbstractLink",function(){var wrapperDiv=$(this).closest("div[data-chapter-abstract-to-be-fetched-wrapper]"),chapterId=$(wrapperDiv).attr("data-chapterid-for-abstract"),bookId=$(wrapperDiv).attr("data-bookid-for-abstract"),triedFetchDiv=$(wrapperDiv).children("div[data-tried-to-fetch-abstract]").first(),triedFetch="true"===$(triedFetchDiv).attr("data-tried-to-fetch-abstract"),abstractLocation=$("#abstract-"+chapterId),baseSiteUrl=$("#hfSiteURL"),abstractLinks=$("#abstract-"+chapterId+"-links"),ajaxUrl="extract"==$(this).parent().attr("data-link-chapter-abstract-type")?"/PlatformBook/ChapterAbstractOrExtractAjax":"/PlatformBook/ChapterAbstractAjax";baseSiteUrl&&baseSiteUrl.val()&&(ajaxUrl="//"+baseSiteUrl.val()+ajaxUrl),$(abstractLocation).closest("li").toggleClass("abstractExpanded"),triedFetch||($(abstractLocation).append('<div class="spinner"></div>'),$.ajax({url:ajaxUrl,type:"GET",data:{chapterId:chapterId,bookId:bookId},success:function(e){abstractLocation.html(e.Html),abstractLocation.append(abstractLinks.html())},error:function(xmlHttpRequest,textStatus,errorThrown){var err;$(abstractLocation).find(".spinner").remove(),window.console&&(err=eval("("+xmlHttpRequest.responseText+")"),console.log("error: "+err),console.log("status: "+textStatus))}}),$(triedFetchDiv).attr("data-tried-to-fetch-abstract","true")),abstractLocation.toggleClass("hide");var $thisAbstractIcon=wrapperDiv.find(".abstract-toggle-icon"),toggleIconClass=$thisAbstractIcon.attr("data-icon-class"),downArrow=toggleIconClass+"-down",upArrow=toggleIconClass+"-up";$thisAbstractIcon.toggleClass(downArrow),$thisAbstractIcon.toggleClass(upArrow)})}}(SCM.ChapterAbstract=SCM.ChapterAbstract||{},jQuery),jQuery(document).ready(function(e){SCM.ChapterAbstract.initChapterAbstractClickEvent()});var App=App||{};!function(e,n){e.mobileContentNav=function(){n(".toggle-left-col").click(function(e){e.stopPropagation(),n("body").addClass("on-canvas"),n(".page-column--left").addClass("expanded")}),n(".toggle-left-col__close, .info-widget-wrap a, .mobile-mask").click(function(){n(".page-column--left").removeClass("expanded"),n("body").removeClass("on-canvas")})},e.siteMenuDropdown=function(){n(".js-nav-link").click(function(e){n(this);var t=n(this).next(".site-menu");e.stopPropagation(),n(".site-menu-item .site-menu").not(t).css("display","none"),t.slideToggle("fast",function(){n(this).is(":visible")&&n(this).css("display","block")}),n(document.body).on("click",function(e){n(t).css("display","none")})}),n(".js-toolbar-search-trigger").click(function(){n(".toolbar-search").toggleClass("expanded")})},e.contentModals=function(){n(".pg_ArticleSplitView, .pg_articlesplitview").length||n("a[reveal-id]").each(function(){var e,t;n(this).hasClass("xref-fn")?(n(this).click(function(){var e=n(this).attr("reveal-id"),e=n('.fn[content-id="'+e+'"]'),e=n(e).html();n("body").addClass("on-canvas"),n(e).clone().appendTo("#revealModal #revealContent").addClass("ref-modal"),n(".ref-modal").closest(".reveal-modal").addClass("open")}),n(".close-reveal-modal").on("click",function(e){n(this).closest(".reveal-modal").removeClass("open"),n(".ref-modal").html("").removeClass("ref-modal"),n("body").removeClass("on-canvas")})):(e=n(this).attr("reveal-id"),t=n('.reveal-modal[content-id="'+e+'"]'),n(this).click(function(e){n(t).length&&(e.stopPropagation(),n("body").addClass("on-canvas"),n(t).addClass("open"),n(document.body).on("click",function(e){n(t).removeClass("open"),n("body").removeClass("on-canvas")}))}))})},e.init=function(){e.siteMenuDropdown(),e.mobileContentNav()},e.windowLoadInit=function(){e.contentModals()}}(App.SiteJS=App.SiteJS||{},jQuery),function(e){e(document).ready(function(){App.SiteJS.init(),App.FreeTrial.init(),App.DirectRecommend.init(),!0===e("body").hasClass("pg_ArticleSplitView")&&SCM.SplitScreen.init(),!0===e("body").hasClass("pg_Chapter")&&SCM.SplitScreen.init()}),e(window).on("load",function(){App.SiteJS.windowLoadInit()}),e(window).on("resize",function(){})}(jQuery);var App=App||{};!function(e,y){function t(){y(".widget-free-trial #btnSubmit").on("click",function(){var n,i=y(".widget-free-trial"),e=i.find("#InstitutionName").val(),t=i.find("#Address1").val(),a=i.find("#Address2").val(),r=i.find("#Address3").val(),o=i.find("#City").val(),s=i.find("#CountryList").val(),l=i.find("#PostalCode").val(),c=i.find("#FirstName").val(),d=i.find("#LastName").val(),u=i.find("#Email").val(),h=i.find("#ConfirmEmail").val(),p=i.find("#AgencyAffiliation").val(),f=i.find("#AgencyOrderNo").val(),m=i.find("#IpAddresses").val(),g=i.find("#g-recaptcha-response").val(),v=(n=[],y("input[name='products[]']").each(function(e){var t=this.checked?y(this).val():"";n.push(t)}),n),v=JSON.stringify({InstitutionName:e,Address1:t,Address2:a,Address3:r,City:o,Country:s,PostalCode:l,FirstName:c,LastName:d,Email:u,ConfirmEmail:h,AgencyAffiliation:p,AgencyOrderNo:f,IPAddresses:m,CaptchaResponse:g,ProductsOfInterest:v});y.ajax({type:"POST",url:"/MITP/SubmitFreeTrialForm",data:v,contentType:"application/json"}).done(function(e){var t,n,a;e.Success?(t=i.find(".message-success"),n=y("<div/>"),y.each(e.Messages,function(e,t){n.append(t)}),i.find(".widget-free-trial-form").addClass("hidden"),i.find(".free-trial-self-serve").addClass("hidden"),t.html(n.html()).show()):void 0!==e.Messages&&e.Messages.length&&(a=y("<ul></ul>"),y.each(e.Messages,function(e,t){a.append("<li>"+t+"</li>")}),i.find(".error-message").html(a).show(),window.scrollTo(0,0))})})}e.init=function(){y(".widget-free-trial").length&&t()}}(App.FreeTrial=App.FreeTrial||{},jQuery);var App=App||{};!function(e,d){e.init=function(){d(".widget-direct-recommend").length&&d(".widget-direct-recommend #btnSubmit").on("click",function(){var i=d(".widget-direct-recommend"),e=i.find("#InstitutionName").val(),t=i.find("#City").val(),n=i.find("#CountryList").val(),a=i.find("#PostalCode").val(),r=i.find("#FirstName").val(),o=i.find("#LastName").val(),s=i.find("#Email").val(),l=i.find("#ConfirmEmail").val(),c=i.find("#g-recaptcha-response").val(),c=JSON.stringify({FirstName:r,LastName:o,Email:s,ConfirmEmail:l,InstitutionName:e,City:t,Country:n,PostalCode:a,CaptchaResponse:c});d.ajax({type:"POST",url:"/MITP/SubmitRecommendForm",data:c,contentType:"application/json"}).done(function(e){var t,n,a;e.Success?(t=i.find(".message-success"),n=d("<div/>"),d.each(e.Messages,function(e,t){n.append(t)}),i.find(".widget-direct-recommend-form").addClass("hidden"),i.find(".direct-recommend-self-serve").addClass("hidden"),t.html(n.html()).show()):void 0!==e.Messages&&e.Messages.length&&(a=d("<ul></ul>"),d.each(e.Messages,function(e,t){a.append("<li>"+t+"</li>")}),i.find(".error-message").html(a).show(),window.scrollTo(0,0))})})}}(App.DirectRecommend=App.DirectRecommend||{},jQuery);
//# sourceMappingURL=site.min.js.map
